<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">
    <title>Sumru ❤️</title>
    
    <style>
        /* --- GENEL AYARLAR (GÜNCELLENDİ: TAM EKRAN & SCROLL) --- */
        :root { 
            --ios-blur: blur(25px); 
            --font-stack: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; 
            --ios-blue: #007AFF; 
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }

                body { 
            margin: 0; padding: 0; 
            background-color: #000; 
            position: fixed; width: 100%; height: 100%; 
            overflow: hidden; user-select: none; 
            -webkit-tap-highlight-color: transparent;
            
            /* İŞTE BU SATIRI EKLE: */
            font-family: var(--font-stack); 
        }

        
        /* TAM EKRAN AYARI (Mobil Bar Çözümü - 100dvh) */
                /* ÇERÇEVE AYARI */
        .iphone-frame { 
            width: 100%; 
            height: 100dvh; /* Ekranı tam doldurur */
            position: fixed; /* Sayfaya sabitler */
            top: 0; left: 0;
            background: #a18cd1; /* Siyah yerine temanın rengini verelim (Yama) */
            overflow: hidden; 
        }


                /* DUVAR KAĞIDI (TAM EKRAN ÇÖZÜMÜ) */
        .wallpaper { 
            position: fixed; /* Absolute yerine Fixed yapıyoruz ki kaymasın */
            top: 0; left: 0; 
            width: 100vw; 
            height: 100dvh; /* 100% yerine 100dvh (Mobil tarayıcı barını yoksayar) */
            background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 50%, #a18cd1 100%); 
            background-size: 200% 200%; 
            z-index: 0; 
            animation: gradientMove 15s ease infinite alternate; 
        }

        
        .screen { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            transition: transform 0.6s cubic-bezier(0.645, 0.045, 0.355, 1); 
            display: flex; flex-direction: column; align-items: center; 
            color: white; z-index: 10; 
            padding-top: max(40px, var(--safe-top)); 
            box-sizing: border-box; 
        }

        /* KİLİT EKRANI */
        #lock-screen { justify-content: flex-start; background: rgba(0,0,0,0.2); padding-bottom: max(20px, var(--safe-bottom)); }
        .time-container { animation: slideInDown 0.8s ease-out; text-align: center; margin-top: 20px; }
        .time { font-size: 85px; font-weight: 200; line-height: 1; text-shadow: 0 2px 10px rgba(0,0,0,0.2); margin: 0; }
        .date { font-size: 22px; font-weight: 500; margin-top: 5px; text-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .notification-container { width: 100%; display: flex; flex-direction: column; gap: 10px; margin-top: 30px; align-items: center; }
        .notification { background: rgba(255, 255, 255, 0.75); backdrop-filter: var(--ios-blur); width: 88%; border-radius: 18px; padding: 12px 15px; color: black; box-shadow: 0 4px 15px rgba(0,0,0,0.1); cursor: pointer; text-align: left; display: flex; gap: 12px; align-items: center; animation: slideInUp 0.6s ease backwards; }
        .notification:nth-child(1) { animation-delay: 0.2s; } .notification:nth-child(2) { animation-delay: 0.4s; } .notification:nth-child(3) { animation-delay: 0.6s; }
        .notif-icon-area { width: 38px; height: 38px; border-radius: 8px; overflow: hidden; flex-shrink: 0; display: flex; justify-content: center; align-items: center; }
        .notif-icon-area img { width: 100%; height: 100%; object-fit: cover; }
        .notif-text-area { flex: 1; display: flex; flex-direction: column; justify-content: center; }
        .notif-header { display: flex; justify-content: space-between; font-size: 11px; text-transform: uppercase; color: #444; margin-bottom: 3px; font-weight: 600; width: 100%; }
        .notif-content h4 { margin: 0; font-size: 15px; font-weight: 700; line-height: 1.2; }
        .notif-content p { margin: 2px 0 0; font-size: 14px; color: #111; line-height: 1.2;}
        .swipe-hint { position: absolute; bottom: max(40px, calc(var(--safe-bottom) + 20px)); font-size: 15px; opacity: 0.8; animation: bounce 2s infinite; animation-delay: 1s; }
        .home-bar { position: absolute; bottom: 8px; width: 140px; height: 5px; background: white; border-radius: 10px; z-index: 100; margin-bottom: var(--safe-bottom); }
        @keyframes slideInUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideInDown { from { opacity: 0; transform: translateY(-40px); } to { opacity: 1; transform: translateY(0); } }.home-bar { 
    display: none; /* Bu satır çubuğu tamamen yok eder */
}


        /* ANA EKRAN (KAYDIRMA SORUNU ÇÖZÜLDÜ) */
        #home-screen { 
            transform: translateY(100%); 
            display: block; /* Flex iptal, normal akış */
            overflow-y: auto; /* Kaydırma açık */
            -webkit-overflow-scrolling: touch; /* iOS akıcı kaydırma */
            padding-bottom: 150px; /* Dock payı */
            padding-top: max(40px, var(--safe-top));
        }

        .app-grid { 
            display: grid; grid-template-columns: repeat(4, 1fr); 
            gap: 25px 15px; width: 90%; margin: 10px auto 0; 
        }
        .app-icon { display: flex; flex-direction: column; align-items: center; cursor: pointer; transition: transform 0.1s; }
        .app-icon:active { transform: scale(0.9); }
        .icon-box { width: 62px; height: 62px; border-radius: 16px; display: flex; justify-content: center; align-items: center; font-size: 30px; color: white; margin-bottom: 6px; box-shadow: 0 5px 10px rgba(0,0,0,0.2); }
        .icon-label { font-size: 12px; font-weight: 500; text-shadow: 0 1px 3px rgba(0,0,0,0.5); }
        .dock { position: absolute; bottom: max(30px, calc(var(--safe-bottom) + 15px)); left: 5%; width: 90%; height: 95px; background: rgba(255,255,255,0.25); backdrop-filter: blur(40px); border-radius: 35px; display: flex; justify-content: space-around; align-items: center; z-index: 50; }
        
        /* İKON RENKLERİ */
        .photos { background: linear-gradient(180deg, #ff9a9e 0%, #fecfef 100%); } .notes { background: linear-gradient(180deg, #fccb90 0%, #d57eeb 100%); }
        .music { background: linear-gradient(180deg, #fa709a 0%, #fee140 100%); } .maps { background: linear-gradient(180deg, #8fd3f4 0%, #84fab0 100%); }
        .weather { background: linear-gradient(180deg, #54C8FF 0%, #007AFF 100%); }
        .wheel-icon { background: linear-gradient(180deg, #FF512F 0%, #DD2476 100%); }
        .settings-icon { background: linear-gradient(180deg, #8E8E93 0%, #636366 100%); }
        .wallet-icon { background: linear-gradient(180deg, #34C759 0%, #30B34E 100%); }
        .food-icon-bg { background: linear-gradient(135deg, #ff9966 0%, #ff5e62 100%); }
        .fortune-icon-bg { background: linear-gradient(135deg, #8E2DE2 0%, #4A00E0 100%); }
        .quiz-icon-bg { background: linear-gradient(135deg, #FDBB2D 0%, #22C1C3 100%); }
        .loveflix-icon-bg { background: linear-gradient(180deg, #000 0%, #b81d24 100%); border: 1px solid #333; color: #E50914; font-weight: 900; font-family: 'Arial Black', sans-serif; } 

        /* MODAL */
        .app-modal { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: #f2f2f7; color: #000; z-index: 60; 
            transform: scale(0.95) translateY(20px); opacity: 0; 
            pointer-events: none; transition: all 0.4s cubic-bezier(0.32, 0.72, 0, 1); 
            display: flex; flex-direction: column; border-radius: 40px; overflow: hidden; 
        }
        @media (max-width: 500px) { .app-modal { border-radius: 0; } }
        .app-modal.active { transform: scale(1) translateY(0); opacity: 1; pointer-events: auto; }
        
        .modal-header { 
            padding: max(50px, calc(var(--safe-top) + 10px)) 20px 15px; 
            background: rgba(249,249,249,0.9); backdrop-filter: blur(10px); 
            border-bottom: 1px solid rgba(0,0,0,0.1); 
            display: flex; justify-content: space-between; align-items: center; 
            font-weight: 600; font-size: 17px; position: sticky; top: 0; z-index: 5; flex-shrink: 0; 
        }
        .close-btn { color: var(--ios-blue); border: none; background: none; font-size: 17px; cursor: pointer; font-weight: 400; }
        .modal-content { flex: 1; overflow-y: auto; padding-bottom: max(50px, var(--safe-bottom)); -webkit-overflow-scrolling: touch; }

        /* MESAJLAŞMA */
        #app-messages .modal-content { display: flex; flex-direction: column; height: 100%; padding: 0; background: white; overflow: hidden; position: relative; }
        .chat-wrapper { display: flex; flex-direction: column; height: 100%; overflow: hidden; }
        .chat-container { flex: 1; padding: 15px; display: flex; flex-direction: column; gap: 10px; overflow-y: auto; padding-bottom: 20px; }
        .chat-input-area { flex-shrink: 0; padding: 15px; background: #f0f0f0; border-top: 1px solid #ddd; display: flex; align-items: center; gap: 10px; padding-bottom: max(20px, var(--safe-bottom)); }
        .msg-bubble { max-width: 75%; padding: 10px 15px; border-radius: 20px; font-size: 16px; line-height: 1.4; position: relative; word-wrap: break-word; }
        .msg-received { background: #e5e5ea; align-self: flex-start; border-bottom-left-radius: 5px; color: black; }
        .msg-sent { background: var(--ios-blue); color: white; align-self: flex-end; border-bottom-right-radius: 5px; }
        .msg-typing { background: #e5e5ea; align-self: flex-start; border-bottom-left-radius: 5px; padding: 10px 15px; display: none; margin-left: 15px; margin-bottom: 10px; flex-shrink: 0;}
        .dot { height: 8px; width: 8px; background-color: #999; border-radius: 50%; display: inline-block; animation: typing 1.4s infinite ease-in-out both; margin: 0 2px; }
        .dot:nth-child(1) { animation-delay: -0.32s; } .dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
        .chat-input { flex: 1; border: 1px solid #ccc; border-radius: 20px; padding: 10px 15px; font-size: 16px; outline: none; background: white; }
        .chat-send-btn { color: var(--ios-blue); font-weight: bold; cursor: pointer; font-size: 20px; border: none; background: none; }

        /* UYGULAMA İÇERİKLERİ */
        .email-list, .call-list { background: white; margin-top: 0; }
        .email-item, .call-item { padding: 15px 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: background 0.2s; }
        .email-item:active, .call-item:active { background: #f0f0f0; }
        .note-paper { font-family: 'Marker Felt', 'Comic Sans MS', sans-serif; line-height: 1.6; color: #333; }
        .note-textarea { width: 100%; height: 300px; background: transparent; border: none; outline: none; font-size: 18px; font-family: inherit; resize: none; background-image: linear-gradient(transparent 95%, #e1e1e1 95%); background-size: 100% 30px; margin-top: 10px; }
        .whatsapp-btn { width: 100%; padding: 15px; background: #25D366; color: white; border: none; border-radius: 12px; font-size: 16px; font-weight: bold; margin-top: 20px; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 10px; }
        .map-container-fixed { width: 100%; height: 350px; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.1); position: relative; flex-shrink: 0; }
        .map-frame { width: 100%; height: 100%; border: 0; display: block; }
        #mail-read-view { display: none; background: white; height: 100%; padding: 20px; box-sizing: border-box; }
        .read-subject { font-size: 24px; font-weight: 700; margin-bottom: 10px; line-height: 1.2; }
        .read-meta { display: flex; justify-content: space-between; border-bottom: 1px solid #eee; padding-bottom: 15px; margin-bottom: 20px; color: #555; font-size: 15px; }
        .read-body { font-size: 17px; line-height: 1.5; color: #333; white-space: pre-wrap; }
        .read-actions { margin-top: 30px; border-top: 1px solid #eee; padding-top: 15px; text-align: center; color: var(--ios-blue); font-size: 24px; cursor: pointer; }
        
        /* AŞK DURUMU */
        #app-weather .modal-content { background: linear-gradient(to bottom, #4facfe 0%, #00f2fe 100%); color: white; padding: 0; overflow-y: auto; }
        #app-weather .modal-header { background: transparent; border: none; padding-top: max(40px, var(--safe-top)); padding-bottom: 10px; }
        #app-weather .modal-header span { color: #000000; font-weight: 600; font-size: 17px; text-shadow: none; }
        #app-weather .close-btn { color: var(--ios-blue); background: rgba(255,255,255,0.7); padding: 5px 12px; border-radius: 15px; font-size: 14px; font-weight: 600; border: none; }
        .weather-main { text-align: center; padding: 30px 20px; background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(10px); margin: 10px 20px 20px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 1px solid rgba(255,255,255,0.2); }
        .weather-location { font-size: 28px; font-weight: 700; margin-bottom: 5px; text-shadow: 0 2px 5px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; gap: 8px;}
        .weather-icon-large { font-size: 90px; margin: 15px 0; cursor: pointer; user-select: none; transition: transform 2s ease; filter: drop-shadow(0 0 20px rgba(255,255,0,0.6)); }
        .weather-icon-large.growing { transform: scale(1.6) rotate(180deg); filter: drop-shadow(0 0 50px rgba(255,255,0,1)); }
        .weather-temp { font-size: 55px; font-weight: 300; display: flex; justify-content: center; align-items: center; gap: 10px; }
        .weather-desc { font-size: 18px; font-weight: 500; margin-top: 5px; opacity: 0.95; letter-spacing: 0.5px; }
        .forecast-list { background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); margin: 0 20px 40px; border-radius: 20px; padding: 10px; border: 1px solid rgba(255,255,255,0.2); }
        .forecast-item { display: flex; justify-content: space-between; padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.2); font-size: 16px; font-weight: 600; text-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .forecast-item:last-child { border-bottom: none; }
        #love-explosion-overlay { position: absolute; top:0; left:0; width:100%; height:100%; background: rgba(255, 200, 0, 0.9); display: flex; justify-content: center; align-items: center; z-index: 100; opacity: 0; pointer-events: none; transition: opacity 0.5s; flex-direction: column; }
        #love-explosion-overlay.visible { opacity: 1; pointer-events: auto; }
        #love-explosion-overlay h1 { font-size: 40px; color: #d32f2f; text-align: center; text-shadow: 0 2px 10px rgba(0,0,0,0.2); animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }

        /* MÜZİK */
        #app-music { background: #1c1c1e; color: white; }
        #app-music .modal-header { background: rgba(30,30,30,0.8); color: white; border-bottom: none; }
        .music-bg { position: absolute; top:0; left:0; width:100%; height:100%; background: url('https://images.unsplash.com/photo-1518199266791-5375a83190b7?w=500') no-repeat center center/cover; opacity: 0.3; filter: blur(40px); z-index: 0; }
        .music-ui { position: relative; z-index: 2; display: flex; flex-direction: column; height: 90%; padding: 20px; justify-content: space-evenly; }
        .album-art { width: 280px; height: 280px; border-radius: 15px; background: url('https://images.unsplash.com/photo-1518199266791-5375a83190b7?w=500') center/cover; margin: 0 auto; box-shadow: 0 10px 40px rgba(0,0,0,0.5); }
        .song-info { margin-top: 20px; text-align: left; width: 100%; }
        .song-title { font-size: 24px; font-weight: 700; margin-bottom: 5px; }
        .song-artist { font-size: 18px; color: #ccc; }
        .progress-bar-container { width: 100%; margin-top: 20px; }
        .progress-line { width: 100%; height: 4px; background: rgba(255,255,255,0.2); border-radius: 2px; }
        .progress-fill { width: 30%; height: 100%; background: #fff; border-radius: 2px; }
        .time-info { display: flex; justify-content: space-between; font-size: 12px; color: #aaa; margin-top: 8px; }
        .controls { display: flex; justify-content: space-between; align-items: center; margin-top: 10px; width: 100%; padding: 0 10px; box-sizing: border-box; }
        .ctrl-btn { font-size: 35px; cursor: pointer; color: white; opacity: 0.9; }
        .play-pause-btn { font-size: 55px; }
        
        /* KALP STİLLERİ */
        #app-heart { background: radial-gradient(circle at center, #3a000a 0%, #000000 100%); color: white; overflow: hidden; }
        .click-counter { position: absolute; top: 60px; left: 20px; font-size: 20px; font-weight: 600; opacity: 0.8; color: white; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); padding: 8px 15px; border-radius: 20px; z-index: 30; pointer-events: none; }
        .heart-wrapper { position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; z-index: 5; }
        .main-heart { font-size: 140px; cursor: pointer; user-select: none; -webkit-tap-highlight-color: transparent; z-index: 10; padding: 100px; margin: -100px; filter: drop-shadow(0 0 20px rgba(255, 0, 50, 0.4)); transition: transform 0.2s cubic-bezier(0.1, 0.7, 1.0, 0.1), filter 0.2s ease; }
        .main-heart.idle { animation: idleBeat 2.5s infinite ease-in-out; }
        .main-heart.tap { transform: scale(0.9); filter: drop-shadow(0 0 50px rgba(255, 0, 50, 0.9)); }
        .main-heart.growing { transition: transform 3s linear; transform: scale(4); filter: drop-shadow(0 0 100px rgba(255, 0, 50, 1)); }
        #secret-layer, #counter-layer { position: absolute; top:0; left:0; width:100%; height:100%; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 20; opacity: 0; pointer-events: none; transition: opacity 0.8s ease; text-align: center; }
        #secret-layer { background: rgba(200, 10, 50, 0.95); } #counter-layer { background: rgba(0, 0, 0, 0.95); }
        #secret-layer.visible, #counter-layer.visible { opacity: 1; pointer-events: auto; }
        .falling-heart { position: absolute; top: -50px; font-size: 20px; opacity: 0.8; pointer-events: none; z-index: 1; animation: fallDown linear forwards; }
        @keyframes idleBeat { 0%, 100% {transform: scale(1);} 50% {transform: scale(1.08);} }
        @keyframes fallDown { to { transform: translateY(900px) rotate(360deg); opacity: 0; } }
        @keyframes bounce { 0%, 100% {transform: translateY(0);} 50% {transform: translateY(-5px);} }
        .photo-gallery { padding: 20px; display: grid; grid-template-columns: repeat(2, 1fr); grid-auto-rows: 180px; gap: 15px; }
        .gallery-photo { width: 100%; height: 100%; object-fit: cover; border-radius: 18px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); transition: all 0.3s ease; cursor: pointer; }
        .photo-tall { grid-row: span 2; height: 100%; } .photo-wide { grid-column: span 2; } 
        .gallery-photo:hover { transform: translateY(-5px) scale(1.02); box-shadow: 0 15px 35px rgba(0,0,0,0.3); }
        .surprise-box { grid-column: span 2; background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); border-radius: 18px; padding: 25px; text-align: center; color: white; font-weight: bold; cursor: pointer; box-shadow: 0 10px 25px rgba(0,0,0,0.2); margin-top: 10px; transition: all 0.4s ease; position: relative; overflow: hidden; }
        .surprise-box:hover { transform: scale(1.02); }
        .surprise-box.revealed { background: linear-gradient(135deg, #ff7eb3 0%, #ff758c 100%); transform: scale(1.05); box-shadow: 0 15px 40px rgba(255, 126, 179, 0.4); }
        .initial-text { transition: opacity 0.3s; }
        .surprise-content { display: none; opacity: 0; margin-top: 15px; font-size: 20px; line-height: 1.4; transform: translateY(20px); transition: all 0.5s ease; }
        .confetti { position: absolute; pointer-events: none; z-index: 70; animation: explode 2s ease-out forwards; }
        @keyframes explode { 0% { opacity: 1; transform: translate(0,0) rotate(0); } 100% { opacity: 0; transform: translate(var(--x), var(--y)) rotate(var(--r)); } }
        #calling-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(20px); z-index: 100; display: none; flex-direction: column; align-items: center; padding-top: 80px; box-sizing: border-box; color: white; }
        .caller-img { width: 120px; height: 120px; border-radius: 50%; background: #333; margin-bottom: 20px; object-fit: cover; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .call-status { font-size: 18px; color: #ccc; margin-bottom: 5px; }
        .call-name { font-size: 32px; font-weight: 600; margin-bottom: 50px; }
        .call-actions { width: 80%; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: auto; margin-bottom: 50px; }
        .action-btn { width: 70px; height: 70px; border-radius: 50%; background: rgba(255,255,255,0.15); display: flex; justify-content: center; align-items: center; font-size: 28px; margin: 0 auto; backdrop-filter: blur(10px); }
        .hangup-btn { grid-column: span 2; width: 80px; height: 80px; background: #FF3B30; margin: 30px auto 0; font-size: 35px; }

        /* --- AŞK ÇARKI STİLLERİ --- */
        #app-wheel .modal-content { background: linear-gradient(to top, #dad4ec 0%, #f3e7e9 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .wheel-title { text-align:center; color:#444; margin-bottom:30px; font-weight: 700; letter-spacing: 0.5px;}
        .wheel-container { position: relative; width: 300px; height: 300px; margin: 20px auto; box-sizing: border-box; }
        .wheel-outer { width: 100%; height: 100%; border-radius: 50%; border: 10px solid white; box-shadow: 0 15px 40px rgba(0,0,0,0.2); overflow: hidden; position: relative; transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99); box-sizing: border-box; }
        .wheel-inner { width: 100%; height: 100%; position: relative; background: conic-gradient(#FF9A9E 0deg 36deg, #FECFEF 36deg 72deg, #a18cd1 72deg 108deg, #fbc2eb 108deg 144deg, #8fd3f4 144deg 180deg, #84fab0 180deg 216deg, #f6d365 216deg 252deg, #fda085 252deg 288deg, #d4fc79 288deg 324deg, #96e6a1 324deg 360deg); border-radius: 50%; }
        .wheel-labels { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 50%; pointer-events: none; }
        .wheel-labels span { position: absolute; top: 50%; left: 50%; font-size: 24px; transform-origin: 0 0; transform: translate(-50%, -50%) rotate(calc((var(--i) * 36deg) + 18deg)) translateY(-115px) rotate(calc((var(--i) * -36deg) - 18deg)); text-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .wheel-arrow { position: absolute; top: -25px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 25px solid transparent; border-right: 25px solid transparent; border-top: 50px solid #333; z-index: 10; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.3)); }
        .wheel-center { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80px; height: 80px; background: white; border-radius: 50%; box-shadow: 0 5px 20px rgba(0,0,0,0.15); display: flex; justify-content: center; align-items: center; font-size: 36px; z-index: 5; border: 6px solid #fff; box-sizing: border-box; }
        .spin-btn { margin-top: 40px; padding: 15px 60px; background: var(--ios-blue); color: white; font-size: 20px; font-weight: bold; border: none; border-radius: 30px; box-shadow: 0 8px 20px rgba(0,122,255,0.4); cursor: pointer; transition: all 0.2s; }
        .spin-btn:active { transform: scale(0.95); box-shadow: 0 4px 10px rgba(0,122,255,0.3); }
        .spin-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        #wheel-result-overlay { position: absolute; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(8px); z-index: 20; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.4s ease; }
        #wheel-result-overlay.visible { opacity: 1; pointer-events: auto; }
        .result-box { background: white; padding: 35px; border-radius: 30px; text-align: center; width: 80%; max-width: 300px; box-shadow: 0 25px 50px rgba(0,0,0,0.4); transform: scale(0.7); opacity: 0; transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); }
        #wheel-result-overlay.visible .result-box { transform: scale(1); opacity: 1;}
        .result-icon { font-size: 70px; margin-bottom: 15px; display: block; animation: bounce 1.5s infinite; }
        .result-text { margin: 10px 0 25px; color: #333; font-size: 26px; font-weight: 800; line-height: 1.3; }
        .result-close-btn { padding: 12px 30px; background: var(--ios-blue); color: white; border: none; border-radius: 20px; font-size: 18px; font-weight: 600; cursor: pointer; }

        /* AŞK AYARLARI (SADE LİSTE) */
        #app-settings .modal-content { background: #f2f2f7; padding: 20px; }
        .settings-group { background: white; border-radius: 10px; overflow: hidden; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .setting-item { display: flex; align-items: center; justify-content: space-between; padding: 12px 15px; border-bottom: 1px solid #f0f0f0; cursor: pointer;}
        .setting-item:last-child { border-bottom: none; }
        .setting-icon { width: 30px; height: 30px; border-radius: 6px; display: flex; justify-content: center; align-items: center; margin-right: 12px; color: white; font-size: 18px; }
        .setting-label { flex: 1; font-size: 16px; color: #000; }
        .setting-value { font-size: 15px; color: #8e8e93; display: flex; align-items: center; gap: 5px; }
        .profile-section { display: flex; align-items: center; background: white; padding: 15px; border-radius: 10px; margin-bottom: 20px; }
        .profile-pic { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; margin-right: 15px; border: 1px solid #eee; }
        .profile-info h3 { margin: 0; font-size: 18px; font-weight: 600; }
        .profile-info p { margin: 3px 0 0; font-size: 14px; color: #888; }
        .toggle-switch { position: relative; width: 50px; height: 30px; -webkit-appearance: none; background: #e9e9ea; outline: none; border-radius: 15px; transition: .3s; cursor: pointer; pointer-events: auto; }
        .toggle-switch:checked { background: #34C759; }
        .toggle-switch::before { content: ''; position: absolute; width: 26px; height: 26px; border-radius: 50%; top: 2px; left: 2px; background: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.2); transition: .3s; }
        .toggle-switch:checked::before { left: 22px; }

        /* --- CÜZDAN UYGULAMASI STİLLERİ --- */
        #app-wallet .modal-content { background: linear-gradient(to bottom, #1e3c72, #2a5298); color: white; padding: 20px; }
        #app-wallet .modal-header { background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255,255,255,0.1); }
        #app-wallet .modal-header span { color: #000000; font-weight: 700; }
        #app-wallet .close-btn { color: var(--ios-blue); background: white; padding: 6px 14px; border-radius: 15px; font-weight: 600; }
        .wallet-title { font-size: 28px; font-weight: 700; margin-bottom: 20px; letter-spacing: 0.5px; text-shadow: 0 2px 5px rgba(0,0,0,0.3); }
        
        .coupon-card { position: relative; height: 160px; margin-bottom: -70px; border-radius: 20px; padding: 20px; box-sizing: border-box; box-shadow: 0 -5px 25px rgba(0,0,0,0.5); transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); cursor: pointer; display: flex; flex-direction: column; justify-content: space-between; overflow: hidden; border-top: 1px solid rgba(255,255,255,0.2); }
        .coupon-card:hover { transform: translateY(-30px) scale(1.02); z-index: 100; box-shadow: 0 10px 40px rgba(0,0,0,0.6); }
        .coupon-card:last-child { margin-bottom: 30px; }
        
        /* Kart Renkleri */
        .coupon-1 { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%); color: #555; }
        .coupon-2 { background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); color: white; }
        .coupon-3 { background: linear-gradient(135deg, #8fd3f4 0%, #84fab0 100%); color: #333; }
        .coupon-4 { background: linear-gradient(135deg, #fccb90 0%, #d57eeb 100%); color: #333; }
        .coupon-5 { background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%); color: #333; }
        .coupon-6 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; }
        .coupon-7 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; }
        .coupon-8 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: #333; }
        .coupon-9 { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); color: #555; }
        .coupon-10 { background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); color: white; }
        .coupon-11 { background: linear-gradient(135deg, #8fd3f4 0%, #84fab0 100%); color: #333; }
        .coupon-12 { background: linear-gradient(135deg, #fccb90 0%, #d57eeb 100%); color: #333; }

        .coupon-header { display: flex; justify-content: space-between; align-items: flex-start; }
        .coupon-title { font-size: 22px; font-weight: 800; line-height: 1.1; width: 80%; }
        .coupon-icon { font-size: 36px; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2)); }
        .coupon-footer { display: flex; justify-content: space-between; align-items: center; font-size: 13px; opacity: 0.9; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; }

        /* KUPON DETAYI */
        #coupon-detail-overlay { position: absolute; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); backdrop-filter: blur(15px); z-index: 2000; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
        #coupon-detail-overlay.visible { opacity: 1; pointer-events: auto; }
        .coupon-detail-card { width: 85%; background: white; border-radius: 25px; overflow: hidden; box-shadow: 0 30px 60px rgba(0,0,0,0.6); text-align: center; transform: scale(0.8); transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        #coupon-detail-overlay.visible .coupon-detail-card { transform: scale(1); }
        .detail-header { height: 120px; display: flex; justify-content: center; align-items: center; font-size: 60px; color: white; position: relative; overflow: hidden;}
        .detail-header::after { content: ''; position: absolute; bottom: -20px; left: -10%; width: 120%; height: 40px; background: white; border-radius: 50%; }
        .detail-body { padding: 10px 25px 30px; color: #333; }
        .detail-title { font-size: 26px; font-weight: 800; margin-bottom: 10px; color: #222; }
        .detail-desc { font-size: 17px; color: #555; line-height: 1.6; margin-bottom: 30px; font-weight: 400;}
        .use-btn { width: 100%; padding: 16px; background: #34C759; color: white; font-size: 18px; font-weight: bold; border: none; border-radius: 15px; cursor: pointer; box-shadow: 0 5px 15px rgba(52, 199, 89, 0.4); transition: all 0.2s; }
        .use-btn:active { transform: scale(0.95); }
        .close-detail-btn { margin-top: 20px; background: none; border: none; color: #999; font-size: 15px; cursor: pointer; font-weight: 500; }

        /* AŞK MUTFAĞI (İPHONE 13 UYUMLU SABİT SEPET) */
        #app-food .modal-content { background: #f5f5f5; padding: 0; position: relative; overflow-y: auto; height: 100%; }
        #app-food .modal-header { background: white; border-bottom: 1px solid #eee; }
        
        .food-category { padding: 20px 20px 10px; font-size: 18px; font-weight: 800; color: #333; }
        .food-list { padding-bottom: 120px; /* Sepet barı ve güvenli alan için ekstra boşluk */ }
        
        .food-item { background: white; margin: 10px 20px; padding: 15px; border-radius: 20px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: transform 0.2s; }
        .food-item:active { transform: scale(0.98); }
        
        .f-img { font-size: 35px; width: 45px; text-align: center; margin-right: 15px; }
        .f-info { flex: 1; }
        .f-name { font-weight: 700; font-size: 16px; color: #000; display: block; margin-bottom: 4px; }
        .f-desc { font-size: 12px; color: #888; display: block; margin-bottom: 4px; line-height: 1.2; }
        .f-price { font-size: 11px; color: #ff5e62; font-weight: 700; background: rgba(255, 94, 98, 0.1); padding: 4px 8px; border-radius: 10px; display: inline-block; text-transform: uppercase; letter-spacing: 0.5px; }
        
        /* Simetrik Butonlar */
        .f-actions { display: flex; align-items: center; justify-content: center; gap: 8px; width: 90px; }
        .btn-qty { width: 30px; height: 30px; border-radius: 50%; border: none; font-size: 18px; font-weight: 600; display: flex; justify-content: center; align-items: center; cursor: pointer; transition: all 0.2s; padding: 0; line-height: 1; }
        .btn-plus { background: #ff5e62; color: white; box-shadow: 0 4px 10px rgba(255, 94, 98, 0.3); }
        .btn-minus { background: white; color: #ff5e62; border: 2px solid #ff5e62; display: none; } 
        .qty-num { font-weight: 700; font-size: 16px; min-width: 20px; text-align: center; display: none; color: #333; }

        .has-item .btn-minus, .has-item .qty-num { display: flex; display: block; }
        
        /* İPHONE 13 İÇİN SEPET HİZALAMA */
        .cart-bar { 
            position: absolute; 
            bottom: max(20px, calc(var(--safe-bottom) + 10px)); /* Home barın üzerine çıkar */
            left: 5%; width: 90%; 
            background: #222; color: white; 
            padding: 15px 20px; border-radius: 25px; 
            display: flex; justify-content: space-between; align-items: center; 
            box-shadow: 0 10px 40px rgba(0,0,0,0.4); 
            transform: translateY(200%); 
            transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); 
            z-index: 100; box-sizing: border-box; cursor: pointer; 
        }
        .cart-bar.active { transform: translateY(0); }
        .cart-total { font-weight: 700; display: flex; flex-direction: column; }
        .cart-btn-txt { font-weight: 700; color: #ff5e62; background: white; padding: 10px 20px; border-radius: 20px; font-size: 14px; }

        /* --- FALCI UYGULAMASI --- */
        #app-fortune { background: radial-gradient(circle at center, #2b1055 0%, #7597de 100%); }
        #app-fortune .modal-content { background: transparent; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; padding: 20px; text-align: center; }
        #app-fortune .modal-header { background: transparent; border: none; color: white; }
        #app-fortune .close-btn { color: white; background: rgba(255,255,255,0.2); }
        #app-fortune .modal-header span { color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.3); font-size: 19px; }

        .crystal-ball-container { position: relative; width: 250px; height: 250px; margin: 20px auto; display: flex; justify-content: center; align-items: center; }
        .crystal-ball { width: 200px; height: 200px; border-radius: 50%; background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.8), rgba(255,255,255,0.1) 20%, rgba(100,0,255,0.4) 60%, rgba(50,0,100,0.9) 100%); box-shadow: 0 0 50px rgba(138, 43, 226, 0.6), inset 0 0 20px rgba(255,255,255,0.2); position: relative; z-index: 5; cursor: pointer; transition: transform 0.2s; }
        .crystal-ball.shaking { animation: shakeBall 0.5s cubic-bezier(.36,.07,.19,.97) both infinite; box-shadow: 0 0 80px rgba(138, 43, 226, 1), inset 0 0 40px rgba(255,255,255,0.5); }
        @keyframes shakeBall { 10%, 90% { transform: translate3d(-2px, 0, 0) rotate(-2deg); } 20%, 80% { transform: translate3d(4px, 0, 0) rotate(2deg); } 30%, 50%, 70% { transform: translate3d(-6px, 0, 0) rotate(-4deg); } 40%, 60% { transform: translate3d(6px, 0, 0) rotate(4deg); } }
        .crystal-stand { position: absolute; bottom: 0; width: 120px; height: 40px; background: linear-gradient(to bottom, #444, #111); border-radius: 50%; z-index: 1; transform: translateY(110px); box-shadow: 0 10px 20px rgba(0,0,0,0.6); }
        .fortune-text { font-size: 24px; font-weight: 700; min-height: 80px; margin-top: 50px; text-shadow: 0 2px 10px rgba(0,0,0,0.8); opacity: 0; transition: opacity 1s; max-width: 90%; position: relative; z-index: 10; }
        .fortune-text.visible { opacity: 1; }
        .fortune-hint { font-size: 14px; opacity: 0.7; margin-top: 20px; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }

        /* --- QUIZ UYGULAMASI --- */
        #app-quiz { background: linear-gradient(to bottom, #2c3e50, #4ca1af); }
        #app-quiz .modal-content { background: transparent; color: white; display: flex; flex-direction: column; align-items: center; padding: 30px 20px; }
        #app-quiz .modal-header { background: transparent; border: none; color: white; }
        #app-quiz .close-btn { color: white; background: rgba(255,255,255,0.2); }
        #app-quiz .modal-header span { color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.3); font-size: 19px; }

        .quiz-container { width: 100%; max-width: 400px; text-align: center; }
        .quiz-question { font-size: 26px; font-weight: 700; margin-bottom: 40px; min-height: 80px; display: flex; align-items: center; justify-content: center; text-shadow: 0 2px 5px rgba(0,0,0,0.3); }
        .quiz-options { display: flex; flex-direction: column; gap: 15px; width: 100%; }
        .quiz-btn { 
            padding: 18px; border: none; border-radius: 15px; 
            background: rgba(255,255,255,0.95); color: #333; 
            font-size: 18px; font-weight: 600; cursor: pointer; 
            transition: transform 0.1s, background 0.3s; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .quiz-btn:active { transform: scale(0.98); }
        .quiz-btn.correct { background: #2ecc71; color: white; animation: pop 0.4s; }
        .quiz-btn.wrong { background: #e74c3c; color: white; animation: shake 0.4s; }
        
        #quiz-result { display: none; flex-direction: column; align-items: center; justify-content: center; height: 80%; }
        .score-circle { width: 150px; height: 150px; border-radius: 50%; border: 10px solid rgba(255,255,255,0.3); display: flex; justify-content: center; align-items: center; font-size: 40px; font-weight: bold; margin-bottom: 20px; background: rgba(255,255,255,0.1); box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        
        @keyframes shake { 0%, 100% {transform: translateX(0);} 25% {transform: translateX(-10px);} 75% {transform: translateX(10px);} }
        @keyframes pop { 0% {transform: scale(1);} 50% {transform: scale(1.1);} 100% {transform: scale(1);} }

        /* --- LOVEFLIX UYGULAMASI --- */
        #app-loveflix { background: #000; }
        #app-loveflix .modal-content { 
            background: #000; color: white; padding: 0; 
            overflow-y: scroll; /* Scroll'u zorla */
            -webkit-overflow-scrolling: touch; /* iOS akıcı kaydırma */
            height: 100%;
            position: relative;
            padding-bottom: 80px; /* En alt içeriğin görünmesi için boşluk */
        }
        
        #app-loveflix .modal-header { 
            background: linear-gradient(to bottom, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0) 100%); 
            border: none; z-index: 50; 
            position: absolute; width: 100%; top: 0; left: 0;
            padding-top: max(30px, var(--safe-top)); 
            height: 80px;
            display: flex; align-items: center; justify-content: space-between;
            padding-left: 15px; padding-right: 15px; box-sizing: border-box;
        }
        
        #app-loveflix .header-logo {
            position: absolute; left: 50%; 
            top: 60%; 
            transform: translate(-50%, -50%);
            color: #E50914; font-weight: 900; font-size: 32px; 
            letter-spacing: 2px; text-shadow: 0 2px 10px rgba(0,0,0,0.8);
            font-family: 'Arial Black', sans-serif;
            pointer-events: none;
        }

        #app-loveflix .close-btn { 
            color: white; background: rgba(255,255,255,0.2); 
            border-radius: 50%; width: 35px; height: 35px; 
            display: flex; justify-content: center; align-items: center; 
            padding: 0; backdrop-filter: blur(5px); font-size: 18px; z-index: 51;
            border: none; cursor: pointer;
        }

        .hero-section {
            position: relative; height: 65vh; 
            width: 100%;
            background: url('https://images.unsplash.com/photo-1516589178581-6cd7833ae3b2?q=80&w=1000') no-repeat center center/cover;
            display: flex; flex-direction: column; justify-content: flex-end; 
            padding: 20px; box-sizing: border-box;
            margin-bottom: 10px;
        }
        .hero-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, rgba(0,0,0,0.2) 0%, rgba(0,0,0,0.1) 50%, #000 100%);
        }
        .hero-content { position: relative; z-index: 10; text-align: center; width: 100%; margin-bottom: 10px; display: flex; flex-direction: column; align-items: center; }
        .hero-title { font-size: 42px; font-weight: 900; margin-bottom: 5px; line-height: 1; text-transform: uppercase; letter-spacing: -1px; text-shadow: 0 2px 10px rgba(0,0,0,1); }
        .hero-meta { font-size: 13px; color: #46d369; font-weight: 700; margin-bottom: 15px; text-shadow: 0 1px 2px rgba(0,0,0,1); }
        .hero-desc { font-size: 14px; color: #eee; margin-bottom: 20px; line-height: 1.4; max-width: 95%; text-shadow: 0 1px 2px rgba(0,0,0,1); display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
        
        .hero-actions { display: flex; gap: 15px; justify-content: center; width: 100%; }
        .play-btn { background: white; color: black; border: none; padding: 10px 25px; border-radius: 4px; font-weight: 700; font-size: 16px; display: flex; align-items: center; gap: 8px; cursor: pointer; transition: transform 0.2s; }
        .play-btn:active { transform: scale(0.95); }
        .list-btn { background: rgba(109, 109, 110, 0.8); color: white; border: none; padding: 10px 25px; border-radius: 4px; font-weight: 700; font-size: 16px; display: flex; align-items: center; gap: 8px; cursor: pointer; transition: transform 0.2s; backdrop-filter: blur(5px); }
        .list-btn:active { transform: scale(0.95); }

        .netflix-row { padding: 0 0 30px 20px; width: 100%; box-sizing: border-box; }
        .row-title { font-size: 18px; font-weight: 700; margin-bottom: 10px; color: #e5e5e5; }
        .row-posters { 
            display: flex; gap: 10px; 
            overflow-x: auto; 
            padding-right: 20px; padding-bottom: 10px;
            -webkit-overflow-scrolling: touch; 
            scrollbar-width: none; 
        }
        .row-posters::-webkit-scrollbar { display: none; }
        .poster { width: 110px; height: 160px; border-radius: 6px; object-fit: cover; flex-shrink: 0; transition: transform 0.2s; cursor: pointer; }
        .poster:active { transform: scale(0.95); opacity: 0.8; }

        #hidden-token-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.92); z-index: 200;
            display: none; flex-direction: column; align-items: center; justify-content: center;
            padding: 20px; text-align: center; box-sizing: border-box;
        }
        .token-coin {
            font-size: 120px; animation: spinCoin 3s infinite linear;
            filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.6)); margin-bottom: 20px;
        }
        .token-title { font-size: 28px; font-weight: 900; color: #ffce00; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .token-msg { font-size: 18px; font-weight: normal; color: white; line-height: 1.5; opacity: 0.9; }
        .token-btn { margin-top: 30px; padding: 15px 40px; background: #E50914; color: white; border: none; border-radius: 8px; font-weight: bold; font-size: 18px; box-shadow: 0 5px 15px rgba(229, 9, 20, 0.4); cursor: pointer;}
        @keyframes spinCoin { from { transform: rotateY(0deg); } to { transform: rotateY(360deg); } }

        /* --- KAZI KAZAN STİLLERİ --- */
        #app-scratch .modal-content {
            background: linear-gradient(135deg, #232526 0%, #414345 100%);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 20px;
        }
        #app-scratch .modal-header { background: rgba(0,0,0,0.5); border-bottom: 1px solid rgba(255,255,255,0.1); color: white; }
        #app-scratch .close-btn { color: white; background: rgba(255,255,255,0.2); }
        #app-scratch .modal-header span { color: #FDC830; text-shadow: 0 1px 3px rgba(0,0,0,0.5); }

        .scratch-container {
            width: 100%;
            max-width: 340px;
            text-align: center;
            padding: 20px;
            box-sizing: border-box;
        }
        .scratch-header h3 { margin: 0 0 10px; font-size: 24px; color: #FDC830; }
        .scratch-header p { margin: 0 0 30px; opacity: 0.7; }

        .scratch-card-wrapper {
            position: relative;
            width: 300px;
            height: 180px;
            margin: 0 auto 40px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            border: 4px solid #FDC830;
            background: white;
        }

        .scratch-prize {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
            font-size: 20px;
            font-weight: 800;
            color: #333;
            background: radial-gradient(circle, #fff 0%, #ddd 100%);
            z-index: 1;
        }

        #scratch-canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 2;
            cursor: pointer;
            touch-action: none; 
        }

        .reset-scratch-btn {
            padding: 15px 30px;
            background: linear-gradient(to right, #FDC830, #F37335);
            border: none;
            border-radius: 30px;
            color: #fff;
            font-weight: bold;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(243, 115, 53, 0.4);
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        .reset-scratch-btn:active { transform: scale(0.95); }

        .scratch-note { margin-top: 30px; opacity: 0.5; font-style: italic; font-size: 12px; }

        /* --- PANIC BUTTON STİLLERİ --- */
        #app-panic .modal-content {
            background-color: #000;
            background-image: repeating-linear-gradient(45deg, #111 25%, transparent 25%, transparent 75%, #111 75%, #111), repeating-linear-gradient(45deg, #111 25%, #000 25%, #000 75%, #111 75%, #111);
            background-position: 0 0, 10px 10px;
            background-size: 20px 20px;
            color: #ff3333;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            overflow: hidden;
        }

        .panic-stage {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .warning-text {
            font-size: 14px;
            color: #ff0000;
            background: rgba(50,0,0,0.8);
            padding: 10px 20px;
            border: 1px solid #ff0000;
            margin-bottom: 40px;
            letter-spacing: 1px;
            animation: blinkText 1s infinite;
            text-align: center;
        }

        .big-red-button-container {
            position: relative;
            width: 200px;
            height: 200px;
            cursor: pointer;
        }

        .big-red-button {
            width: 180px;
            height: 180px;
            background: radial-gradient(circle at 30% 30%, #ff5e57, #ff0000);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-size: 30px;
            font-weight: 900;
            box-shadow: 0 10px 30px rgba(255, 0, 0, 0.6), inset 0 5px 10px rgba(255,255,255,0.3);
            position: relative;
            z-index: 2;
            transition: transform 0.1s;
            border: 5px solid #800000;
        }

        .big-red-button:active {
            transform: scale(0.95) translateY(5px);
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.8);
        }

        .button-shadow {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 180px;
            height: 180px;
            background: #500000;
            border-radius: 50%;
            z-index: 1;
        }

        #panic-overlay-light {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: red;
            opacity: 0;
            pointer-events: none;
            z-index: 1;
        }

        .panic-active #panic-overlay-light {
            animation: sirenLight 1s infinite;
        }

        .panic-status {
            font-size: 22px;
            font-weight: bold;
            color: white;
            background: #d32f2f;
            width: 100%;
            text-align: center;
            padding: 15px;
            margin-bottom: 20px;
            text-transform: uppercase;
            box-shadow: 0 0 20px #d32f2f;
        }

        .panic-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            width: 90%;
        }

        .panic-item {
            background: rgba(50, 0, 0, 0.8);
            border: 2px solid #ff3333;
            border-radius: 10px;
            padding: 15px 5px;
            text-align: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 0 10px rgba(255, 0, 0, 0.2);
        }

        .panic-item:active {
            background: #ff3333;
            transform: scale(0.95);
            box-shadow: 0 0 20px red;
        }

        @keyframes blinkText { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        @keyframes sirenLight { 0%, 100% { opacity: 0; } 50% { opacity: 0.3; } }

        /* PANİK BUTONU GEÇİŞ EFEKTLERİ */
        .stage-fade-out { animation: fadeOutScale 0.6s forwards; }
        .stage-fade-in { animation: fadeInScale 0.6s forwards; display: flex !important; opacity: 0; }
        
        @keyframes fadeOutScale {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(1.5); }
        }
        @keyframes fadeInScale {
            0% { opacity: 0; transform: scale(0.8); }
            100% { opacity: 1; transform: scale(1); }
        }

        /* --- ZENLOVE (PREMIUM MEDITASYON & DOKUNUŞ) --- */
        #app-zen { background: #0f0c29; }
        #app-zen .modal-content {
            background: linear-gradient(to bottom, #0f0c29, #302b63, #24243e);
            color: white;
            display: flex; flex-direction: column; align-items: center; justify-content: space-evenly;
            padding: 20px;
        }
        #app-zen .modal-header { background: transparent; border: none; color: rgba(255,255,255,0.8); }
        #app-zen .close-btn { color: white; background: rgba(255,255,255,0.1); border-radius: 50%; width: 32px; height: 32px; padding: 0; display:flex; align-items:center; justify-content:center;}

        /* Zen Sekme Yapısı */
        .zen-tabs { display: flex; background: rgba(255,255,255,0.1); border-radius: 20px; padding: 4px; margin-bottom: 20px; }
        .zen-tab { padding: 8px 20px; border-radius: 16px; font-size: 14px; font-weight: 600; color: #aaa; cursor: pointer; transition: all 0.3s; }
        .zen-tab.active { background: rgba(255,255,255,0.2); color: white; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }

        /* Zen Nefes */
        .breath-container { position: relative; width: 220px; height: 220px; display: flex; justify-content: center; align-items: center; }
        .breath-circle {
            position: absolute; width: 100%; height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(104, 109, 224, 0.4) 0%, rgba(104, 109, 224, 0.0) 70%);
            transform: scale(0.8);
            box-shadow: 0 0 30px rgba(104, 109, 224, 0.3);
        }
        .breath-text { font-size: 22px; font-weight: 300; letter-spacing: 2px; z-index: 10; opacity: 0.9; text-transform: uppercase; }
        .breathing .breath-circle { animation: breatheAnim 8s infinite ease-in-out; }
        .breathing .breath-text { animation: textFade 8s infinite ease-in-out; }

        @keyframes breatheAnim { 
            0%, 100% { transform: scale(0.8); opacity: 0.5; } 
            50% { transform: scale(1.3); opacity: 1; box-shadow: 0 0 60px rgba(104, 109, 224, 0.6); } 
        }
        @keyframes textFade { 
            0%, 100% { content: "Nefes Ver"; opacity: 0.7; } 
            50% { content: "Nefes Al"; opacity: 1; } 
        }

        /* Zen Dokunuş */
        .touch-area {
            width: 200px; height: 200px;
            border-radius: 50%;
            border: 2px dashed rgba(255,255,255,0.2);
            display: flex; justify-content: center; align-items: center;
            position: relative;
            cursor: pointer;
            transition: all 0.5s;
            user-select: none; -webkit-touch-callout: none;
        }
        .touch-icon { font-size: 50px; opacity: 0.5; transition: 0.3s; }
        .touch-hint { margin-top: 20px; font-size: 14px; color: #888; text-align: center; }

        .touch-area.active {
            border-color: #ff2d55;
            background: radial-gradient(circle, rgba(255, 45, 85, 0.2) 0%, transparent 70%);
            box-shadow: 0 0 50px rgba(255, 45, 85, 0.4);
            animation: heartbeat 1.2s infinite;
        }
        .touch-area.active .touch-icon { transform: scale(1.2); opacity: 1; text-shadow: 0 0 20px #ff2d55; }

        @keyframes heartbeat {
            0% { transform: scale(1); } 15% { transform: scale(1.05); } 30% { transform: scale(1); } 45% { transform: scale(1.05); } 60% { transform: scale(1); } 100% { transform: scale(1); }
        }

        .zen-quote { font-style: italic; opacity: 0.7; text-align: center; max-width: 80%; line-height: 1.6; margin-top: 30px; font-size: 15px; }

/* --- AURA (PREMIUM KOMBİN) STİLLERİ --- */
#app-aura .modal-content {
    background: #faf9f6; /* Premium Kağıt Rengi */
    padding: 20px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
}

.aura-view {
    height: 100%;
    display: flex;
    flex-direction: column;
    animation: fadeIn 0.5s ease;
}

/* Giriş Ekranı */
.aura-hero { margin-bottom: 30px; text-align: center; margin-top: 20px; }
.aura-hero h1 { font-family: 'Didot', serif; font-size: 32px; color: #111; margin-bottom: 5px; letter-spacing: -0.5px; }
.aura-hero p { color: #888; font-size: 14px; font-weight: 400; letter-spacing: 1px; text-transform: uppercase; }

.aura-selection-group { margin-bottom: 25px; }
.aura-selection-group label { display: block; font-size: 13px; font-weight: 700; color: #999; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }

.chip-container { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; }
.chip-container::-webkit-scrollbar { display: none; }

.chip {
    padding: 10px 20px;
    background: white;
    border: 1px solid #eee;
    border-radius: 25px;
    font-size: 14px;
    color: #555;
    white-space: nowrap;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    box-shadow: 0 2px 5px rgba(0,0,0,0.03);
}
.chip.active {
    background: #111;
    color: white;
    border-color: #111;
    transform: scale(1.05);
    box-shadow: 0 5px 15px rgba(0,0,0,0.15);
}

.aura-generate-btn {
    margin-top: auto; margin-bottom: 40px;
    width: 100%; padding: 18px;
    background: linear-gradient(135deg, #111 0%, #333 100%);
    color: white; border: none; border-radius: 15px;
    font-size: 16px; font-weight: 600; letter-spacing: 1px;
    cursor: pointer; position: relative; overflow: hidden;
    box-shadow: 0 10px 20px rgba(0,0,0,0.15);
    transition: transform 0.2s;
}
.aura-generate-btn:active { transform: scale(0.98); }

/* AI Loading Animasyonu */
.ai-circle {
    width: 80px; height: 80px;
    border-radius: 50%;
    background: conic-gradient(from 0deg, #ff9a9e, #fad0c4, #fad0c4, #a18cd1, #ff9a9e);
    filter: blur(10px);
    animation: spinAI 2s linear infinite;
    margin-bottom: 20px;
}
@keyframes spinAI { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

.ai-status { font-size: 18px; font-weight: 700; color: #333; margin-bottom: 5px; }
.ai-details { font-size: 13px; color: #888; font-family: monospace; }

/* Sonuç Kartı */
.outfit-card {
    background: white;
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.08);
    height: 100%;
    display: flex; flex-direction: column;
}
.outfit-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
.match-rate { background: #d4fc79; color: #2ecc71; padding: 5px 10px; border-radius: 10px; font-size: 10px; font-weight: 800; color: #333; }
.refresh-icon { background: none; border: none; font-size: 20px; cursor: pointer; }

.outfit-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1.5fr 1fr;
    gap: 10px;
    flex: 1;
}
.outfit-item {
    background: #f8f8f8;
    border-radius: 15px;
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    text-align: center; padding: 10px;
    position: relative; overflow: hidden;
}
.main-piece { grid-column: span 2; background: #fff5f5; }
.item-icon { font-size: 35px; margin-bottom: 5px; filter: drop-shadow(0 5px 5px rgba(0,0,0,0.1)); }
.item-name { font-size: 13px; font-weight: 600; color: #444; line-height: 1.2; }

.color-palette-bar { display: flex; height: 25px; border-radius: 12px; overflow: hidden; margin: 15px 0; border: 1px solid rgba(0,0,0,0.05);}
.color-swatch { flex: 1; height: 100%; }

.stylist-note h4 { margin: 0 0 5px; font-size: 12px; color: #999; text-transform: uppercase; }
.stylist-note p { margin: 0; font-size: 13px; color: #333; font-style: italic; line-height: 1.4; }

.whatsapp-share-btn {
    margin-top: 15px; width: 100%; padding: 12px;
    background: white; color: #333;
    border: 1px solid #333; border-radius: 12px;
    font-weight: 700; cursor: pointer;
}
/* Aura Butonu İçin Özel Işıltı Efekti */
.aura-generate-btn {
    /* Eski stilleri koru, bunu ekle: */
    background: linear-gradient(135deg, #2b1055 0%, #7597de 100%); /* Daha mistik bir mor */
    position: relative;
    overflow: hidden;
    z-index: 1;
}

.aura-generate-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.4),
        transparent
    );
    transition: 0.5s;
    animation: shimmerBtn 3s infinite;
}

@keyframes shimmerBtn {
    0% { left: -100%; }
    20% { left: 100%; }
    100% { left: 100%; }
}

        /* --- AŞK BORSASI STİLLERİ (PART 2) --- */
        #app-stock .modal-content {
            display: flex; flex-direction: column; height: 100%; overflow: hidden;
        }

        .stock-summary-card { padding: 20px 20px 10px; border-bottom: 1px solid #1c1c1e; }
        .market-status { font-size: 11px; font-weight: 800; color: #34C759; letter-spacing: 1px; margin-bottom: 5px; opacity: 0.9; display:flex; align-items:center; gap:5px; }
        .market-status::before { content:''; display:block; width:6px; height:6px; background:#34C759; border-radius:50%; box-shadow:0 0 5px #34C759; animation: pulseGreen 2s infinite; }
        
        .total-valuation h1 { margin: 5px 0; font-size: 42px; font-weight: 700; letter-spacing: -1px; }
        .trend-up { font-size: 14px; color: #34C759; font-weight: 600; display: inline-flex; align-items: center; gap: 4px; background: rgba(52, 199, 89, 0.15); padding: 4px 8px; border-radius: 6px; }

        .chart-area { 
            width: 100%; height: 220px; 
            position: relative; padding: 15px 0; 
            border-bottom: 8px solid #1c1c1e; 
            background: linear-gradient(to bottom, rgba(52, 199, 89, 0.05) 0%, transparent 100%);
        }
        #love-chart { width: 100%; height: 100%; display: block; }

        .stock-list-container { flex: 1; overflow-y: auto; padding-bottom: 20px; }
        .stock-list-header { font-size: 13px; color: #666; font-weight: 700; padding: 15px 20px 5px; letter-spacing: 0.5px; border-bottom: 1px solid #1c1c1e; }

        .stock-item { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; border-bottom: 1px solid #1c1c1e; transition: background 0.2s; cursor: pointer; }
        .stock-item:active { background: #1c1c1e; }

        .stock-left { display: flex; flex-direction: column; }
        .stock-symbol { font-size: 17px; font-weight: 700; color: white; margin-bottom: 3px; }
        .stock-name { font-size: 13px; color: #888; font-weight: 500;}

        .stock-right { display: flex; flex-direction: column; align-items: flex-end; }
        .stock-price { font-size: 17px; font-weight: 600; color: white; margin-bottom: 4px; font-variant-numeric: tabular-nums; }
        
        .stock-badge { padding: 4px 8px; border-radius: 6px; font-size: 14px; font-weight: 700; color: white; min-width: 65px; text-align: center; }
        .stock-badge.up { background: #34C759; }
        .stock-badge.down { background: #FF3B30; }

        .news-ticker-container {
            background: #1c1c1e; color: #34C759;
            font-family: 'Courier New', monospace; font-weight: bold; font-size: 14px;
            padding: 12px 0; overflow: hidden; white-space: nowrap;
            border-top: 1px solid #333; margin-top: auto; 
            position: relative; z-index: 10;
        }
        
        .news-ticker-content { display: inline-block; animation: tickerScroll 20s linear infinite; padding-left: 100%; }

        @keyframes tickerScroll { 0% { transform: translateX(0); } 100% { transform: translateX(-100%); } }
        @keyframes pulseGreen { 0% { opacity: 0.5; } 50% { opacity: 1; box-shadow:0 0 10px #34C759; } 100% { opacity: 0.5; } }

                        
        /* --- LUNA V7 CSS (FIXED COLOR & SCROLL) --- */
        
        /* 1. ANA KAPLAYICI (Kaymayı Önler) */
        #app-luna { background: #000 !important; padding: 0 !important; }
        #app-luna .modal-header { display: none !important; }
        #app-luna .modal-content {
            background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%) !important;
            width: 100% !important; height: 100% !important;
            padding-top: 0 !important; border-radius: 0 !important;
            justify-content: flex-start !important;
            overflow-x: hidden !important; /* YATAY KAYMAYI ENGELLER */
        }

        /* 2. KAPATMA BUTONU */
        .luna-close-absolute {
            position: fixed; top: max(20px, env(safe-area-inset-top)); right: 20px;
            width: 40px; height: 40px; border-radius: 50%;
            background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.2); color: white;
            font-size: 16px; cursor: pointer; z-index: 9999;
            display: flex; align-items: center; justify-content: center;
        }

        /* 3. İÇERİK DÜZENİ */
        .luna-container {
            position: relative; z-index: 10;
            width: 100%; max-width: 100vw; /* Taşmayı önle */
            padding: 60px 20px 40px; box-sizing: border-box; 
            display: flex; flex-direction: column; align-items: center;
        }

        .luna-header { text-align: center; margin-bottom: 20px; width: 100%; }
        .luna-title { font-family: 'Didot', serif; font-size: 36px; letter-spacing: 4px; margin: 0; color: white; text-shadow: 0 0 20px rgba(255,255,255,0.5); }
        #luna-status-text { color: #a5a5cc; font-size: 13px; font-weight: 700; letter-spacing: 2px; text-transform: uppercase; margin-top: 5px; }

        /* 4. YILDIZLAR */
        #stars, #stars2, #stars3 { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1; }
        #stars { width: 1px; height: 1px; box-shadow: 10vw 10vh #FFF, 20vw 40vh #FFF, 80vw 10vh #FFF, 50vw 80vh #FFF, 90vw 90vh #FFF; animation: animStar 50s linear infinite; opacity: 0.6; }
        #stars2 { width: 2px; height: 2px; box-shadow: 15vw 15vh #FFF, 35vw 45vh #FFF, 75vw 25vh #FFF; animation: animStar 100s linear infinite; opacity: 0.4; }
        @keyframes animStar { from { transform: translateY(0); } to { transform: translateY(-100vh); } }

        /* 5. AY GÖRSELİ */
        .moon-stage { position: relative; width: 180px; height: 180px; margin: 10px 0 30px; display: flex; justify-content: center; align-items: center; z-index: 15; flex-shrink: 0; }
        .moon-halo { position: absolute; width: 220px; height: 220px; border-radius: 50%; background: radial-gradient(circle, rgba(255,255,255,0.15) 0%, transparent 60%); animation: pulseHalo 4s infinite; }
        .realistic-moon { width: 160px; height: 160px; border-radius: 50%; background: #dcdce6; position: relative; overflow: hidden; box-shadow: inset -10px -10px 30px rgba(0,0,0,0.9), 0 0 20px rgba(255,255,255,0.2); }
        .moon-texture { position: absolute; width: 100%; height: 100%; background-image: radial-gradient(rgba(0,0,0,0.1) 15%, transparent 16%); background-size: 40px 40px; opacity: 0.4; }
        .moon-shadow { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 50%; background: rgba(9, 10, 15, 0.9); transition: transform 0.5s ease; transform: translateX(100%); }
        
        /* DÜZELTİLDİ: YAZI RENGİ BEYAZ */
        .moon-overlay-text { 
            position: absolute; z-index: 20; text-align: center; 
            color: #FFFFFF; /* BEYAZ YAZI */
            text-shadow: 0 2px 10px rgba(0,0,0,0.9); /* Siyah Gölge (Okunabilirlik için) */
        }
        .moon-overlay-text span { font-size: 50px; font-weight: 700; display: block; line-height: 0.9; font-family: 'Didot', serif; }
        @keyframes pulseHalo { 0%,100%{transform:scale(1); opacity:0.5;} 50%{transform:scale(1.1); opacity:0.8;} }

        /* 6. KARTLAR & BUTONLAR */
        .luna-info-card { background: rgba(255,255,255,0.08); padding: 15px; border-radius: 20px; width: 100%; text-align: center; border: 1px solid rgba(255,255,255,0.1); margin-bottom: 20px; flex-shrink: 0; }
        .luna-actions { width: 100%; display: flex; flex-direction: column; gap: 10px; margin-bottom: 20px; flex-shrink: 0; }
        .luna-btn { padding: 16px; border-radius: 15px; border: none; font-weight: 700; font-size: 15px; cursor: pointer; color: white; position: relative; z-index: 20; }
        .luna-btn:active { transform: scale(0.95); }
        .start-btn { background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%); flex: 1; }
        .end-btn { background: #2c3e50; width: 30%; }
        .notify-btn { background: #25D366; width: 100%; }

        /* 7. TAKVİM */
        .luna-calendar-section { width: 100%; background: rgba(255,255,255,0.08); border-radius: 20px; padding: 15px; border: 1px solid rgba(255,255,255,0.05); margin-top: 10px; display: block; z-index: 20; flex-shrink: 0; }
        .cal-top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .cal-nav { display: flex; align-items: center; gap: 10px; color: white; font-weight: bold; }
        .cal-nav button { background: none; border: none; color: white; font-size: 18px; cursor: pointer; padding: 5px; }
        .reset-data-btn { background: rgba(255, 59, 48, 0.2); color: #ff3b30; border: 1px solid rgba(255, 59, 48, 0.3); padding: 5px 10px; border-radius: 10px; font-size: 11px; cursor: pointer; }
        
        .calendar-grid-header, .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; text-align: center; }
        .calendar-grid-header { margin-bottom: 10px; font-size: 12px; color: #aaa; }
        .cal-day { aspect-ratio: 1; display: flex; align-items: center; justify-content: center; font-size: 13px; color: #ddd; border-radius: 50%; position: relative; }
        .cal-day.today { border: 1px solid rgba(255,255,255,0.8); font-weight: bold; background: rgba(255,255,255,0.1); }
        
        /* İşaretçiler */
        .cal-day.start-marker::after { content: '💧'; position: absolute; bottom: -5px; right: -2px; font-size: 10px; z-index:5; }
        .cal-day.start-marker { background: rgba(255, 65, 108, 0.5); border: 1px solid #ff416c; }
        .cal-day.end-marker::after { content: '✨'; position: absolute; bottom: -5px; right: -2px; font-size: 10px; z-index:5; }
        .cal-day.end-marker { border: 1px solid #a18cd1; background: rgba(161, 140, 209, 0.3); }
        .cal-day.in-period { background: rgba(255, 65, 108, 0.2); }
        .cal-day.in-ovulation { background: rgba(161, 140, 209, 0.2); border: 1px dashed rgba(161, 140, 209, 0.5); }
        .cal-legend { display: flex; gap: 15px; justify-content: center; margin-top: 15px; font-size: 11px; color: #888; }
        .dot { width: 8px; height: 8px; border-radius: 50%; display:inline-block; margin-right:5px; } .dot.red { background: #ff416c; } .dot.purple { background: #a18cd1; }



        /* --- LOVE LAB V2 CSS --- */
        
        /* Temel Lab Ayarları */
        .lab-close-btn { position: absolute; top: max(20px, env(safe-area-inset-top)); right: 20px; width: 35px; height: 35px; border-radius: 50%; background: rgba(255,255,255,0.1); backdrop-filter: blur(5px); border: none; color: white; cursor: pointer; z-index: 20; }
        .lab-bg-glow { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at center, rgba(80, 20, 80, 0.4) 0%, #1a0f2e 80%); pointer-events: none; }
        .lab-container { width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; padding-top: 50px; z-index: 5; }

        /* Kazan */
        .cauldron-area { position: relative; width: 180px; height: 200px; display: flex; justify-content: center; margin: 10px 0; }
        .cauldron { width: 140px; height: 120px; background: #2a2a3a; border-radius: 0 0 70px 70px; position: relative; top: 30px; border: 4px solid #555; overflow: hidden; transition: transform 0.2s; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .cauldron.shaking { animation: shakeCauldron 0.5s infinite; }
        .liquid-surface { position: absolute; bottom: 0; left: 0; width: 100%; height: 20%; background: #333; transition: all 0.5s ease; }
        .cauldron::before { content: ''; position: absolute; top: -10px; left: -5%; width: 110%; height: 20px; background: #3a3a4a; border-radius: 50%; border: 4px solid #555; z-index: 5; }
        .bubbles span { position: absolute; bottom: 0; background: rgba(255,255,255,0.3); border-radius: 50%; animation: bubbleUp 2s infinite; opacity: 0; }
        .cauldron-items-preview { position: absolute; top: 40%; width: 100%; display: flex; justify-content: center; gap: 3px; z-index: 6; }
        .mini-item { width: 20px; height: 20px; font-size: 12px; display: flex; justify-content: center; align-items: center; background: rgba(0,0,0,0.3); border-radius: 50%; animation: dropIn 0.3s forwards; color: white; }

        /* Raf ve Butonlar */
        .ingredients-shelf { width: 92%; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 20px; margin-top: auto; margin-bottom: 30px; border: 1px solid rgba(255,255,255,0.1); }
        .ingredients-shelf h3 { text-align: center; margin: 0 0 10px 0; color: #d57eeb; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }
        .shelf-grid { display: flex; justify-content: space-around; }
        .ingredient { display: flex; flex-direction: column; align-items: center; cursor: pointer; transition: transform 0.1s; }
        .ingredient:active { transform: scale(0.9); }
        .ing-icon { width: 45px; height: 45px; border-radius: 12px; display: flex; justify-content: center; align-items: center; font-size: 22px; margin-bottom: 5px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .ingredient span { font-size: 10px; color: #ccc; }

        .mix-button { padding: 12px 40px; background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); border: none; border-radius: 30px; color: white; font-weight: bold; font-size: 16px; margin: 15px 0; cursor: pointer; transition: all 0.3s; box-shadow: 0 0 15px rgba(255,255,255,0.2); }
        .mix-button.disabled { opacity: 0.3; pointer-events: none; filter: grayscale(1); }

        /* Sonuç Kartı ve WhatsApp */
        .result-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); z-index: 50; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.3s; }
        .result-overlay.active { opacity: 1; pointer-events: auto; }
        .result-card { background: linear-gradient(180deg, #201c2e 0%, #100a1c 100%); width: 85%; padding: 25px; border-radius: 25px; text-align: center; border: 1px solid #d57eeb; transform: scale(0.8); transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: 0 0 40px rgba(213, 126, 235, 0.2); position: relative; z-index: 55; }
        .result-overlay.active .result-card { transform: scale(1); }
        
        .result-actions { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; }
        .whatsapp-btn { background: #25D366; color: white; border: none; padding: 12px; border-radius: 12px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 14px; }
        .collect-btn { background: rgba(255,255,255,0.1); color: white; border: 1px solid rgba(255,255,255,0.2); padding: 10px; border-radius: 12px; cursor: pointer; font-size: 13px; }

        /* --- ÖZEL EFEKT ANİMASYONLARI --- */
        #result-effect-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 40; overflow: hidden; }
        
        .effect-heart { position: absolute; color: #ff4b5c; font-size: 20px; animation: fallDown 3s linear forwards; }
        .effect-fire { position: absolute; width: 100%; height: 100%; background: radial-gradient(circle, rgba(255, 69, 0, 0.3) 0%, transparent 70%); animation: pulseRed 0.5s infinite; }
        .effect-rain { position: absolute; background: #54a0ff; width: 2px; height: 10px; animation: rainFall 1s linear infinite; }
        
        @keyframes shakeCauldron { 0%, 100% { transform: rotate(0deg); } 25% { transform: rotate(-5deg); } 75% { transform: rotate(5deg); } }
        @keyframes bubbleUp { 0% { bottom: 0; opacity: 0; } 50% { opacity: 1; } 100% { bottom: 100%; opacity: 0; } }
        @keyframes dropIn { 0% { transform: translateY(-30px); opacity:0; } 100% { transform: translateY(0); opacity:1; } }
        @keyframes fallDown { 0% { top: -10%; transform: translateX(0); opacity: 1; } 100% { top: 110%; transform: translateX(20px); opacity: 0; } }
        @keyframes rainFall { 0% { top: -10%; opacity: 1; } 100% { top: 110%; opacity: 0.5; } }
        @keyframes pulseRed { 0% { opacity: 0.2; } 50% { opacity: 0.6; } 100% { opacity: 0.2; } }

        /* --- NEON GARDEN STİLLERİ --- */
        #app-garden .modal-content { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; }
        
        #garden-canvas {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            cursor: crosshair; touch-action: none; /* Mobilde kaydırmayı engelle */
        }

        .garden-controls {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 15px; z-index: 50;
        }

        .garden-controls button {
            background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2);
            color: white; padding: 10px 20px; border-radius: 20px;
            font-size: 14px; cursor: pointer; backdrop-filter: blur(5px);
            transition: all 0.3s;
        }
        .garden-controls button:hover { background: rgba(255, 255, 255, 0.2); transform: scale(1.05); }
        .garden-controls button:active { transform: scale(0.95); }



    </style>
</head>
<body>

    <audio id="bg-music" loop><source src="cakal.mp3" type="audio/mpeg"></audio>

    <div class="iphone-frame">
        <div class="wallpaper"></div>

        <div id="lock-screen" class="screen">
            <div class="time-container"><div style="font-size:20px;">🔒</div><div class="time" id="clock">--:--</div><div class="date" id="date">...</div></div>
            <div class="notification-container">
                <div class="notification" onclick="unlockPhone()"><div class="notif-icon-area" style="background:#4CD964;"><span style="font-size:20px; color:white;">💬</span></div><div class="notif-text-area"><div class="notif-header"><span>MESAJLAR</span><span>ŞİMDİ</span></div><div class="notif-content"><h4>Sumru ❤️</h4><p>Sana özel bir sürprizim var!...</p></div></div></div>
                <div class="notification" onclick="unlockPhone()"><div class="notif-icon-area"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/a5/Instagram_icon.png/600px-Instagram_icon.png" alt="IG"></div><div class="notif-text-area"><div class="notif-header"><span>INSTAGRAM</span><span>2dk önce</span></div><div class="notif-content"><h4>Kocan ❤️</h4><p>kocan reels gönderdi ▶️</p></div></div></div>
                <div class="notification" onclick="unlockPhone()"><div class="notif-icon-area" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);"><span style="font-size:20px;">🎵</span></div><div class="notif-text-area"><div class="notif-header"><span>MÜZİK</span><span>ŞİMDİ</span></div><div class="notif-content"><h4>Hatırlatma</h4><p>İlk önce müziğini açmayı unutma 😉</p></div></div></div>
            </div>
            <div class="swipe-hint" onclick="unlockPhone()">Kilidi Açmak İçin Yukarı Kaydır</div><div class="home-bar"></div>
        </div>

        <div id="home-screen" class="screen">
            <div class="app-grid">
                <div class="app-icon" onclick="openApp('photos')"><div class="icon-box photos">📸</div><span class="icon-label">Anılarımız</span></div>
                <div class="app-icon" onclick="openApp('notes')"><div class="icon-box notes">📝</div><span class="icon-label">Mektup</span></div>
                <div class="app-icon" onclick="openApp('music')"><div class="icon-box music">🎵</div><span class="icon-label">Şarkımız</span></div>
                <div class="app-icon" onclick="openApp('maps')"><div class="icon-box maps">📍</div><span class="icon-label">Konum</span></div>
                <div class="app-icon" onclick="openApp('weather')"><div class="icon-box weather">☀️</div><span class="icon-label">Aşk Durumu</span></div>
                <div class="app-icon" onclick="openApp('wheel')"><div class="icon-box wheel-icon">🎡</div><span class="icon-label">Aşk Çarkı</span></div>
                <div class="app-icon" onclick="openApp('settings')"><div class="icon-box settings-icon">⚙️</div><span class="icon-label">Ayarlar</span></div>
                <div class="app-icon" onclick="openApp('wallet')"><div class="icon-box wallet-icon">🎟️</div><span class="icon-label">Cüzdan</span></div>
                <div class="app-icon" onclick="openApp('food')"><div class="icon-box food-icon-bg">🍔</div><span class="icon-label">Aşk Mutfağı</span></div>
                <div class="app-icon" onclick="openApp('fortune')"><div class="icon-box fortune-icon-bg">🔮</div><span class="icon-label">Falcı</span></div>
                <div class="app-icon" onclick="openApp('quiz')"><div class="icon-box quiz-icon-bg">🧠</div><span class="icon-label">Beni Tanı</span></div>
                <div class="app-icon" onclick="openApp('loveflix')"><div class="icon-box loveflix-icon-bg">L</div><span class="icon-label">Loveflix</span></div>
                <div class="app-icon" onclick="openApp('scratch')">
                    <div class="icon-box" style="background: linear-gradient(135deg, #FDC830 0%, #F37335 100%); font-size: 28px;">🎰</div>
                    <span class="icon-label">Şanslısın</span>
                </div>
                <div class="app-icon" onclick="openApp('panic')">
                    <div class="icon-box" style="background: radial-gradient(circle, #ff4b1f 0%, #ff9068 100%); font-size: 28px; border: 2px solid white;">🚨</div>

                    <span class="icon-label" style="color:#ff4b1f; font-weight:bold;">ACİL</span>
                </div>
                <div class="app-icon" onclick="openApp('zen')">
                    <div class="icon-box" style="background: linear-gradient(180deg, #4834d4 0%, #686de0 100%); font-size: 28px;">🧘‍♀️</div>
                    <span class="icon-label">ZenLove</span>
                </div>
<div class="app-icon" onclick="openApp('aura')">
    <div class="icon-box" style="background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%); font-size: 28px; border: 1px solid rgba(255,255,255,0.5);">👗</div>
    <span class="icon-label">Aura</span>
</div>
<div class="app-icon" onclick="openApp('stock')">
    <div class="icon-box" style="background: #1c1c1e;">📈</div>
    <span class="icon-label">Borsa</span>
</div>
<div class="app-icon" onclick="openApp('luna')">
    <div class="icon-box" style="background: linear-gradient(135deg, #240b36 0%, #c31432 100%); border: 1px solid rgba(255,255,255,0.2); font-size: 26px; box-shadow: 0 5px 15px rgba(195, 20, 50, 0.4);">🌙</div>
    <span class="icon-label">Luna</span>
</div>

<div class="app-icon" onclick="openApp('lovelab')">
    <div class="icon-box" style="background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%); border: 1px solid rgba(255,255,255,0.2); font-size: 32px; box-shadow: 0 5px 15px rgba(213, 126, 235, 0.4);">
        🧪
    </div>
    <span class="icon-label">Love Lab</span>
</div>


<div class="app-icon" onclick="openApp('garden')">
    <div class="icon-box" style="background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%); border: 1px solid #39ff14; font-size: 32px; box-shadow: 0 0 15px rgba(57, 255, 20, 0.4);">
        🌱
    </div>
    <span class="icon-label">Neon Garden</span>
</div>


            </div>
            <div class="dock">
                <div class="app-icon" onclick="openApp('phone')"><div class="icon-box" style="background:#4CD964; font-size:24px;">📞</div></div>
                <div class="app-icon" onclick="openApp('mail')"><div class="icon-box" style="background:#5AC8FA; font-size:24px;">📧</div></div>
                <div class="app-icon" onclick="openApp('messages')"><div class="icon-box" style="background:#fff; color:black; font-size:24px;">💬</div></div>
                <div class="app-icon" onclick="openApp('heart')"><div class="icon-box" style="background:#FF2D55; font-size:24px;">❤️</div></div>
            </div>
            <div class="home-bar"></div>
        </div>

        <div id="app-notes" class="app-modal">
            <div class="modal-header"><button class="close-btn" onclick="closeApp('notes')">Kapat</button><span id="note-title">Mektup</span><button class="close-btn" onclick="toggleNoteMode()">✏️</button></div>
            <div class="modal-content" style="padding:20px;">
                <div id="note-read-mode" class="note-paper" style="background:#fffdf2; padding:20px; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1);"><p><b>Canım Sevgilim Sumru,</b></p><p>Seninle geçen her an, hayatımın en güzel güncellemesi gibi... 😊</p><p>Atapark'ta başlayan bu hikaye, şimdi telefonunun ekranında ama en önemlisi kalbimin tam merkezinde.</p><p>Yukarıdaki kaleme basıp sen de bana cevap yazabilirsin.</p><p align="right"><b>- Kocan</b></p></div>
                <div id="note-write-mode" style="display:none; height:100%;"><div class="note-paper" style="background:#fffdf2; padding:20px; border-radius:10px; height:100%;"><p style="color:#888; font-size:14px;">Kocana Cevap Yaz:</p><textarea id="reply-text" class="note-textarea" placeholder="Buraya yazabilirsin sevgilim..."></textarea><button class="whatsapp-btn" onclick="sendWhatsapp()"><span>WhatsApp ile Gönder</span><svg width="20" height="20" viewBox="0 0 24 24" fill="white"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg></button></div></div>
            </div>
        </div>

        <div id="app-weather" class="app-modal">
            <div class="modal-header"><span>Aşk Durumu</span><button class="close-btn" onclick="closeApp('weather')">Kapat</button></div>
            <div class="modal-content">
                <div class="weather-main">
                    <div class="weather-location">📍 Kalbim</div>
                    <div class="weather-icon-large" id="sun-icon">☀️</div>
                    <div class="weather-temp">100%<span style="font-size:30px">❤️</span></div>
                    <div class="weather-desc">Güneşli ve Aşk Dolu</div>
                </div>
                <div class="forecast-list">
                    <div class="forecast-item"><span>Bugün</span><span>💋 Sağanak Öpücük</span></div>
                    <div class="forecast-item"><span>Yarın</span><span>🔥 Sıcak Sarılmalar</span></div>
                    <div class="forecast-item"><span>Çarşamba</span><span>💖 Kalp Çarpıntısı</span></div>
                    <div class="forecast-item"><span>Perşembe</span><span>🥰 Sonsuz Mutluluk</span></div>
                    <div class="forecast-item"><span>Cuma</span><span>💍 Gelecek Hayalleri</span></div>
                    <div class="forecast-item"><span>Cumartesi</span><span>🍿 Film Gecesi</span></div>
                    <div class="forecast-item"><span>Pazar</span><span>🏖️ Birlikte Tatil</span></div>
                    <div class="forecast-item"><span>Haftaya</span><span>💌 Sürprizler</span></div>
                    <div class="forecast-item"><span>Sonsuza Dek</span><span>👫 El Ele</span></div>
                </div>
                <div id="love-explosion-overlay"><h1>AŞK PATLAMASI! 💥❤️</h1></div>
            </div>
        </div>

        <div id="app-wheel" class="app-modal">
            <div class="modal-header"><span>Aşk Çarkı</span><button class="close-btn" onclick="closeApp('wheel')">Kapat</button></div>
            <div class="modal-content">
                <h2 class="wheel-title">Bugün Ne Yapalım?</h2>
                <div class="wheel-container"><div class="wheel-arrow"></div><div class="wheel-outer" id="wheel"><div class="wheel-inner"><div class="wheel-labels"><span style="--i:0;">💆‍♂️</span><span style="--i:1;">📜</span><span style="--i:2;">🎬</span><span style="--i:3;">🧼</span><span style="--i:4;">☕</span><span style="--i:5;">💋</span><span style="--i:6;">🍝</span><span style="--i:7;">🫂</span><span style="--i:8;">🦶</span><span style="--i:9;">❤️</span></div></div></div><div class="wheel-center">❤️</div></div>
                <div style="text-align:center;"><button class="spin-btn" id="spin-btn" onclick="spinWheel()">ÇEVİR</button></div>
                <div id="wheel-result-overlay"><div class="result-box"><span class="result-icon" id="res-icon">🎉</span><h2 class="result-text" id="res-text">Sonuç</h2><button class="result-close-btn" id="res-btn" onclick="closeResultPopup()">Tamam Aşko 💖</button></div></div>
            </div>
        </div>

        <div id="app-settings" class="app-modal">
            <div class="modal-header"><span>Ayarlar</span><button class="close-btn" onclick="closeApp('settings')">Bitti</button></div>
            <div class="modal-content">
                <div class="profile-section">
                    <img src="IMG_7931.jpeg" class="profile-pic">
                    <div class="profile-info"><h3>Sumru & Kocan</h3><p>Aşk ID, iCloud ve Bizim Bulut</p></div>
                </div>
                <div class="settings-group">
                    <div class="setting-item" onclick="toggleAirplaneMode()"><div class="setting-icon" style="background: #F09A37;">✈️</div><div class="setting-label">Uçak Modu</div><div class="setting-value"><input type="checkbox" class="toggle-switch" id="airplane-switch"></div></div>
                    <div class="setting-item" onclick="alert('📶 Sinyal Gücü: %100 (Kalbine tam çekiyor)')"><div class="setting-icon" style="background: #007AFF;">📶</div><div class="setting-label">Wi-Fi</div><div class="setting-value">Kalbine Tam Çekiyor</div></div>
                    <div class="setting-item" onclick="alert('🎧 Kocan Bağlı')"><div class="setting-icon" style="background: #007AFF;">Bluetooth</div><div class="setting-label">Bluetooth</div><div class="setting-value">Sadece Kocanla Eşleşti</div></div>
                    <div class="setting-item" onclick="alert('🔥 Dikkat! Yanabilirsin...')"><div class="setting-icon" style="background: #34C759;">🌐</div><div class="setting-label">Kişisel Erişim Noktası</div><div class="setting-value">Sıcaklık: Çok Yüksek</div></div>
                    <div class="setting-item" onclick="alert('🔐 Bağlantımız şifreli ve koparılamaz!')"><div class="setting-icon" style="background: #007AFF;">🛡️</div><div class="setting-label">VPN</div><div class="setting-value">Virtual Passion Network</div></div>
                </div>
                <div class="settings-group">
                    <div class="setting-item" onclick="alert('🔔 Senden gelen her şey anında ekranda!')"><div class="setting-icon" style="background: #FF3B30;">🔔</div><div class="setting-label">Bildirimler</div><div class="setting-value">Senden Gelince Hep Açık</div></div>
                    <div class="setting-item"><div class="setting-icon" style="background: #FF2D55;">🔊</div><div class="setting-label">Ses ve Dokunuş</div><div class="setting-value">Kalp Atışına Ayarlı</div></div>
                    <div class="setting-item" onclick="alert('🌙 Şu an sadece sen ve ben varız.')"><div class="setting-icon" style="background: #5856D6;">🌙</div><div class="setting-label">Odak</div><div class="setting-value">Sadece Sen</div></div>
                </div>
                <div class="settings-group">
                    <div class="setting-item" onclick="alert('✨ Senin ışığın bana yetiyor sevgilim, ekranı kısmaya gerek yok.')"><div class="setting-icon" style="background: #007AFF;">💡</div><div class="setting-label">Ekran ve Parlaklık</div><div class="setting-value">Işığın Yetiyor</div></div>
                    <div class="setting-item"><div class="setting-icon" style="background: #34C759;">🔋</div><div class="setting-label">Pil</div><div class="setting-value">Seninle %100</div></div>
                </div>
            </div>
        </div>

        <div id="app-wallet" class="app-modal">
            <div class="modal-header"><span>Cüzdan</span><button class="close-btn" onclick="closeApp('wallet')">Bitti</button></div>
            <div class="modal-content">
                <div class="wallet-title">Kuponlarım</div>
                <div class="coupon-card coupon-1" onclick="openCoupon(0)"><div class="coupon-header"><div><div class="coupon-title">Masaj Keyfi</div><small>30 Dakika Kesintisiz</small></div><div class="coupon-icon">💆‍♀️</div></div><div class="coupon-footer"><span>Kocan A.Ş.</span><span>SKT: SONSUZ</span></div></div>
                <div class="coupon-card coupon-2" onclick="openCoupon(1)"><div class="coupon-header"><div><div class="coupon-title">Haklısın Kartı</div><small>Tartışmada 1 Kere Haklı Çık</small></div><div class="coupon-icon">✅</div></div><div class="coupon-footer"><span>Tartışma Bakanlığı</span><span>TEK KULLANIMLIK</span></div></div>
                <div class="coupon-card coupon-3" onclick="openCoupon(2)"><div class="coupon-header"><div><div class="coupon-title">Yemek Ismarla</div><div style="font-size:12px;">İstediğin Yerde, İstediğin Zaman</div></div><div class="coupon-icon">🍽️</div></div><div class="coupon-footer"><span>Kocan Mutfağı</span><span>HER ZAMAN</span></div></div>
                <div class="coupon-card coupon-4" onclick="openCoupon(3)"><div class="coupon-header"><div><div class="coupon-title">Sınırsız Öpücük</div><small>Yanak, Dudak Fark Etmez</small></div><div class="coupon-icon">💋</div></div><div class="coupon-footer"><span>Sevgi Bankası</span><span>LİMİTSİZ</span></div></div>
                <div class="coupon-card coupon-5" onclick="openCoupon(4)"><div class="coupon-header"><div><div class="coupon-title">Yatakta Kahvaltı</div><small>Pazar Sabahı Özel Servis</small></div><div class="coupon-icon">🥞</div></div><div class="coupon-footer"><span>Kocan Cafe</span><span>HAFTA SONU</span></div></div>
                <div class="coupon-card coupon-6" onclick="openCoupon(5)"><div class="coupon-header"><div><div class="coupon-title">Sinema Gecesi</div><small>Film ve Mısır Benden!</small></div><div class="coupon-icon">🍿</div></div><div class="coupon-footer"><span>Kocan Sinemaları</span><span>HER AKŞAM</span></div></div>
                <div class="coupon-card coupon-7" onclick="openCoupon(6)"><div class="coupon-header"><div><div class="coupon-title">Teknoloji Diyeti</div><small>Sadece Biz Olacağız (1 Saat)</small></div><div class="coupon-icon">📵</div></div><div class="coupon-footer"><span>Detoks Merkezi</span><span>İHTİYAÇ HALİNDE</span></div></div>
                <div class="coupon-card coupon-8" onclick="openCoupon(7)"><div class="coupon-header"><div><div class="coupon-title">Sürpriz Randevu</div><small>Plan Benden, Hazırlanmak Senden</small></div><div class="coupon-icon">🥂</div></div><div class="coupon-footer"><span>Kocan Events</span><span>ÖZEL GÜN</span></div></div>
                
                <div class="coupon-card coupon-9" onclick="openCoupon(8)"><div class="coupon-header"><div><div class="coupon-title">Alışveriş Günü</div><small>Bugün kartlar benden!</small></div><div class="coupon-icon">🛍️</div></div><div class="coupon-footer"><span>Kocan Bank</span><span>LIMITSIZ</span></div></div>
                <div class="coupon-card coupon-10" onclick="openCoupon(9)"><div class="coupon-header"><div><div class="coupon-title">Sessizlik Hakkı</div><small>Hiç konuşmadan sarılma hakkı</small></div><div class="coupon-icon">🤫</div></div><div class="coupon-footer"><span>Huzur A.Ş.</span><span>HER AN</span></div></div>
                <div class="coupon-card coupon-11" onclick="openCoupon(10)"><div class="coupon-header"><div><div class="coupon-title">Oyun Gecesi</div><small>Beraber oyun oynuyoruz!</small></div><div class="coupon-icon">🎮</div></div><div class="coupon-footer"><span>Gamer Love</span><span>EĞLENCE</span></div></div>
                <div class="coupon-card coupon-12" onclick="openCoupon(11)"><div class="coupon-header"><div><div class="coupon-title">Özel Şoförlük</div><small>Nereye dersen oraya sürüyorum</small></div><div class="coupon-icon">🚗</div></div><div class="coupon-footer"><span>Kocan Taksi</span><span>7/24</span></div></div>

                
                <div id="coupon-detail-overlay">
                    <div class="coupon-detail-card">
                        <div class="detail-header" id="detail-bg">🎟️</div>
                        <div class="detail-body">
                            <div class="detail-title" id="detail-title">Başlık</div>
                            <div class="detail-desc" id="detail-desc">Açıklama</div>
                            <button class="use-btn" onclick="useCoupon()">Şimdi Kullan</button>
                            <button class="close-detail-btn" onclick="closeCoupon()">Vazgeç</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="app-food" class="app-modal">
            <div class="modal-header"><span>Aşk Mutfağı</span><button class="close-btn" onclick="closeApp('food')">Kapat</button></div>
            <div class="modal-content">
                <div class="food-list">
                    <div class="food-category">Gerçek Lezzetler 😋</div>
                    <div class="food-item" id="item-7"><div class="f-img">🍋</div><div class="f-info"><span class="f-name">Çiğköfte Dürüm</span><span class="f-desc">Bol limonlu, acılı, nar ekşili.</span><span class="f-price">Ayran Senden</span></div><div class="f-actions"><button class="btn-qty btn-minus" onclick="updateFood(7, -1)">-</button><span class="qty-num" id="qty-7">0</span><button class="btn-qty btn-plus" onclick="updateFood(7, 1)">+</button></div></div>
                    <div class="food-item" id="item-8"><div class="f-img">🌯</div><div class="f-info"><span class="f-name">Hatay Döner</span><span class="f-desc">Bol soslu tavuk döner.</span><span class="f-price">Bir Isırık</span></div><div class="f-actions"><button class="btn-qty btn-minus" onclick="updateFood(8, -1)">-</button><span class="qty-num" id="qty-8">0</span><button class="btn-qty btn-plus" onclick="updateFood(8, 1)">+</button></div></div>
                    <div class="food-item" id="item-9"><div class="f-img">🥙</div><div class="f-info"><span class="f-name">Çıtır Lahmacun</span><span class="f-desc">Sumaklı soğan ve maydanoz ile.</span><span class="f-price">Salata Benden</span></div><div class="f-actions"><button class="btn-qty btn-minus" onclick="updateFood(9, -1)">-</button><span class="qty-num" id="qty-9">0</span><button class="btn-qty btn-plus" onclick="updateFood(9, 1)">+</button></div></div>
                     <div class="food-category">Tatlı Krizleri 🍰</div>
                    <div class="food-item" id="item-10"><div class="f-img">🍮</div><div class="f-info"><span class="f-name">Sıcak Sufle</span><span class="f-desc">Akışkan çikolatalı...</span><span class="f-price">Kahve Yanına</span></div><div class="f-actions"><button class="btn-qty btn-minus" onclick="updateFood(10, -1)">-</button><span class="qty-num" id="qty-10">0</span><button class="btn-qty btn-plus" onclick="updateFood(10, 1)">+</button></div></div>
                    <div class="food-category">Kocan Spesiyalleri ❤️</div>
                    <div class="food-item" id="item-1"><div class="f-img">🍔</div><div class="f-info"><span class="f-name">Kocan Burger</span><span class="f-desc">Özel soslu, bol sevgi içeren ev yapımı burger.</span><span class="f-price">1 Öpücük</span></div><div class="f-actions"><button class="btn-qty btn-minus" onclick="updateFood(1, -1)">-</button><span class="qty-num" id="qty-1">0</span><button class="btn-qty btn-plus" onclick="updateFood(1, 1)">+</button></div></div>
                    <div class="food-item" id="item-2"><div class="f-img">🍝</div><div class="f-info"><span class="f-name">Romantik Makarna</span><span class="f-desc">İtalyan usulü, mum ışığı eşliğinde servis.</span><span class="f-price">Sımsıkı Sarılma</span></div><div class="f-actions"><button class="btn-qty btn-minus" onclick="updateFood(2, -1)">-</button><span class="qty-num" id="qty-2">0</span><button class="btn-qty btn-plus" onclick="updateFood(2, 1)">+</button></div></div>
                    <div class="food-item" id="item-3"><div class="f-img">🥞</div><div class="f-info"><span class="f-name">Aşk Krebi</span><span class="f-desc">Çikolatalı, meyveli pazar kahvaltısı efsanesi.</span><span class="f-price">Gülümseme</span></div><div class="f-actions"><button class="btn-qty btn-minus" onclick="updateFood(3, -1)">-</button><span class="qty-num" id="qty-3">0</span><button class="btn-qty btn-plus" onclick="updateFood(3, 1)">+</button></div></div>
                    <div class="food-item" id="item-4"><div class="f-img">☕</div><div class="f-info"><span class="f-name">Kocan Kahvesi</span><span class="f-desc">Yorgunluk alır, muhabbet açar.</span><span class="f-price">5 Dk Masaj</span></div><div class="f-actions"><button class="btn-qty btn-minus" onclick="updateFood(4, -1)">-</button><span class="qty-num" id="qty-4">0</span><button class="btn-qty btn-plus" onclick="updateFood(4, 1)">+</button></div></div>
                    <div class="food-item" id="item-6"><div class="f-img">🍫</div><div class="f-info"><span class="f-name">Çikolata Krizi</span><span class="f-desc">Acil durumlar için özel stoktan.</span><span class="f-price">1 Öpücük</span></div><div class="f-actions"><button class="btn-qty btn-minus" onclick="updateFood(6, -1)">-</button><span class="qty-num" id="qty-6">0</span><button class="btn-qty btn-plus" onclick="updateFood(6, 1)">+</button></div></div>
                </div>
            </div>
            <div class="cart-bar" id="cart-bar" onclick="sendFoodOrder()">
                <div class="cart-total"><span style="font-size:12px; opacity:0.7;">Toplam Tutar</span><span id="cart-total-txt">0 Öpücük</span></div>
                <div class="cart-btn-txt">Sepeti Onayla ></div>
            </div>
        </div>

        <div id="app-fortune" class="app-modal">
            <div class="modal-header"><span>Falcı Bacı</span><button class="close-btn" onclick="closeApp('fortune')">Kapat</button></div>
            <div class="modal-content">
                <div class="crystal-ball-container" onclick="handleFortuneInteraction()">
                    <div class="crystal-ball" id="crystal-ball"></div>
                    <div class="crystal-stand"></div>
                </div>
                <div class="fortune-hint">🔮 Küreye dokun veya telefonu salla...</div>
                <div class="fortune-text" id="fortune-text">Geleceğini görmek için<br>kristal küreye odaklan...</div>
            </div>
        </div>

        <div id="app-quiz" class="app-modal">
            <div class="modal-header"><span>Beni Ne Kadar Tanıyorsun?</span><button class="close-btn" onclick="closeApp('quiz')">Kapat</button></div>
            <div class="modal-content">
                <div class="quiz-container" id="quiz-container">
                    <div class="quiz-question" id="quiz-question">Soru Yükleniyor...</div>
                    <div class="quiz-options" id="quiz-options"></div>
                </div>
                <div id="quiz-result">
                    <div class="score-circle" id="score-circle">0%</div>
                    <h2 id="result-title">Sonuç</h2>
                    <p id="result-msg">Mesaj</p>
                    <button class="quiz-btn" onclick="restartQuiz()" style="margin-top:20px;">Tekrar Oyna 🔄</button>
                </div>
            </div>
        </div>

        <div id="app-loveflix" class="app-modal">
            <div class="modal-header">
                <button class="close-btn" onclick="closeApp('loveflix')">✕</button>
                <div class="header-logo">LOVEFLIX</div>
                <div style="width:35px;"></div> </div>

            <div id="hidden-token-overlay">
                <div class="token-coin" id="token-emoji">🪙</div>
                <div class="token-title" id="token-title">TEBRİKLER!</div>
                <div class="token-msg" id="token-desc">Gizli bir jeton buldun!</div>
                <button class="token-btn" onclick="closeTokenOverlay()">Cüzdana Ekle</button>
            </div>

            <div class="modal-content">
                <div class="hero-section">
                    <div class="hero-overlay"></div>
                    <div class="hero-content">
                        <div class="hero-title">BİZİM HİKAYEMİZ</div>
                        <div class="hero-meta">%98 Eşleşme • 2022 • Romantik • 3 Sezon</div>
                        <div class="hero-desc">İki kalbin Uşak'ta tesadüflerle başlayıp sonsuzluğa uzanan muhteşem hikayesi. Başrollerde Sumru ve Yusuf var.</div>
                        <div class="hero-actions">
                            <button class="play-btn" onclick="playLoveflix()">▶ Oynat</button>
                            <button class="list-btn">➕ Listem</button>
                        </div>
                    </div>
                </div>

                <div class="netflix-row">
                    <div class="row-title">Sumru'nun Favorileri</div>
                    <div class="row-posters">
                        <img src="https://images.unsplash.com/photo-1536440136628-849c177e76a1?w=500" class="poster" onclick="findHiddenToken(this)">
                        <img src="https://images.unsplash.com/photo-1485846234645-a62644f84728?w=500" class="poster" onclick="findHiddenToken(this)">
                        <img src="https://images.unsplash.com/photo-1535016120720-40c6874c3b1c?w=500" class="poster" onclick="findHiddenToken(this)">
                        <img src="https://images.unsplash.com/photo-1517604931442-71053e3e2c28?w=500" class="poster" onclick="findHiddenToken(this)">
                    </div>
                </div>

                <div class="netflix-row">
                    <div class="row-title">Kocanın Seçtikleri</div>
                    <div class="row-posters">
                        <img src="https://images.unsplash.com/photo-1596727147705-54a9d6ed27e6?w=500" class="poster" onclick="findHiddenToken(this)">
                        <img src="https://images.unsplash.com/photo-1626814026160-2237a95fc5a0?w=500" class="poster" onclick="findHiddenToken(this)">
                        <img src="https://images.unsplash.com/photo-1585647347384-2593bc35786b?w=500" class="poster" onclick="findHiddenToken(this)">
                    </div>
                </div>

                <div class="netflix-row">
                    <div class="row-title">Birlikte İzleyelim</div>
                    <div class="row-posters">
                        <img src="https://images.unsplash.com/photo-1478720568477-152d9b164e63?w=500" class="poster" onclick="findHiddenToken(this)">
                        <img src="https://images.unsplash.com/photo-1518199266791-5375a83190b7?w=500" class="poster" onclick="findHiddenToken(this)">
                        <img src="https://images.unsplash.com/photo-1524985069026-dd778a71c7b4?w=500" class="poster" onclick="findHiddenToken(this)">
                    </div>
                </div>
                
                <div style="height: 50px;"></div>
            </div>
        </div>

        <div id="app-scratch" class="app-modal">
            <div class="modal-header">
                <span>Şanslı Kazı Kazan</span>
                <button class="close-btn" onclick="closeApp('scratch')">Kapat</button>
            </div>
            <div class="modal-content">
                <div class="scratch-container">
                    <div class="scratch-header">
                        <h3>Bugün şansına ne çıkacak?</h3>
                        <p>Parmağınla gri alanı kazı!</p>
                    </div>
                    
                    <div class="scratch-card-wrapper">
                        <div class="scratch-prize" id="scratch-prize-text">
                            <span style="font-size:40px;">🎁</span><br>
                            Yükleniyor...
                        </div>
                        <canvas id="scratch-canvas"></canvas>
                    </div>

                    <button class="reset-scratch-btn" onclick="resetScratchCard()">🔄 Yeni Kart Çek</button>
                    
                    <div class="scratch-note">
                        <small>*Çıkan sonuç kesinlikle uygulanmalıdır. İtiraz kabul edilmez! 😎</small>
                    </div>
                </div>
            </div>
        </div>

        <div id="app-panic" class="app-modal">
            <div class="modal-header" style="background: #1a0000; border-bottom: 1px solid #330000;">
                <span style="color: #ff0000; letter-spacing: 1px;">KIRMIZI KOD</span>
                <button class="close-btn" onclick="closeApp('panic')" style="color: white;">✕</button>
            </div>
            <div class="modal-content">
                <div id="panic-overlay-light"></div>
                
                <div id="panic-stage-1" class="panic-stage">
                    <div class="warning-text">DİKKAT: SADECE ACİL DURUMLARDA BASINIZ</div>
                    <div class="big-red-button-container" onclick="activatePanicMode()">
                        <div class="big-red-button">
                            <span>BAS</span>
                        </div>
                        <div class="button-shadow"></div>
                    </div>
                </div>

                <div id="panic-stage-2" class="panic-stage" style="display:none;">
                    <div class="panic-status">⚠️ KRİZ MASASI DEVREDE ⚠️</div>
                    <div class="panic-grid">
                        <div class="panic-item" onclick="sendPanicWhatsapp('ÇİKOLATA KRİZİ')">🍫<br>Acil Çikolata</div>
                        <div class="panic-item" onclick="sendPanicWhatsapp('DEDİKODU VAR')">🗣️<br>Acil Dedikodu</div>
                        <div class="panic-item" onclick="sendPanicWhatsapp('BÖCEK İMHASI')">🕷️<br>Böcek Var!</div>
                        <div class="panic-item" onclick="sendPanicWhatsapp('SEVGİ EKSİKLİĞİ')">🫂<br>Sarılma Lazım</div>
                        <div class="panic-item" onclick="sendPanicWhatsapp('AÇLIKTAN ÖLÜYORUM')">🍔<br>Çok Açım</div>
                        <div class="panic-item" onclick="sendPanicWhatsapp('KREDİ KARTI LİMİTİ')">💸<br>Limit Aç</div>
                        <div class="panic-item" onclick="sendPanicWhatsapp('CAN SIKINTISI')">🥱<br>Kaçır Beni</div>
                        <div class="panic-item" onclick="sendPanicWhatsapp('TRİP ATICAM')">😒<br>Trip Modu</div>
                        <div class="panic-item" onclick="sendPanicWhatsapp('KAOS ÇIKTI')">🔥<br>Kaos Var</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="app-maps" class="app-modal">
            <div class="modal-header"><span>Konum</span><button class="close-btn" onclick="closeApp('maps')">Kapat</button></div>
            <div class="modal-content" style="padding:20px;">
                <div class="map-container-fixed"><iframe class="map-frame" src="https://maps.google.com/maps?q=Uşak+Atapark&t=&z=15&ie=UTF8&iwloc=&output=embed" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe></div>
                <h3 style="margin-top:20px;">📍 Bizim Başlangıcımız</h3><p style="color:#555;">Uşak Atapark'ta hikayemiz başladı...</p>
                <div style="background: linear-gradient(135deg, #FF9A9E 0%, #FECFEF 100%); padding:20px; border-radius:15px; text-align:center; color:white; margin-top:20px; margin-bottom:50px;"><h4>Birlikte Geçen Süre</h4><div style="font-size:32px; font-weight:bold; margin:5px 0;" id="days-counter">0 Gün</div><div style="font-size:12px; opacity:0.8;">24.10.2022'den beri ❤️</div></div>
            </div>
        </div>

        <div id="app-music" class="app-modal">
            <div class="modal-header"><span>Müzik</span><button class="close-btn" onclick="closeApp('music')" style="color:white;">Kapat</button></div>
            <div class="music-bg"></div>
            <div class="music-ui">
                <div class="album-art"></div><div class="song-info"><div class="song-title">Aşk Olsun</div><div class="song-artist">Sen ve Ben</div></div>
                <div class="progress-bar-container"><div class="progress-line"><div class="progress-fill"></div></div><div class="time-info"><span>1:24</span><span>3:45</span></div></div>
                <div class="controls"><div class="ctrl-btn">⏮️</div><div class="ctrl-btn play-pause-btn" onclick="toggleMusic()" id="play-btn">▶️</div><div class="ctrl-btn">⏭️</div></div>
                <div style="margin-top:20px; display:flex; gap:15px; justify-content:center; opacity:0.6;"><span>🔈</span><div style="width:150px; height:4px; background:#555; border-radius:2px; margin-top:10px;"><div style="width:70%; height:100%; background:white;"></div></div><span>🔊</span></div>
            </div>
        </div>

        <div id="app-messages" class="app-modal"><div class="modal-header"><button class="close-btn" onclick="closeApp('messages')">❮ Geri</button><span>Kocan ❤️</span><div style="width:30px"></div></div>
            <div class="modal-content">
                <div class="chat-wrapper">
                    <div class="chat-container" id="chat-list"></div>
                    <div class="msg-typing" id="typing-indicator"><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
                    <div class="chat-input-area"><input type="text" class="chat-input" id="chat-input" placeholder="iMessage"><button class="chat-send-btn" onclick="sendMessage()">⬆️</button></div>
                </div>
            </div>
        </div>
        
        <div id="app-mail" class="app-modal">
            <div class="modal-header"><button class="close-btn" onclick="closeEmailRead()" id="mail-back-btn" style="opacity:0; pointer-events:none;">❮ Gelen</button><span id="mail-header-title">Gelen Kutusu</span><button class="close-btn" onclick="closeApp('mail')">Bitti</button></div>
            <div class="modal-content" style="background:white;">
                <div id="mail-list-view"><div style="padding:10px 20px; font-size:28px; font-weight:700;">Gelenler</div><div class="email-list" id="email-list"></div></div>
                <div id="mail-read-view"><h2 class="read-subject" id="read-subject">Konu</h2><div class="read-meta"><span>Gönderen: <b>Kocan ❤️</b></span><span id="read-time">Zaman</span></div><div class="read-body" id="read-body">İçerik...</div><div class="read-actions" onclick="alert('💌 Mesajın iletildi: Seni çok seviyorum!')">↩️ Yanıtla</div></div>
            </div>
        </div>
        
        <div id="app-phone" class="app-modal">
            <div class="modal-header"><span>Son Aramalar</span><button class="close-btn" onclick="closeApp('phone')">Kapat</button></div>
            <div class="modal-content"><div class="call-list" id="call-list"></div></div>
            <div id="calling-overlay"><img src="IMG_4490.jpeg" class="caller-img"><div class="call-status" id="call-status">Kocan ❤️ aranıyor...</div><div class="call-name">Kocan ❤️</div><div class="call-actions"><div class="action-btn">🔇</div><div class="action-btn">⌨️</div><div class="action-btn">🔊</div><div class="action-btn">➕</div><div class="action-btn hangup-btn" onclick="endFakeCall()">📞</div></div></div>
        </div>
        
        <div id="app-photos" class="app-modal">
            <div class="modal-header"><span>Albüm</span><button class="close-btn" onclick="closeApp('photos')">Kapat</button></div>
            <div class="modal-content">
                <div class="photo-gallery">
                    <img src="IMG_2359.png" class="gallery-photo photo-tall">
                    <img src="IMG_9366.jpeg" class="gallery-photo">
                    <img src="IMG_9406.jpeg" class="gallery-photo">
                    <img src="IMG_8164.jpeg" class="gallery-photo photo-wide">
                    <img src="IMG_4273.jpeg" class="gallery-photo">
                    <img src="IMG_3150.jpeg" class="gallery-photo photo-tall">
                </div>
                <p style="text-align:center; color:#888; margin:20px 0 10px; font-size:14px;">En güzel anılarımız... ❤️</p>
                <div class="surprise-box" onclick="revealSurprise(this)" style="margin: 0 20px 30px;">
                    <div class="initial-text">🎁 Sürpriz İçin Tıkla</div>
                    <div class="surprise-content">Seni Dünyalar Kadar Seviyorum! ❤️<br>İyi ki Benimsin! 🎉</div>
                </div>
            </div>
        </div>

        <div id="app-heart" class="app-modal">
            <button class="close-btn" onclick="closeApp('heart')" style="position:absolute; top:50px; right:20px; color:rgba(255,255,255,0.7); z-index:20;">✕</button>
            <div id="rain-container" style="position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:1;"></div>
            <div class="click-counter">❤️ <span id="heart-count">0</span></div>
            <div class="heart-wrapper"><div class="main-heart idle" id="interaction-heart">❤️</div></div>
            <div id="secret-layer"><h1 style="color:white;">SUMROŞŞ<br>AŞIĞIM<br>SANA! ❤️</h1><div style="font-size:14px; margin-top:30px; opacity:0.8; color:white; border:1px solid white; padding:5px 15px; border-radius:20px;">(Kapatmak için tıkla)</div></div>
            <div id="counter-layer"><div style="font-size:100px;">💍</div><h1 style="color:white; margin-top:20px; padding:0 20px;">24'ünde seni sevdim,<br>daha da bırakmam!</h1><div style="font-size:14px; margin-top:30px; opacity:0.8; color:white; border:1px solid white; padding:5px 15px; border-radius:20px;" onclick="closeCounterLayer()">Seni Seviyorum</div></div>
        </div>

        <div id="app-zen" class="app-modal">
            <div class="modal-header"><span></span><button class="close-btn" onclick="closeApp('zen')">✕</button></div>
            <div class="modal-content">
                <div class="zen-tabs">
                    <div class="zen-tab active" onclick="switchZenTab('breath')" id="tab-breath">Nefes</div>
                    <div class="zen-tab" onclick="switchZenTab('touch')" id="tab-touch">Bağ Kur</div>
                </div>
                <div id="zen-view-breath" style="display:flex; flex-direction:column; align-items:center;">
                    <div class="breath-container breathing"><div class="breath-circle"></div><div class="breath-circle" style="animation-delay: 0.5s; opacity:0.3;"></div><div class="breath-text" id="breath-label">BAŞLA</div></div>
                    <p style="margin-top: 40px; text-align:center; color:#aaa; font-size:14px;">Halkayla birlikte nefes al,<br>sakinleş sevgilim...</p>
                </div>
                <div id="zen-view-touch" style="display:none; flex-direction:column; align-items:center;">
                    <div class="touch-area" id="touch-pad" onmousedown="startTouch()" onmouseup="endTouch()" ontouchstart="startTouch()" ontouchend="endTouch()"><div class="touch-icon">👆</div></div>
                    <p class="touch-hint" id="touch-msg">Parmağını basılı tut ve<br>kalp atışımı hisset...</p>
                </div>
                <div class="zen-quote">"Senin huzurun, benim dünyam."</div>
            </div>
        </div>
<div id="app-aura" class="app-modal">
    <div class="modal-header" style="background: rgba(255,255,255,0.9); border-bottom: 1px solid rgba(0,0,0,0.05);">
        <span style="font-family: 'Didot', serif; font-size: 22px; letter-spacing: 2px; color:#333;">AURA</span>
        <button class="close-btn" onclick="closeApp('aura')" style="color:#333; background:rgba(0,0,0,0.05);">✕</button>
    </div>

    <div class="modal-content" style="background: #faf9f6;">
        
        <div id="aura-input-view" class="aura-view">
            <div class="aura-hero">
                <h1>Bugün Modun Ne?</h1>
                <p>Senin için trendleri tarıyorum...</p>
            </div>

            <div class="aura-selection-group">
                <label>Nereye Gidiyoruz?</label>
                <div class="chip-container">
                    <div class="chip active" onclick="selectAuraFilter(this, 'place', 'cafe')">☕ Kahve</div>
                    <div class="chip" onclick="selectAuraFilter(this, 'place', 'date')">❤️ Date</div>
                    <div class="chip" onclick="selectAuraFilter(this, 'place', 'work')">💼 Ofis</div>
                    <div class="chip" onclick="selectAuraFilter(this, 'place', 'party')">✨ Parti</div>
                    <div class="chip" onclick="selectAuraFilter(this, 'place', 'home')">🏠 Ev Keyfi</div>
                </div>
            </div>

            <div class="aura-selection-group">
                <label>Hava Nasıl?</label>
                <div class="chip-container">
                    <div class="chip active" onclick="selectAuraFilter(this, 'weather', 'sunny')">☀️ Güneşli</div>
                    <div class="chip" onclick="selectAuraFilter(this, 'weather', 'cloudy')">☁️ Serin</div>
                    <div class="chip" onclick="selectAuraFilter(this, 'weather', 'rainy')">☔ Yağmurlu</div>
                    <div class="chip" onclick="selectAuraFilter(this, 'weather', 'cold')">❄️ Soğuk</div>
                </div>
            </div>

            <button class="aura-generate-btn" onclick="startAuraAI()">
                <span>Sihri Başlat ✨</span>
            </button>
        </div>

        <div id="aura-loading-view" class="aura-view" style="display:none; justify-content:center; align-items:center; text-align:center;">
            <div class="ai-circle"></div>
            <div class="ai-status" id="ai-status-text">Trendler Taranıyor...</div>
        </div>

        <div id="aura-result-view" class="aura-view" style="display:none;">
            <div class="outfit-card">
                <div class="outfit-header">
                    <span class="match-rate">%98 EŞLEŞME</span>
                    <button class="refresh-icon" onclick="startAuraAI(true)">🔄</button>
                </div>
                
                <div class="outfit-grid">
                    <div class="outfit-item main-piece" id="res-top">
                        <div class="item-icon">👚</div>
                        <div class="item-name">Yükleniyor...</div>
                    </div>
                    <div class="outfit-item sub-piece" id="res-bottom">
                        <div class="item-icon">👖</div>
                        <div class="item-name">...</div>
                    </div>
                    <div class="outfit-item acc-piece" id="res-shoes">
                        <div class="item-icon">👠</div>
                        <div class="item-name">...</div>
                    </div>
                    <div class="outfit-item acc-piece" id="res-bag">
                        <div class="item-icon">👜</div>
                        <div class="item-name">...</div>
                    </div>
                    <div class="outfit-item acc-piece" id="res-jewelry">
                        <div class="item-icon">💍</div>
                        <div class="item-name">...</div>
                    </div>
                </div>

                <div class="color-palette-bar" id="res-palette"></div>

                <div class="stylist-note">
                    <h4>Stilist Notu ✍️</h4>
                    <p id="res-note">...</p>
                </div>
                
                <button class="whatsapp-share-btn" onclick="shareOutfit()">
                    Kocana Fikrini Sor 💬
                </button>
            </div>
        </div>
    </div>

</div>
<div id="app-stock" class="app-modal">
    <div class="modal-header" style="background: #1c1c1e; color: white; border-bottom: 1px solid #333;">
        <span>Borsa</span>
        <button class="close-btn" onclick="closeApp('stock')" style="color: #34C759; background: rgba(52, 199, 89, 0.2);">Bitti</button>
    </div>
    
    <div class="modal-content" style="background: #000; color: white; padding: 0;">
        
        <div class="stock-summary-card">
            <div class="market-status">🟢 PİYASA AÇIK</div>
            <div class="total-valuation">
                <span style="color:#888; font-size:13px; font-weight:600;">PORTFÖY DEĞERİ</span>
                <h1 style="margin:5px 0; font-size:36px;">♾️ (Sonsuz)</h1>
                <span class="trend-up">▲ %1000 Bugün</span>
            </div>
        </div>

        <div class="chart-area">
            <canvas id="love-chart"></canvas>
        </div>

        <div class="stock-list-container">
            <div class="stock-list-header">HİSSELERİM</div>
            
            <div class="stock-item">
                <div class="stock-left">
                    <span class="stock-symbol">SMR</span>
                    <span class="stock-name">Sumru A.Ş.</span>
                </div>
                <div class="stock-right">
                    <span class="stock-price" id="price-smr">999.9K</span>
                    <div class="stock-badge up">+%5.4</div>
                </div>
            </div>

            <div class="stock-item">
                <div class="stock-left">
                    <span class="stock-symbol">KOC</span>
                    <span class="stock-name">Kocan Holding</span>
                </div>
                <div class="stock-right">
                    <span class="stock-price" id="price-koc">850.5K</span>
                    <div class="stock-badge up">+%4.2</div>
                </div>
            </div>

            <div class="stock-item">
                <div class="stock-left">
                    <span class="stock-symbol">ASK</span>
                    <span class="stock-name">Bizim Hikayemiz</span>
                </div>
                <div class="stock-right">
                    <span class="stock-price">PAHA BİÇİLEMEZ</span>
                    <div class="stock-badge up">🚀</div>
                </div>
            </div>

            <div class="stock-item">
                <div class="stock-left">
                    <span class="stock-symbol">TRP</span>
                    <span class="stock-name">Trip Endeksi</span>
                </div>
                <div class="stock-right">
                    <span class="stock-price" id="price-trp">0.01</span>
                    <div class="stock-badge down">▼%99</div>
                </div>
            </div>
        </div>

        <div class="news-ticker-container">
            <div class="news-ticker-content">
                SON DAKİKA: Sumru güldü, piyasalar coştu! 📈 • Kocası açıklama yaptı: "Ona her baktığımda hisseler tavan yapıyor." • Aşk Borsasında tarihi rekor! • Uzmanlar uyarıyor: Bu ilişki aşırı dozda mutluluk içerir. ⚠️ •
            </div>
        </div>

    </div>
</div>



<div id="app-luna" class="app-modal">
    <div class="modal-content" style="background: #0b0b14; padding: 0; overflow-x: hidden; overflow-y: auto; position: relative;">
        
        <button class="luna-close-absolute" onclick="closeApp('luna')">✕</button>

        <div id="stars"></div>
        <div id="stars2"></div>
        <div id="stars3"></div>

        <div class="luna-container">
            <div class="luna-header">
                <h2 class="luna-title">LUNA</h2>
                <p id="luna-status-text">Döngü Hesaplanıyor...</p>
            </div>

            <div class="moon-stage">
                <div class="moon-halo"></div>
                <div class="realistic-moon">
                    <div class="moon-texture"></div>
                    <div class="moon-shadow" id="moon-shadow-mask"></div>
                </div>
                <div class="moon-overlay-text">
                    <span id="cycle-day-num">--</span>
                    <small>GÜN</small>
                </div>
            </div>

            <div class="luna-info-card">
                <div class="phase-name" id="phase-name">Hoş Geldin</div>
                <p class="phase-desc" id="phase-desc">...</p>
            </div>

            <div class="luna-actions">
                <div style="display: flex; gap: 10px; width: 100%;">
                    <button class="luna-btn start-btn" onclick="setCycleStart()">🩸 Başladı</button>
                    <button class="luna-btn end-btn" onclick="setCycleEnd()">✨ Bitti</button>
                </div>
                <button class="luna-btn notify-btn" onclick="notifyHusbandStatus()">
                    <span>💬 Kocana Bildir</span>
                </button>
            </div>

            <div class="luna-calendar-section">
                <div class="cal-top-bar">
                    <div class="cal-nav">
                        <button onclick="changeLunaMonth(-1)">❮</button>
                        <span id="cal-month-year">...</span>
                        <button onclick="changeLunaMonth(1)">❯</button>
                    </div>
                    <button class="reset-data-btn" onclick="resetLunaData()"> Sıfırla</button>
                </div>
                
                <div class="calendar-grid-header">
                    <span>Pt</span><span>Sa</span><span>Ça</span><span>Pe</span><span>Cu</span><span>Ct</span><span>Pz</span>
                </div>
                <div class="calendar-grid" id="luna-calendar">
                    </div>
                
                <div class="cal-legend">
                    <span><span class="dot red"></span>Regl</span>
                    <span><span class="dot purple"></span>Yumurtlama</span>
                </div>
            </div>

            <div style="height: 80px;"></div>
        </div>
    </div>
</div>

<div id="app-lovelab" class="app-modal">
    <div class="modal-content" style="background: #1a0f2e; color: white; padding: 0; overflow: hidden; position: relative; display: flex; flex-direction: column; align-items: center;">
        
        <button class="lab-close-btn" onclick="closeApp('lovelab')">✕</button>

        <div class="lab-bg-glow"></div>

        <div id="result-effect-container"></div>

        <div class="lab-container">
            <h2 class="lab-title" style="font-family: 'Didot', serif; margin-top: 20px; text-shadow: 0 0 10px #d57eeb;">Aşk Laboratuvarı</h2>
            <p style="color: #aaa; font-size: 12px; margin-bottom: 10px;">Sıralama önemlidir! Önce neyi attığın sonucu değiştirir.</p>

            <div class="cauldron-area">
                <div class="cauldron" id="main-cauldron">
                    <div class="liquid-surface"></div>
                    <div class="bubbles"><span></span><span></span><span></span><span></span><span></span></div>
                    <div class="cauldron-items-preview" id="cauldron-preview"></div>
                </div>
                <div class="cauldron-base"></div>
            </div>

            <button id="mix-btn" class="mix-button disabled" onclick="brewPotion()">⚗️ KARIŞTIR</button>

            <div class="ingredients-shelf">
                <h3>Özler (Sırayla Seç)</h3>
                <div class="shelf-grid">
                    <div class="ingredient" onclick="addToCauldron('love')">
                        <div class="ing-icon" style="background: #ff4b5c;">❤️</div><span>Sevgi</span>
                    </div>
                    <div class="ingredient" onclick="addToCauldron('passion')">
                        <div class="ing-icon" style="background: #ff9f43;">🔥</div><span>Tutku</span>
                    </div>
                    <div class="ingredient" onclick="addToCauldron('attention')">
                        <div class="ing-icon" style="background: #feca57;">✨</div><span>İlgi</span>
                    </div>
                    <div class="ingredient" onclick="addToCauldron('sweet')">
                        <div class="ing-icon" style="background: #d57eeb;">🍫</div><span>Tatlı</span>
                    </div>
                    <div class="ingredient" onclick="addToCauldron('trip')">
                        <div class="ing-icon" style="background: #54a0ff;">💧</div><span>Trip</span>
                    </div>
                </div>
            </div>
        </div>

        <div id="potion-result-overlay" class="result-overlay hidden">
            <div class="result-card">
                <div class="result-icon" id="result-icon">🎉</div>
                <h3 id="result-title">Sonuç</h3>
                <p id="result-desc">...</p>
                
                <div class="result-actions">
                    <button class="whatsapp-btn" onclick="shareResultOnWP()">
                        <span style="font-size:18px; margin-right:5px;">📱</span> WhatsApp'tan At
                    </button>
                    <button class="collect-btn" onclick="closeResultOverlay()">Tamam</button>
                </div>
            </div>
        </div>

    </div>
</div>

<div id="app-garden" class="app-modal">
    <div class="modal-content" style="background: #000; padding: 0; overflow: hidden; position: relative;">
        
        <button class="lab-close-btn" onclick="closeApp('garden')" style="z-index: 100;">✕</button>

        <div class="garden-controls">
            <button onclick="clearGarden()">🗑️ Temizle</button>
            <button onclick="saveGarden()">📸 Kaydet</button>
        </div>

        <canvas id="garden-canvas"></canvas>
        
        <div id="garden-hint" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: rgba(255,255,255,0.3); pointer-events: none; text-align: center;">
            <div style="font-size: 40px; margin-bottom: 10px;">👆</div>
            <p>Bahçeni büyütmek için dokun ve sürükle...</p>
        </div>

    </div>
</div>



<script>
        function updateTime(){const n=new Date();document.getElementById('clock').innerText=String(n.getHours()).padStart(2,'0')+':'+String(n.getMinutes()).padStart(2,'0');document.getElementById('date').innerText=n.toLocaleDateString('tr-TR',{weekday:'long',day:'numeric',month:'long'});const s=new Date("2022-10-24");const d=Math.ceil(Math.abs(n-s)/(1000*60*60*24));document.getElementById('days-counter').innerText=d+" Gündür";}setInterval(updateTime,1000);updateTime();
        function unlockPhone(){document.getElementById('lock-screen').style.transform='translateY(-100%)';document.getElementById('home-screen').style.transform='translateY(0)';}
        
        function openApp(id){
            document.getElementById('app-'+id).classList.add('active');
            if(id==='messages')loadMessages();
            if(id==='mail')loadEmails();
            if(id==='phone')loadCalls();
            if(id==='heart')resetHeartApp();
            if(id==='quiz')restartQuiz();
            if(id==='scratch')initScratchCard();
            if(id==='panic') resetPanicMode();
            if(id==='zen') switchZenTab('breath'); // YENİ EKLENDİ
        }

        function closeApp(id){document.getElementById('app-'+id).classList.remove('active');if(id==='heart')stopRain(); if(id==='zen')stopBreathingText();} // ZEN DÜZELTMESİ EKLENDİ
        function toggleNoteMode(){const r=document.getElementById('note-read-mode');const w=document.getElementById('note-write-mode');if(r.style.display!=='none'){r.style.display='none';w.style.display='block';document.getElementById('note-title').innerText='Cevap Yaz';}else{r.style.display='block';w.style.display='none';document.getElementById('note-title').innerText='Mektup';}}
        function sendWhatsapp(){var m=document.getElementById('reply-text').value;if(m.trim()===""){alert("Lütfen önce güzel bir şeyler yaz :)");return;}window.location.href="https://wa.me/905315581447?text="+encodeURIComponent(m);}
        var audio=document.getElementById('bg-music');function toggleMusic(){if(audio.paused){audio.play();document.getElementById('play-btn').innerText='⏸️';}else{audio.pause();document.getElementById('play-btn').innerText='▶️';}}

        // KALP MANTIĞI
        const heartEl = document.getElementById('interaction-heart');
        const secretLayer = document.getElementById('secret-layer');
        const counterLayer = document.getElementById('counter-layer');
        const countSpan = document.getElementById('heart-count');
        const rainContainer = document.getElementById('rain-container');
        let pressTimer, rainInterval, heartClickCount = 0, isPressing = false;

        function resetHeartApp() { heartEl.classList.remove('growing', 'tap'); heartEl.classList.add('idle'); secretLayer.classList.remove('visible'); counterLayer.classList.remove('visible'); stopRain(); heartClickCount = 0; countSpan.innerText = heartClickCount; isPressing = false; }
        function startAction(e) { e.preventDefault(); isPressing = true; startRain(); heartEl.classList.remove('idle'); heartEl.classList.add('tap'); pressTimer = setTimeout(() => { if(isPressing) { heartEl.classList.remove('tap'); heartEl.classList.add('growing'); setTimeout(() => { if(isPressing) { secretLayer.classList.add('visible'); heartEl.classList.remove('growing'); stopRain(); } }, 3000); } }, 250); }
        function endAction(e) { isPressing = false; clearTimeout(pressTimer); if (!heartEl.classList.contains('growing') && !secretLayer.classList.contains('visible')) { heartClickCount++; countSpan.innerText = heartClickCount; if(heartClickCount === 24) counterLayer.classList.add('visible'); } heartEl.classList.remove('growing', 'tap'); heartEl.classList.add('idle'); setTimeout(stopRain, 1000); }
        heartEl.addEventListener('mousedown', startAction); heartEl.addEventListener('touchstart', startAction); heartEl.addEventListener('mouseup', endAction); heartEl.addEventListener('touchend', endAction); heartEl.addEventListener('mouseleave', endAction);
        secretLayer.addEventListener('click', () => secretLayer.classList.remove('visible'));
        function closeCounterLayer() { counterLayer.classList.remove('visible'); }
        function startRain() { if(!rainInterval) rainInterval = setInterval(createFallingHeart, 100); }
        function stopRain() { clearInterval(rainInterval); rainInterval = null; }
        function createFallingHeart() { const h = document.createElement('div'); h.classList.add('falling-heart'); h.innerText = ['❤️', '💖', '💕', '💗'][Math.floor(Math.random() * 4)]; h.style.left = Math.random() * 100 + '%'; h.style.fontSize = (Math.random() * 20 + 15) + 'px'; h.style.animationDuration = (Math.random() * 3 + 2) + 's'; rainContainer.appendChild(h); setTimeout(() => h.remove(), 5000); }

        // SÜRPRİZ KONFETİ PATLAMASI
        function revealSurprise(el) { if(el.classList.contains('revealed')) return; el.classList.add('revealed'); const initialText = el.querySelector('.initial-text'); const hiddenContent = el.querySelector('.surprise-content'); initialText.style.opacity = '0'; setTimeout(() => { initialText.style.display = 'none'; hiddenContent.style.display = 'block'; void hiddenContent.offsetWidth; hiddenContent.style.opacity = '1'; hiddenContent.style.transform = 'translateY(0)'; }, 300); const photoModal = document.getElementById('app-photos'); for(let i=0; i<150; i++) { const c = document.createElement('div'); c.classList.add('confetti'); c.innerText = ['❤️', '✨', '🎉', '🌸', '💖'][Math.floor(Math.random() * 5)]; c.style.left = (50 + (Math.random() - 0.5) * 20) + '%'; c.style.top = '70%'; c.style.fontSize = (Math.random() * 20 + 10) + 'px'; c.style.setProperty('--x', (Math.random() - 0.5) * 300 + 'px'); c.style.setProperty('--y', (Math.random() - 1) * 400 + 'px'); c.style.setProperty('--r', (Math.random() - 0.5) * 720 + 'deg'); photoModal.appendChild(c); setTimeout(() => c.remove(), 2000); } }

        // TELEFON
        let callTimer; function startFakeCall() { document.getElementById('calling-overlay').style.display = 'flex'; setTimeout(() => { let sec = 0; const status = document.getElementById('call-status'); callTimer = setInterval(() => { sec++; const min = Math.floor(sec / 60).toString().padStart(2,'0'); const s = (sec % 60).toString().padStart(2,'0'); status.innerText = `${min}:${s}`; }, 1000); }, 2000); }
        function endFakeCall() { document.getElementById('calling-overlay').style.display = 'none'; clearInterval(callTimer); document.getElementById('call-status').innerText = "Kocan ❤️ aranıyor..."; }

        // MESAJLAŞMA
        const replies = ["Seni çok seviyorum, her şeyim ❤️", "Ömrüm benim, iyi ki varsın 😍", "Kalbimin tek sahibisin ❤️", "Sen harikasın!", "Sana bayılıyorum kadınım ❤️", "Mesajını görünce günüm aydınlandı ☀️", "Yanında olmayı çok isterdim şu an.", "Seni düşünmeden edemiyorum...", "Benim güzel sevgilim 💖", "Seninle geçen her an çok değerli.", "Dünyanın en şanslı adamıyım.", "Gözlerin aklıma geldi şimdi... 😍", "Seni kocaman öpüyorum! 😘", "Ben de seni çok özledim...", "Sen benim nefesimsin Sumru.", "Hayallerimin başrolüsün ❤️"];
        let lastReplyIndex = null;
        function loadMessages(){ const c=document.getElementById('chat-list');if(c.innerHTML.trim()!=="")return; const msgs=[{t:"Merhaba güzellik 👋",s:"in"},{t:"Akşam Atapark'ta buluşalım mı?",s:"in"},{t:"Seni seviyorum Sumru!",s:"in"}]; msgs.forEach(m=>{c.innerHTML+=`<div class="msg-bubble ${m.s==='in'?'msg-received':'msg-sent'}">${m.t}</div>`;}); }
        function sendMessage() { const input = document.getElementById('chat-input'); const text = input.value; if(text.trim() === "") return; const container = document.getElementById('chat-list'); container.innerHTML += `<div class="msg-bubble msg-sent">${text}</div>`; input.value = ""; container.scrollTop = container.scrollHeight; setTimeout(() => { const typing = document.getElementById('typing-indicator'); typing.style.display = 'block'; container.scrollTop = container.scrollHeight; setTimeout(() => { typing.style.display = 'none'; let newIndex; do { newIndex = Math.floor(Math.random() * replies.length); } while (newIndex === lastReplyIndex && replies.length > 1); lastReplyIndex = newIndex; const randomReply = replies[newIndex]; container.innerHTML += `<div class="msg-bubble msg-received">${randomReply}</div>`; container.scrollTop = container.scrollHeight; }, 2000); }, 500); }

        // MAIL & CALLS
        const mailData = [{s:"Sürpriz Hazır! 🎁", p:"Akşama gözlerini kapatmanı isteyeceğim...", t:"14:20", b:"Canım Sevgilim,\n\nBu akşam için küçük ama çok seveceğini düşündüğüm bir sürpriz hazırladım. \n\nSeni çok seviyorum.\n-Kocan"},{s:"Sonsuzluğa...", p:"Seninle başladığımız bu yolculukta...", t:"10:30", b:"Hayatımın anlamı,\n\nSeninle her gün yeni bir macera. Sonsuzluğa kadar el ele yürümek dileğiyle."},{s:"Uçak Biletleri: Roma", p:"Hayallerimizi gerçekleştirmeye bir adım daha...", t:"09:15", b:"Aşkım,\n\nRoma biletlerine baktım..."},{s:"Tatil Planları 🏖️", p:"Bu yaz nereye gitmek istersin?", t:"Dün", b:"Yaz yaklaşıyor güzelim..."},{s:"Netflix Şifresi", p:"Yeni şifreyi unuttun mu yoksa? :)", t:"Dün", b:"Şifre: SumruCokGuzel123"},{s:"Sabah Kahvesi",p:"Uyandın mı güzellik?",t:"Paz",b:"Günaydın aşkım, kahveni yaptım seni bekliyorum."},{s:"Rüyamda Seni Gördüm",p:"O kadar güzeldin ki...",t:"Paz",b:"Hala etkisindeyim, rüyamda bile yanımdasın."},{s:"Fotoğraf Arşivi",p:"Eski fotoğrafları buldum!",t:"Cum",b:"İlk buluşmamızdaki fotoğrafımıza bakıp duruyorum."},{s:"Sadece Sen",p:"Aklımdan çıkmıyorsun.",t:"Per",b:"İş yerindeyim ama aklım fikrim sende."},{s:"Fatura Hatırlatması",p:"Şaka şaka, öpücük faturası!",t:"Çar",b:"Borcunuz: 1000 öpücük. Hemen tahsil edilmeli."}];
        function loadEmails(){ const e = document.getElementById('email-list'); if(e.innerHTML.trim()!=="") return; mailData.forEach((m, i) => { e.innerHTML += `<div class="email-item" onclick="openEmail(${i})"><div><b>Kocan ❤️</b><br>${m.s}<br><small style="color:#888;">${m.p}</small></div><small style="color:#888;">${m.t}</small></div>`; }); }
        function openEmail(index) { const m = mailData[index]; document.getElementById('read-subject').innerText = m.s; document.getElementById('read-time').innerText = m.t; document.getElementById('read-body').innerText = m.b; document.getElementById('mail-list-view').style.display = 'none'; document.getElementById('mail-read-view').style.display = 'block'; document.getElementById('mail-back-btn').style.opacity = '1'; document.getElementById('mail-back-btn').style.pointerEvents = 'auto'; }
        function closeEmailRead() { document.getElementById('mail-read-view').style.display = 'none'; document.getElementById('mail-list-view').style.display = 'block'; document.getElementById('mail-back-btn').style.opacity = '0'; document.getElementById('mail-back-btn').style.pointerEvents = 'none'; }
        
        function loadCalls(){const p=document.getElementById('call-list');if(p.innerHTML.trim()!=="")return;
            const calls=[{t:"missed",c:3,tm:"03:15"},{t:"in",c:0,tm:"00:42"},{t:"out",c:0,tm:"23:15"},{t:"missed",c:1,tm:"20:30"},{t:"in",c:0,tm:"18:45"},{t:"out",c:0,tm:"12:20"},{t:"missed",c:5,tm:"09:00"},{t:"in",c:0,tm:"08:30"},{t:"in",c:0,tm:"Dün"},{t:"out",c:0,tm:"Dün"},{t:"missed",c:2,tm:"Dün"}];
            calls.forEach(c=>{p.innerHTML+=`<div class="call-item" onclick="startFakeCall()"><div style="display:flex;align-items:center;gap:10px;"><span style="font-size:18px;">📞</span><div><b style="color:${c.t==='missed'?'#FF3B30':'#000'}">Kocan ❤️</b><br><small style="color:#888">Mobil • ${c.t==='missed'?'Cevapsız ('+c.c+')':(c.t==='in'?'Gelen':'Giden')}</small></div></div><small style="color:#888">${c.tm}</small></div>`;});}

        // AŞK DURUMU MANTIĞI
        const sunIcon = document.getElementById('sun-icon');
        const loveExplosion = document.getElementById('love-explosion-overlay');
        let sunTimer;

        sunIcon.addEventListener('mousedown', startSunPress);
        sunIcon.addEventListener('touchstart', startSunPress);
        sunIcon.addEventListener('mouseup', endSunPress);
        sunIcon.addEventListener('touchend', endSunPress);
        sunIcon.addEventListener('mouseleave', endSunPress);

        function startSunPress(e) {
            e.preventDefault();
            sunIcon.classList.add('growing');
            sunTimer = setTimeout(() => {
                loveExplosion.classList.add('visible');
                sunIcon.classList.remove('growing');
                setTimeout(() => { loveExplosion.classList.remove('visible'); }, 3000);
            }, 2000);
        }
        function endSunPress() { clearTimeout(sunTimer); sunIcon.classList.remove('growing'); }

        // AŞK ÇARKI MANTIĞI
        const wheel = document.getElementById('wheel');
        const resOverlay = document.getElementById('wheel-result-overlay');
        const resIcon = document.getElementById('res-icon');
        const resText = document.getElementById('res-text');
        const spinBtn = document.getElementById('spin-btn');
        const resBtn = document.getElementById('res-btn');
        const wheelModal = document.getElementById('app-wheel');
        let currentDeg = 0;
        let isSpinning = false;

        function spinWheel() {
            if(isSpinning) return; spinBtn.disabled = true; isSpinning = true;
            const randomSpins = 5; 
            const randomDegree = Math.floor(Math.random() * 360);
            const totalDegree = (randomSpins * 360) + randomDegree;
            currentDeg += totalDegree; wheel.style.transform = `rotate(${currentDeg}deg)`;

            setTimeout(() => {
                const actualDeg = currentDeg % 360;
                const angleUnderPointer = (360 - actualDeg) % 360;
                const finalSegment = Math.floor(angleUnderPointer / 36);

                const options = [
                    {i:"💆‍♂️", t:"Masaj Yap"}, {i:"📜", t:"Bana Şiir Oku"}, {i:"🎬", t:"Film Seç"}, 
                    {i:"🧼", t:"Bulaşıklar Sende!"}, {i:"☕", t:"Kahve Ismarla"}, {i:"💋", t:"Kocaman Öp"},
                    {i:"🍝", t:"Romantik Yemek"}, {i:"🫂", t:"Sımsıkı Sarıl"}, 
                    {i:"🦶", t:"10 Dk Ayak Masajı"}, {i:"❤️", t:"Seni Seviyorum De"}
                ];
                resIcon.innerText = options[finalSegment].i; resText.innerText = options[finalSegment].t;
                
                const buttonTexts = [
                    "Tamam Aşko 💖", "Hemen Yapıyorum! 🏃‍♂️", "Emrin Olur Prenses 👑", 
                    "Anlaştık! 🤝", "Zevkle! 😍", "Şansıma Küs! 😂", "Hadi Bakalım! 🔥",
                    "Sen İste Yeter 💘", "Mesaj Alındı 💌", "Uuu Beybi! 😏"
                ];
                resBtn.innerText = buttonTexts[Math.floor(Math.random() * buttonTexts.length)];

                resOverlay.classList.add('visible');

                for(let i=0; i<100; i++) { 
                    const c = document.createElement('div'); c.classList.add('confetti'); 
                    c.innerText = ['❤️', '✨', '🎉'][Math.floor(Math.random() * 3)]; 
                    c.style.left = '50%'; c.style.top = '50%';
                    c.style.fontSize = (Math.random() * 20 + 10) + 'px'; 
                    c.style.setProperty('--x', (Math.random() - 0.5) * 500 + 'px'); 
                    c.style.setProperty('--y', (Math.random() - 0.5) * 500 + 'px'); 
                    c.style.setProperty('--r', (Math.random() * 360) + 'deg'); 
                    wheelModal.appendChild(c); setTimeout(() => c.remove(), 2000); 
                }
            }, 4000);
        }
        function closeResultPopup() { resOverlay.classList.remove('visible'); spinBtn.disabled = false; isSpinning = false; }

        // AYARLAR ETKİLEŞİMİ
        function toggleAirplaneMode() {
            const sw = document.getElementById('airplane-switch');
            sw.checked = !sw.checked; 
            if(sw.checked) { alert("✈️ Uçuşa geçildi! Şu an yerle irtibat kesildi, sadece seninle havadayız aşkım."); } else { alert("🌍 Yere iniş yapıldı ama aklım hala bulutların üzerinde..."); }
        }

        // CÜZDAN KUPON MANTIĞI
        const coupons = [
            {t:"Masaj Keyfi", d:"Bu kupon 30 dakika kesintisiz, rahatlatıcı bir masaj hakkı verir. Yağlar Kocandan!", c:"linear-gradient(135deg, #FF9A9E 0%, #FECFEF 100%)", i:"💆‍♀️"},
            {t:"Haklısın Kartı", d:"Herhangi bir tartışmada anında haklı çıkma garantisi. Sorgusuz sualsiz geçerlidir.", c:"linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%)", i:"✅"},
            {t:"Yemek Ismarla", d:"Bugün mutfak kapalı! İstediğin restoranda, istediğin yemeği ısmarlıyorum.", c:"linear-gradient(135deg, #8fd3f4 0%, #84fab0 100%)", i:"🍽️"},
            {t:"Sınırsız Öpücük", d:"Bu kuponun limiti yoktur. İstenildiği zaman, istenildiği kadar kullanılabilir.", c:"linear-gradient(135deg, #fccb90 0%, #d57eeb 100%)", i:"💋"},
            {t:"Yatakta Kahvaltı", d:"Pazar sabahı uyanmak yok! Kocan kahvaltıyı yatağına getirecek.", c:"linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%)", i:"🥞"},
            {t:"Sinema Gecesi", d:"Film seçimi, mısır patlatma ve içecek servisi tamamen bana ait.", c:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)", i:"🍿"},
            {t:"Teknoloji Diyeti", d:"Telefonları kapatıyoruz. 1 saat boyunca sadece birbirimize odaklanıyoruz.", c:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)", i:"📵"},
            {t:"Sürpriz Randevu", d:"Nereye gideceğimizi sorma. Hazırlan ve bana güven.", c:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)", i:"🥂"},
            {t:"Alışveriş Günü", d:"Bugün limit yok (şaka şaka var ama sana feda olsun). Kartım emrine amade!", c:"linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)", i:"🛍️"},
            {t:"Sessizlik Hakkı", d:"Bazen sadece susup sarılmak istersin. Bu kupon o anlar için.", c:"linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%)", i:"🤫"},
            {t:"Oyun Gecesi", d:"İstediğin oyunu oynuyoruz! Kazanmana izin verebilirim... belki.", c:"linear-gradient(135deg, #8fd3f4 0%, #84fab0 100%)", i:"🎮"},
            {t:"Özel Şoförlük", d:"Araba bende. Nereye gitmek istersen şoförün hazır!", c:"linear-gradient(135deg, #fccb90 0%, #d57eeb 100%)", i:"🚗"}
        ];

        let currentCouponIndex = -1;
        function openCoupon(index) {
            currentCouponIndex = index;
            const c = coupons[index];
            document.getElementById('detail-title').innerText = c.t;
            document.getElementById('detail-desc').innerText = c.d;
            document.getElementById('detail-bg').innerText = c.i;
            document.querySelector('.coupon-detail-card .detail-header').style.background = c.c;
            document.getElementById('coupon-detail-overlay').classList.add('visible');
        }

        function closeCoupon() { document.getElementById('coupon-detail-overlay').classList.remove('visible'); }

        function useCoupon() {
            if(currentCouponIndex === -1) return;
            const c = coupons[currentCouponIndex];
            const message = `Aşkım! ❤️ Şu kuponumu kullanmak istiyorum: \n\n🎫 *${c.t}*\n📝 ${c.d}`;
            alert(`🎉 Harika seçim aşkım! "${c.t}" kuponu işleme alındı.\n\nKocan hazırlanmaya başlasın... 😉`);
            window.location.href = `https://api.whatsapp.com/send?phone=905315581447&text=${encodeURIComponent(message)}`;
            closeCoupon();
        }

        // AŞK MUTFAĞI
        const foodMenu = {
            1: {n: "Kocan Burger", p: "1 Öpücük"},
            2: {n: "Romantik Makarna", p: "Sımsıkı Sarılma"},
            3: {n: "Aşk Krebi", p: "Gülümseme"},
            4: {n: "Kocan Kahvesi", p: "5 Dk Masaj"},
            6: {n: "Çikolata Krizi", p: "1 Öpücük"},
            7: {n: "Çiğköfte Dürüm", p: "Ayran Senden"},
            8: {n: "Hatay Döner", p: "Bir Isırık"},
            9: {n: "Çıtır Lahmacun", p: "Salata Benden"},
            10: {n: "Sıcak Sufle", p: "Kahve Yanına"}
        };
        const foodCart = {}; 

        function updateFood(id, change) {
            if (!foodCart[id]) foodCart[id] = 0;
            foodCart[id] += change;
            if (foodCart[id] < 0) foodCart[id] = 0;
            document.getElementById('qty-' + id).innerText = foodCart[id];
            const itemDiv = document.getElementById('item-' + id);
            if (foodCart[id] > 0) { itemDiv.classList.add('has-item'); } else { itemDiv.classList.remove('has-item'); }
            checkCartBar();
        }

        function checkCartBar() {
            const bar = document.getElementById('cart-bar');
            let totalItems = 0;
            for (const value of Object.values(foodCart)) { totalItems += value; }
            if (totalItems > 0) { bar.classList.add('active'); document.getElementById('cart-total-txt').innerText = "Bolca Aşk & Lezzet"; } else { bar.classList.remove('active'); }
        }

        function sendFoodOrder() {
            let message = "Aşkım acıktım! 😋\nİşte siparişlerim:\n\n";
            let hasItem = false;
            for (const [key, value] of Object.entries(foodCart)) {
                if (value > 0) { message += `▪️ ${value}x ${foodMenu[key].n}\n`; hasItem = true; }
            }
            message += "\nÖdeme Yöntemi: Kocamın Kartı 💋\nHemen Bekliyorum!";
            if(hasItem) {
                alert("Siparişin Alındı Prenses! 🚀\n\nKocan hemen hazırlıklara başlıyor... Whatsapp'a yönlendiriliyorsun.");
                window.location.href = `https://api.whatsapp.com/send?phone=905315581447&text=${encodeURIComponent(message)}`;
            }
        }

        // GÜNCELLENMİŞ FALCI (HAFIZALI - TEKRAR YOK)
        const fortunes = ["3 vakte kadar sana bir sürpriz görünüyor... 🎁", "Geleceğinde çok yakışıklı bir adam var... Aa o benim! 😎", "Bu akşam bulaşıklar kocana kısmet görünüyor. 🍽️", "Yolun açık, sonu nikah tazeleme. 💍", "Aşk hayatın alev alev yanıyor! 🔥", "Bugün şansın çok yüksek, hemen bir dilek tut! ✨", "Falında kocaman bir sarılma çıktı. 🤗", "Gözlerinde bir ışıltı var, sebebi aşk olsa gerek. ❤️", "Kısmetinde Atapark'ta romantik bir yürüyüş var. 🌳", "Kocan seni düşünüyor, kulağın çınlamadı mı? 👂", "Bugün sana bir kahve borcu var. ☕", "Telefonun çalacak, arayan kalbinin sahibi. 📞", "Rüyanda beni göreceksin, kaçış yok! 😴", "Bu hafta sonu ayakların yerden kesilecek. ✈️", "Şu an sarılmaya ihtiyacın var, sinyaller alındı. 📡", "Gönlünün efendisi seni çok özlemiş. 🥰", "Yakında minik bir hediye kapını çalabilir. 🎁", "Yıldızlar diyor ki: Kocan seni çok seviyor. ⭐"];
        let fortuneHistory = []; 
        const fortuneBall = document.getElementById('crystal-ball');
        const fortuneText = document.getElementById('fortune-text');
        let isFortuneTelling = false;

        function handleFortuneInteraction() {
            if (typeof DeviceMotionEvent.requestPermission === 'function' && localStorage.getItem('motionPermission') !== 'granted') {
                DeviceMotionEvent.requestPermission().then(permissionState => { if (permissionState === 'granted') { localStorage.setItem('motionPermission', 'granted'); tellFortune(); } }).catch(console.error);
            } else { tellFortune(); }
        }

        function tellFortune() {
            if(isFortuneTelling) return; isFortuneTelling = true; fortuneBall.classList.add('shaking'); fortuneText.classList.remove('visible');
            setTimeout(() => {
                fortuneBall.classList.remove('shaking');
                let available = fortunes.filter(f => !fortuneHistory.includes(f));
                if (available.length === 0) { fortuneHistory = []; available = fortunes; }
                const selected = available[Math.floor(Math.random() * available.length)];
                fortuneHistory.push(selected); if(fortuneHistory.length > 8) fortuneHistory.shift();
                fortuneText.innerHTML = selected; fortuneText.classList.add('visible'); isFortuneTelling = false;
            }, 2000);
        }

        if (window.DeviceMotionEvent) {
            window.addEventListener('devicemotion', (event) => {
                if (!isFortuneTelling && document.getElementById('app-fortune').classList.contains('active')) {
                    const acc = event.accelerationIncludingGravity;
                    if (acc && (Math.abs(acc.x) > 15 || Math.abs(acc.y) > 15)) { tellFortune(); }
                }
            });
        }

        // QUIZ MANTIĞI
        const quizData = [{q: "Hangi rengi seviyorum? 🎨", a: "Mavi", o: ["Kırmızı", "Siyah"]}, {q: "Hangi saatte sevgili olduk? ⏰", a: "21:35", o: ["20:00", "19:05"]}, {q: "Ben en çok neyi severim? ❤️", a: "Karım", o: ["Araba", "Para"]}, {q: "En sevdiğim yemek? 🍽️", a: "Döner", o: ["Pizza", "Hamburger"]}, {q: "En sevdiğim tatlı? 🍰", a: "Minik sumroslar", o: ["Baklava", "Sütlaç"]}, {q: "Okulda ki en yüksek notum? 💯", a: "100", o: ["85", "90"]}, {q: "En sevdiğim koku? 👃", a: "Boynun", o: ["Parfüm", "Çiçek"]}, {q: "En sevdiğim oyun? 🎮", a: "Minecraft", o: ["GTA V", "Valorant"]}, {q: "En korktuğum şey? 😱", a: "Karımm", o: ["Örümcek", "Yükseklik"]}, {q: "En sevdiğim manzara? 🌅", a: "Sen ve Deniz", o: ["Dağ Evi", "Orman"]}];
        let currentQuestion = 0; let score = 0;

        function shuffleArray(array) { for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [array[i], array[j]] = [array[j], array[i]]; } }
        function restartQuiz() { currentQuestion = 0; score = 0; document.getElementById('quiz-container').style.display = 'block'; document.getElementById('quiz-result').style.display = 'none'; loadQuestion(); }

        function loadQuestion() {
            if (currentQuestion >= quizData.length) { showQuizResult(); return; }
            const data = quizData[currentQuestion]; document.getElementById('quiz-question').innerText = data.q;
            let options = [data.a, ...data.o]; shuffleArray(options);
            const optionsContainer = document.getElementById('quiz-options'); optionsContainer.innerHTML = '';
            options.forEach(opt => { const btn = document.createElement('button'); btn.classList.add('quiz-btn'); btn.innerText = opt; btn.onclick = () => checkAnswer(btn, opt, data.a); optionsContainer.appendChild(btn); });
        }

        function checkAnswer(btn, selected, correct) {
            const btns = document.querySelectorAll('.quiz-btn'); btns.forEach(b => b.disabled = true);
            if (selected === correct) {
                btn.classList.add('correct'); score++;
                const modal = document.getElementById('app-quiz');
                for(let i=0; i<30; i++) { const c = document.createElement('div'); c.classList.add('confetti'); c.innerText = ['🎉', '✨', '👏'][Math.floor(Math.random() * 3)]; c.style.left = '50%'; c.style.top = '50%'; c.style.setProperty('--x', (Math.random() - 0.5) * 500 + 'px'); c.style.setProperty('--y', (Math.random() - 0.5) * 500 + 'px'); c.style.setProperty('--r', (Math.random() * 360) + 'deg'); modal.appendChild(c); setTimeout(() => c.remove(), 2000); }
            } else {
                btn.classList.add('wrong'); btns.forEach(b => { if (b.innerText === correct) b.classList.add('correct'); });
                if (navigator.vibrate) navigator.vibrate(200);
            }
            setTimeout(() => { currentQuestion++; loadQuestion(); }, 1500);
        }

        function showQuizResult() {
            document.getElementById('quiz-container').style.display = 'none'; document.getElementById('quiz-result').style.display = 'flex';
            const percentage = Math.round((score / quizData.length) * 100); document.getElementById('score-circle').innerText = `%${percentage}`;
            let title, msg;
            if (percentage === 100) { title = "MÜKEMMEL! 🏆"; msg = "Sen benim Ruh Eşimsin! Beni benden iyi tanıyorsun. ❤️"; }
            else if (percentage >= 80) { title = "HARİKA! 👏"; msg = "Çok iyi! Beni gerçekten seviyorsun ve önemsiyorsun."; }
            else if (percentage >= 50) { title = "İDARE EDER 🤔"; msg = "Fena değil ama biraz daha çalışman lazım aşkım."; }
            else { title = "EYVAH! 😱"; msg = "Bu akşam trip yemeye hazır ol! Nasıl bilemezsin?"; }
            document.getElementById('result-title').innerText = title; document.getElementById('result-msg').innerText = msg;
        }

        // LOVEFLIX & JETONLAR
        function playLoveflix() { alert("🍿 Sinema Modu Başlatılıyor...\n\nMısırları patlat, battaniyeyi kap ve kocanı bekle! 🎬"); }
        const tokenTypes = [{ icon: "🪙", title: "ALTIN JETON", desc: "Bu jetonla kocandan dilediğin bir şeyi isteyebilirsin!" }, { icon: "🍿", title: "SİNEMA JETONU", desc: "Sınırsız mısır ve film gecesi hakkı kazandın!" }, { icon: "💆‍♀️", title: "MASAJ JETONU", desc: "30 dakikalık omuz masajı kazandın!" }, { icon: "💋", title: "ÖPÜCÜK JETONU", desc: "Anında 10 adet öpücük tahsil edebilirsin!" }, { icon: "🍫", title: "ÇİKOLATA JETONU", desc: "Kocan sana en sevdiğin çikolatayı alacak!" }, { icon: "🃏", title: "JOKER JETON", desc: "Herhangi bir tartışmada haklı çıkma kartı!" }];
        let clickCounter = 0; let targetClicks = Math.floor(Math.random() * 6) + 1;

        function findHiddenToken(element) {
            clickCounter++;
            if(clickCounter >= targetClicks) {
                const randomToken = tokenTypes[Math.floor(Math.random() * tokenTypes.length)];
                document.getElementById('token-emoji').innerText = randomToken.icon; document.getElementById('token-title').innerText = randomToken.title; document.getElementById('token-desc').innerText = randomToken.desc;
                document.getElementById('hidden-token-overlay').style.display = 'flex';
                const modal = document.getElementById('app-loveflix');
                for(let i=0; i<60; i++) { const c = document.createElement('div'); c.classList.add('confetti'); c.innerText = ['🪙', '✨', '🎉', '❤️'][Math.floor(Math.random() * 4)]; c.style.left = '50%'; c.style.top = '50%'; c.style.fontSize = (Math.random() * 30 + 10) + 'px'; c.style.setProperty('--x', (Math.random() - 0.5) * 800 + 'px'); c.style.setProperty('--y', (Math.random() - 0.5) * 800 + 'px'); c.style.setProperty('--r', (Math.random() * 720) + 'deg'); modal.appendChild(c); setTimeout(() => c.remove(), 2500); }
                clickCounter = 0; targetClicks = Math.floor(Math.random() * 6) + 1;
            } else {
                element.style.transition = "transform 0.1s"; element.style.transform = "rotate(5deg) scale(0.95)"; setTimeout(() => { element.style.transform = "rotate(-5deg) scale(0.95)"; setTimeout(() => { element.style.transform = "rotate(0deg) scale(1)"; }, 100); }, 100);
            }
        }
        function closeTokenOverlay() { document.getElementById('hidden-token-overlay').style.display = 'none'; alert("Jeton Cüzdanına Eklendi! (Şaka şaka, ekran görüntüsü alıp kocana atabilirsin 😉)"); }

        // GÜNCELLENMİŞ KAZI KAZAN (HAFIZALI - TEKRAR YOK)
        const scratchPrizes = [
            {t: "👑 TEBRİKLER!", m: "Kocan sana 30 dk masaj yapacak!", i: "💆‍♀️"}, {t: "😈 HAHAHA!", m: "Bugün bulaşıklar tamamen sende!", i: "🧼"}, {t: "❤️ AŞK DOLU!", m: "Akşam yemeği kocandan!", i: "🍝"}, {t: "💸 AMORTİ", m: "Ödül yok ama bir öpücük kazandın.", i: "💋"}, {t: "☕ HİZMET ZAMANI", m: "Kocana bol köpüklü bir kahve yap.", i: "☕"}, {t: "🎬 SİNEMA", m: "Film seçme hakkı senin!", i: "🍿"}, {t: "📵 DETOKS", m: "1 Saat telefon yasak, sadece kocamla ilgilen!", i: "👀"}, {t: "🚗 ŞOFÖR", m: "Bugün özel şoförün benim. Nereye istersen!", i: "🏎️"}, {t: "😡 CEZA!", m: "Kumandayı kocana teslim et.", i: "📺"}, {t: "💅 GÜZELLİK", m: "Sana oje sürmemi ister misin?", i: "💅"}, {t: "🤷‍♂️ MAALESEF", m: "Boş yok ama ödül de yok. Sarılalım?", i: "🫂"}, {t: "🎤 KARAOKE", m: "Bana bir şarkı söylemek zorundasın!", i: "🎶"}, {t: "🏝️ HAYAL KUR", m: "Gözlerini kapat, tatile gidiyoruz (Hayalen).", i: "🏖️"}, {t: "📸 MODEL OL", m: "En güzel pozunu ver, fotoğrafını çekeceğim.", i: "📷"}, {t: "🍫 ÇİKOLATA", m: "Kocan sana en sevdiğin çikolatayı alacak.", i: "🍫"}
        ];

        const scratchCanvas = document.getElementById('scratch-canvas');
        const scratchCtx = scratchCanvas.getContext('2d');
        const scratchPrizeText = document.getElementById('scratch-prize-text');
        let isDrawing = false;
        let isRevealed = false;

        function initScratchCard() {
            let lastIndices = JSON.parse(localStorage.getItem('scratchHistory')) || [];
            let availablePrizes = [];
            scratchPrizes.forEach((prize, index) => { if (!lastIndices.includes(index)) availablePrizes.push({ ...prize, originalIndex: index }); });
            if (availablePrizes.length === 0) { const last = lastIndices[lastIndices.length-1]; lastIndices = [last]; availablePrizes = scratchPrizes.filter((p,i)=>i!==last).map((p,i)=>({...p, originalIndex:i})); }
            const selection = availablePrizes[Math.floor(Math.random() * availablePrizes.length)];
            lastIndices.push(selection.originalIndex); if (lastIndices.length > 5) lastIndices.shift();
            localStorage.setItem('scratchHistory', JSON.stringify(lastIndices));
            const randomPrize = selection;
            scratchPrizeText.innerHTML = `<div style="font-size:50px; margin-bottom:10px;">${randomPrize.i}</div><div style="font-size:22px; color:#d32f2f;">${randomPrize.t}</div><div style="font-size:16px; margin-top:5px; color:#555;">${randomPrize.m}</div>`;
            isRevealed = false;
            const wrapper = document.querySelector('.scratch-card-wrapper');
            scratchCanvas.width = wrapper.offsetWidth; scratchCanvas.height = wrapper.offsetHeight;
            const grd = scratchCtx.createLinearGradient(0, 0, scratchCanvas.width, scratchCanvas.height);
            grd.addColorStop(0, "#C0C0C0"); grd.addColorStop(0.5, "#E0E0E0"); grd.addColorStop(1, "#C0C0C0");
            scratchCtx.fillStyle = grd; scratchCtx.fillRect(0, 0, scratchCanvas.width, scratchCanvas.height);
            scratchCtx.fillStyle = "#999"; scratchCtx.font = "20px Arial"; scratchCtx.fillText("KAZIMAK İÇİN SÜRTE", 40, 90);
            scratchCtx.globalCompositeOperation = 'destination-out';
        }

        function resetScratchCard() {
            const wrapper = document.querySelector('.scratch-card-wrapper');
            wrapper.style.transform = "scale(0.9)";
            setTimeout(() => { initScratchCard(); wrapper.style.transform = "scale(1)"; }, 200);
        }

        function getMousePos(canvas, evt) { const rect = canvas.getBoundingClientRect(); return { x: (evt.clientX || evt.touches[0].clientX) - rect.left, y: (evt.clientY || evt.touches[0].clientY) - rect.top }; }
        function scratch(e) { if (!isDrawing || isRevealed) return; e.preventDefault(); const pos = getMousePos(scratchCanvas, e); scratchCtx.beginPath(); scratchCtx.arc(pos.x, pos.y, 25, 0, Math.PI * 2); scratchCtx.fill(); checkReveal(); }

        scratchCanvas.addEventListener('mousedown', (e) => { isDrawing = true; scratch(e); });
        scratchCanvas.addEventListener('touchstart', (e) => { isDrawing = true; scratch(e); });
        scratchCanvas.addEventListener('mousemove', scratch);
        scratchCanvas.addEventListener('touchmove', scratch);
        scratchCanvas.addEventListener('mouseup', () => { isDrawing = false; });
        scratchCanvas.addEventListener('touchend', () => { isDrawing = false; });

        function checkReveal() {
            const imageData = scratchCtx.getImageData(0, 0, scratchCanvas.width, scratchCanvas.height);
            let clearPixels = 0;
            for (let i = 3; i < imageData.data.length; i += 4) { if (imageData.data[i] === 0) clearPixels++; }
            if (clearPixels / (imageData.data.length / 4) > 0.4) {
                isRevealed = true; scratchCanvas.style.transition = "opacity 0.5s"; scratchCanvas.style.opacity = "0";
                const modal = document.getElementById('app-scratch');
                for(let i=0; i<50; i++) { const c = document.createElement('div'); c.classList.add('confetti'); c.innerText = ['🎉', '✨', '💰'][Math.floor(Math.random() * 3)]; c.style.left = '50%'; c.style.top = '50%'; c.style.setProperty('--x', (Math.random() - 0.5) * 500 + 'px'); c.style.setProperty('--y', (Math.random() - 0.5) * 500 + 'px'); c.style.setProperty('--r', (Math.random() * 360) + 'deg'); modal.appendChild(c); setTimeout(() => c.remove(), 2000); }
                setTimeout(() => { scratchCtx.clearRect(0, 0, scratchCanvas.width, scratchCanvas.height); scratchCanvas.style.opacity = "1"; }, 500);
            }
        }

        // --- YENİ PANIC BUTTON MANTIĞI (ANİMASYONLU) ---
        function activatePanicMode() {
            if(navigator.vibrate) navigator.vibrate([200, 100, 200]); 
            const stage1 = document.getElementById('panic-stage-1');
            stage1.classList.add('stage-fade-out');
            document.getElementById('app-panic').classList.add('panic-active');
            setTimeout(() => {
                stage1.style.display = 'none';
                stage1.classList.remove('stage-fade-out');
                const stage2 = document.getElementById('panic-stage-2');
                stage2.classList.add('stage-fade-in');
            }, 600);
        }

        function resetPanicMode() {
            const stage1 = document.getElementById('panic-stage-1');
            const stage2 = document.getElementById('panic-stage-2');
            stage1.style.display = 'flex';
            stage2.style.display = 'none';
            stage1.classList.remove('stage-fade-out');
            stage2.classList.remove('stage-fade-in');
            document.getElementById('app-panic').classList.remove('panic-active');
        }

        function sendPanicWhatsapp(reason) {
            const phone = "905315581447"; 
            const text = `🚨 *KIRMIZI KOD: ACİL DURUM!* 🚨\n\nMerkez, acil durum bildiriyorum:\n👉 *${reason}*\n\nKonumuma derhal intikal etmeni rica ediyorum! 📍\nDurum Kritik! ⏳`;
            window.location.href = `https://api.whatsapp.com/send?phone=${phone}&text=${encodeURIComponent(text)}`;
        }

        // --- ZENLOVE UYGULAMA MANTIĞI (YENİ) ---
        let breathInterval;
        
        function switchZenTab(tab) {
            document.querySelectorAll('.zen-tab').forEach(t => t.classList.remove('active'));
            document.getElementById('tab-' + tab).classList.add('active');
            
            if(tab === 'breath') {
                document.getElementById('zen-view-breath').style.display = 'flex';
                document.getElementById('zen-view-touch').style.display = 'none';
                startBreathingText();
            } else {
                document.getElementById('zen-view-breath').style.display = 'none';
                document.getElementById('zen-view-touch').style.display = 'flex';
                stopBreathingText();
            }
        }

        function startBreathingText() {
            const label = document.getElementById('breath-label');
            label.innerText = "NEFES AL"; 
            if(breathInterval) clearInterval(breathInterval);
            breathInterval = setInterval(() => {
                label.innerText = "NEFES AL";
                setTimeout(() => { label.innerText = "NEFES VER"; }, 4000);
            }, 8000);
            setTimeout(() => { label.innerText = "NEFES VER"; }, 4000);
        }

        function stopBreathingText() { if(breathInterval) clearInterval(breathInterval); }

        function startTouch() {
            const pad = document.getElementById('touch-pad');
            const msg = document.getElementById('touch-msg');
            pad.classList.add('active');
            msg.innerText = "Şu an yanındayım...";
            msg.style.color = "#ff2d55";
            if(navigator.vibrate) navigator.vibrate([100, 100, 100, 1000, 100, 100, 100, 1000, 100, 100, 100]);
        }

        function endTouch() {
            const pad = document.getElementById('touch-pad');
            const msg = document.getElementById('touch-msg');
            pad.classList.remove('active');
            msg.innerText = "Parmağını basılı tut ve\nkalp atışımı hisset...";
            msg.style.color = "#888";
            if(navigator.vibrate) navigator.vibrate(0);
        }

/* --- AURA 5.0: TAKI MODÜLÜ & AKILLI FİLTRELER --- */

const styleGen = {
    colors: [
        { n: "Siyah", hex: "#000000" }, { n: "Beyaz", hex: "#FFFFFF" },
        { n: "Ekru", hex: "#F5F5DC" }, { n: "Antrasit", hex: "#333333" },
        { n: "Lacivert", hex: "#000080" }, { n: "Vizon", hex: "#C8AD7F" },
        { n: "Haki", hex: "#4B5320" }, { n: "Bebek Mavisi", hex: "#89CFF0" },
        { n: "Pudra", hex: "#FFD1DC" }, { n: "Bordo", hex: "#800000" },
        { n: "Kiremit", hex: "#b94e48" }, { n: "Gümüş Gri", hex: "#C0C0C0" }
    ],
    fabrics: [
        { n: "Pamuklu", weight: "light" }, { n: "Keten", weight: "light" },
        { n: "Saten", weight: "medium" }, { n: "Triko", weight: "heavy" },
        { n: "Denim", weight: "medium" }, { n: "Deri", weight: "heavy" },
        { n: "Kaşmir", weight: "heavy" }, { n: "Şifon", weight: "light" }
    ],
    cuts: [
        "Oversize", "Slim Fit", "V Yaka", "Yüksek Bel", "Bol Kesim", 
        "Pileli", "Basic", "Dökümlü", "Kuşaklı", "Asimetrik"
    ],
    items: {
        tops: [
            { n: "Basic T-shirt", i: "👕", cat: "summer" },
            { n: "Gömlek", i: "👚", cat: "smart" },
            { n: "İpek Bluz", i: "👚", cat: "chic" },
            { n: "Askılı Top", i: "👚", cat: "summer" }, // Güneşli için
            { n: "Kazak", i: "🧶", cat: "winter" },
            { n: "Sweatshirt", i: "👕", cat: "sporty" },
            { n: "Blazer Ceket", i: "🧥", cat: "smart" },
            { n: "Hırka", i: "🧶", cat: "winter" },
            { n: "Crop Top", i: "👚", cat: "summer" },
            { n: "Trench Coat", i: "🧥", cat: "classic" }
        ],
        bottoms: [
            { n: "Mom Jean", i: "👖", cat: "casual" },
            { n: "Kumaş Pantolon", i: "👖", cat: "smart" },
            { n: "Deri Pantolon", i: "👖", cat: "chic" },
            { n: "Mini Etek", i: "👗", cat: "summer" },
            { n: "Midi Etek", i: "👗", cat: "classy" },
            { n: "Tayt", i: "🩳", cat: "sporty" },
            { n: "Şort", i: "🩳", cat: "summer" },
            { n: "Palazzo Pantolon", i: "👖", cat: "trend" },
            { n: "Jogger", i: "👖", cat: "comfy" }
        ],
        shoes: [
            { n: "Sneaker", i: "👟", cat: "casual" },
            { n: "Stiletto", i: "👠", cat: "chic" },
            { n: "Loafer", i: "👞", cat: "smart" },
            { n: "Bot", i: "👢", cat: "winter" },
            { n: "Sandalet", i: "👡", cat: "summer" },
            { n: "Converse", i: "👟", cat: "casual" },
            { n: "Çizme", i: "👢", cat: "winter" },
            { n: "Terlik", i: "👡", cat: "summer" }
        ],
        bags: [
            { n: "Omuz Çantası", i: "👜", cat: "daily" },
            { n: "Tote Bag", i: "👜", cat: "work" },
            { n: "Sırt Çantası", i: "🎒", cat: "sporty" },
            { n: "Clutch", i: "👛", cat: "party" },
            { n: "Mini Çanta", i: "👜", cat: "trend" },
            { n: "Hasır Çanta", i: "👜", cat: "summer" }
        ],
        // YENİ EKLENDİ: TAKILAR 💍
        jewelry: [
            { n: "Altın Halka Küpe", i: "✨", cat: "gold" },
            { n: "Gümüş Zincir Kolye", i: "⛓️", cat: "silver" },
            { n: "İnci Kolye", i: "📿", cat: "classy" },
            { n: "Güneş Gözlüğü", i: "🕶️", cat: "summer" },
            { n: "Minimal Bileklik", i: "💫", cat: "daily" },
            { n: "Şık Bir Saat", i: "⌚", cat: "smart" },
            { n: "Fular", i: "🧣", cat: "chic" },
            { n: "Halhal", i: "🦶", cat: "summer" }
        ]
    }
};

let auraState = { place: 'cafe', weather: 'sunny' };

function selectAuraFilter(el, type, value) {
    const container = el.parentElement;
    for (let chip of container.getElementsByClassName('chip')) { chip.classList.remove('active'); }
    el.classList.add('active');
    auraState[type] = value;
}

function startAuraAI(isRefresh = false) {
    const inputView = document.getElementById('aura-input-view');
    const loadingView = document.getElementById('aura-loading-view');
    const resultView = document.getElementById('aura-result-view');
    
    if(!isRefresh) inputView.style.display = 'none';
    resultView.style.display = 'none';
    loadingView.style.display = 'flex';

    // Gerçekçi işlem mesajları
    const messages = [
        "☀️ Hava durumu verileri işleniyor...",
        "👗 Kışlıklar eleniyor, yazlıklar seçiliyor...", // Dinamik mesaj
        "✨ Aksesuar çekmecesi karıştırılıyor...",
        "🎨 Renk uyumu kontrol ediliyor..."
    ];

    let step = 0;
    const statusText = document.getElementById('ai-status-text');
    
    const interval = setInterval(() => {
        if(step < messages.length) {
            statusText.innerText = messages[step];
            step++;
        } else {
            clearInterval(interval);
            generateDreamOutfit(); 
            loadingView.style.display = 'none';
            resultView.style.display = 'flex';
        }
    }, 400);
}

function generateDreamOutfit() {
    
    function createPiece(type, place, weather) {
        let possibleItems = [...styleGen.items[type]]; 

        // --- SIKI KURALLAR (ASLA HATA YAPMA) ---
        
        // 1. HAVA DURUMU KURALLARI
        if (weather === 'sunny') {
            // Güneşte Kazak, Hırka, Bot, Çizme, Kalın Triko, Kadife ASLA ÇIKMAZ
            possibleItems = possibleItems.filter(i => 
                i.cat !== 'winter' && // Kışlık kategorisini sil
                !i.n.includes("Kazak") &&
                !i.n.includes("Hırka") &&
                !i.n.includes("Bot") &&
                !i.n.includes("Çizme")
            );
        } else if (weather === 'cold' || weather === 'rainy') {
            // Soğukta Askılı, Şort, Terlik, Sandalet, Güneş Gözlüğü ASLA ÇIKMAZ
            possibleItems = possibleItems.filter(i => 
                i.cat !== 'summer' && 
                !i.n.includes("Askılı") &&
                !i.n.includes("Şort") &&
                !i.n.includes("Sandalet")
            );
        }

        // 2. MEKAN KURALLARI
        if (place === 'work') {
            possibleItems = possibleItems.filter(i => i.cat !== 'sporty' && i.cat !== 'summer' && !i.n.includes("Crop"));
        }
        if (place === 'party') {
            possibleItems = possibleItems.filter(i => i.cat !== 'sporty' && i.cat !== 'comfy');
        }

        // Hata Önleyici: Liste boşalırsa en güvenli parçayı koy
        if(possibleItems.length === 0) {
            if(type==='tops') possibleItems = [{n:"Beyaz T-shirt", i:"👕"}];
            else if(type==='bottoms') possibleItems = [{n:"Jean", i:"👖"}];
            else if(type==='shoes') possibleItems = [{n:"Sneaker", i:"👟"}];
            else if(type==='bags') possibleItems = [{n:"Çanta", i:"👜"}];
            else possibleItems = [{n:"Küpe", i:"✨"}];
        }

        const selectedItem = possibleItems[Math.floor(Math.random() * possibleItems.length)];
        const selectedColor = styleGen.colors[Math.floor(Math.random() * styleGen.colors.length)];
        
        // --- İSİM OLUŞTURMA (Mantıksız Kumaşları Engelle) ---
        let finalName = "";
        
        if (type === 'jewelry') {
            // Takılar için renk eklemeye gerek yok (Zaten Altın/Gümüş belli)
            finalName = selectedItem.n;
        } else {
            // Kıyafetler için
            let fabricPrefix = "";
            // Sadece %50 ihtimalle kumaş ekle, ama mantıklı olsun
            if(Math.random() > 0.5) {
                let validFabrics = styleGen.fabrics;
                
                // Güneşliyse kalınları çıkar
                if(weather === 'sunny') validFabrics = validFabrics.filter(f => f.weight !== 'heavy');
                // Soğuksa inceleri çıkar
                if(weather === 'cold') validFabrics = validFabrics.filter(f => f.weight !== 'light');

                // Parça bazlı yasaklar
                if(selectedItem.n.includes("Jean")) validFabrics = []; // Jean zaten kumaştır
                if(selectedItem.n.includes("Deri")) validFabrics = []; // Deri zaten kumaştır
                if(selectedItem.n.includes("T-shirt")) validFabrics = validFabrics.filter(f => f.n === 'Pamuklu');
                if(selectedItem.n.includes("Kazak")) validFabrics = validFabrics.filter(f => f.n === 'Triko' || f.n === 'Kaşmir');

                if(validFabrics.length > 0) {
                    const fab = validFabrics[Math.floor(Math.random() * validFabrics.length)];
                    fabricPrefix = fab.n + " ";
                }
            }
            finalName = `${selectedColor.n} ${fabricPrefix}${selectedItem.n}`;
        }

        return {
            name: finalName,
            icon: selectedItem.i,
            colorHex: selectedColor.hex || "#FFD700"
        };
    }

    // Parçaları Üret
    const top = createPiece('tops', auraState.place, auraState.weather);
    const bottom = createPiece('bottoms', auraState.place, auraState.weather);
    const shoes = createPiece('shoes', auraState.place, auraState.weather);
    const bag = createPiece('bags', auraState.place, auraState.weather);
    const jewelry = createPiece('jewelry', auraState.place, auraState.weather); // YENİ

    // DOM'a Yaz
    document.getElementById('res-top').innerHTML = `<div class="item-icon">${top.icon}</div><div class="item-name">${top.name}</div>`;
    document.getElementById('res-bottom').innerHTML = `<div class="item-icon">${bottom.icon}</div><div class="item-name">${bottom.name}</div>`;
    document.getElementById('res-shoes').innerHTML = `<div class="item-icon">${shoes.icon}</div><div class="item-name">${shoes.name}</div>`;
    document.getElementById('res-bag').innerHTML = `<div class="item-icon">${bag.icon}</div><div class="item-name">${bag.name}</div>`;
    document.getElementById('res-jewelry').innerHTML = `<div class="item-icon">${jewelry.icon}</div><div class="item-name">${jewelry.name}</div>`; // YENİ

    // Renk Paleti
    const paletteDiv = document.getElementById('res-palette');
    paletteDiv.innerHTML = '';
    const outfitColors = [top.colorHex, bottom.colorHex, shoes.colorHex, bag.colorHex];
    outfitColors.forEach(c => {
        const d = document.createElement('div');
        d.className = 'color-swatch';
        d.style.background = c;
        paletteDiv.appendChild(d);
    });

    const notes = [
        `Harika bir seçim! ${jewelry.name} bu kombine çok modern bir hava katmış.`,
        `Güneşli havanın tadını çıkar! ${top.name} seni hem serin tutacak hem de şık gösterecek.`,
        `Tamamlayıcı parça olarak ${jewelry.name} seçimi mükemmel. Kocan detaylara bayılacak!`,
        `Sadelik ve zarafet bir arada. ${shoes.name} ile gün boyu rahat edeceksin.`,
        `Bu renkler senin aurana çok yakışıyor. Tam bir 'Clean Girl' kombini!`
    ];
    document.getElementById('res-note').innerText = notes[Math.floor(Math.random() * notes.length)];

    window.currentOutfitText = `👗 *AURA GÜNLÜK KOMBİN* 👗\n\n👒 ${top.name}\n👖 ${bottom.name}\n👠 ${shoes.name}\n👜 ${bag.name}\n✨ ${jewelry.name}`;
}

// Yardımcı Fonksiyonlar (Aynen kalıyor)
function translateTag(tag) {
    const dict = { 'cafe': 'Kafe', 'date': 'Date', 'work': 'Ofis', 'party': 'Parti', 'home': 'Ev', 'sunny': 'Güneşli', 'cloudy': 'Serin', 'rainy': 'Yağmurlu', 'cold': 'Soğuk' };
    return dict[tag] || tag;
}
function shareOutfit() { if(window.currentOutfitText) window.location.href = `https://api.whatsapp.com/send?phone=905315581447&text=${encodeURIComponent(window.currentOutfitText)}`; }

const originalCloseAura = window.closeApp;
window.closeApp = function(id) {
    document.getElementById('app-'+id).classList.remove('active');
    if(id === 'aura') { setTimeout(() => { document.getElementById('aura-input-view').style.display = 'flex'; document.getElementById('aura-result-view').style.display = 'none'; document.getElementById('aura-loading-view').style.display = 'none'; }, 500); }
    if(id==='heart') stopRain(); 
    if(id==='zen') stopBreathingText();
}

        /* --- AŞK BORSASI MANTIĞI & GÜNCELLENMİŞ APP AÇICI --- */
        let stockTicker;

        function initStockApp() {
            setTimeout(() => {
                const canvas = document.getElementById('love-chart');
                const container = document.querySelector('.chart-area');
                if(container && canvas) {
                    canvas.width = container.offsetWidth;
                    canvas.height = container.offsetHeight;
                    drawStockChart();
                }
            }, 300); // Animasyon bitince çiz

            // Canlı borsa simülasyonunu başlat
            if(stockTicker) clearInterval(stockTicker);
            stockTicker = setInterval(simulateMarket, 2500);
        }

        function drawStockChart() {
            const c = document.getElementById('love-chart');
            if(!c) return;
            const ctx = c.getContext('2d');
            const w = c.width;
            const h = c.height;

            // Temizle
            ctx.clearRect(0, 0, w, h);

            // Veri Noktaları (Sürekli yükselen trend)
            const points = [];
            let y = h - 20;
            const step = w / 10;
            
            ctx.beginPath();
            ctx.moveTo(0, h); // Sol alt başlangıç
            
            // Rastgele ama yukarı yönlü noktalar oluştur
            for(let x = 0; x <= w + 10; x += step) {
                const randomY = h - (Math.random() * h * 0.5) - (x / w * h * 0.4); 
                points.push({x: x, y: randomY});
                ctx.lineTo(x, randomY);
            }

            // Çizgi Stili
            ctx.strokeStyle = '#34C759';
            ctx.lineWidth = 3;
            ctx.stroke();

            // Altını Doldur (Gradient)
            ctx.lineTo(w, h);
            ctx.lineTo(0, h);
            const grad = ctx.createLinearGradient(0, 0, 0, h);
            grad.addColorStop(0, 'rgba(52, 199, 89, 0.4)');
            grad.addColorStop(1, 'rgba(52, 199, 89, 0.0)');
            ctx.fillStyle = grad;
            ctx.fill();
        }

        function simulateMarket() {
            // SMR ve KOC hisselerini yükselt
            const smrEl = document.getElementById('price-smr');
            const kocEl = document.getElementById('price-koc');
            const trpEl = document.getElementById('price-trp');

            if(smrEl) {
                let current = parseFloat(smrEl.innerText);
                let change = (Math.random() - 0.2) * 5; // Genelde artar
                smrEl.innerText = (current + change).toFixed(1) + 'K';
            }
            
            if(kocEl) {
                let current = parseFloat(kocEl.innerText);
                let change = (Math.random() - 0.2) * 4;
                kocEl.innerText = (current + change).toFixed(1) + 'K';
            }

            // Trip hissesi hep dipte
            if(trpEl) {
                let val = Math.random() * 0.05;
                trpEl.innerText = val.toFixed(2);
            }
        }

        // --- GÜNCELLENMİŞ ANA FONKSİYON (Eskisini ezer) ---
        // Bu fonksiyon Stock dahil tüm uygulamaları düzgün açar
        window.openApp = function(id) {
            document.getElementById('app-'+id).classList.add('active');
            
            if(id==='stock') initStockApp(); // YENİ: Borsa Başlatıcı
            
            if(id==='messages') loadMessages();
            if(id==='mail') loadEmails();
            if(id==='phone') loadCalls();
            if(id==='heart') resetHeartApp();
            if(id==='quiz') restartQuiz();
            if(id==='scratch') initScratchCard();
            if(id==='panic') resetPanicMode();
            if(id==='zen') switchZenTab('breath');
        };


                        /* --- LUNA V7 JS (REAL CALENDAR + FIX) --- */
        let lunaData = JSON.parse(localStorage.getItem('luna_data')) || { startDate: null, periodLength: 5 };
        let currentCalDate = new Date(); 

        const monthNames = ["Ocak", "Şubat", "Mart", "Nisan", "Mayıs", "Haziran", "Temmuz", "Ağustos", "Eylül", "Ekim", "Kasım", "Aralık"];
        const phases = {
            period: { t: "Regl Dönemi", d: "Dinlenme zamanı prensesim. 🩸", color: "#ffffff", msg: "Aşkım Kırmızı Kod! 🚨" },
            follicular: { t: "Yükseliş", d: "Enerjin harika, parlıyorsun! ✨", color: "#ffc3a0", msg: "Enerjim tavan! 💃" },
            ovulation: { t: "Yumurtlama", d: "En çekici olduğun günler! 🔥", color: "#a18cd1", msg: "Göz kamaştırıyorum! 😎" },
            luteal: { t: "PMS", d: "Biraz sakinlik iyi gelebilir. 🧘‍♀️", color: "#7b7b8a", msg: "PMS dönemindeyim... 🥺" }
        };

        function initLuna() {
            lunaData = JSON.parse(localStorage.getItem('luna_data')) || { startDate: null, periodLength: 5 };
            updateLunaUI();
            renderCalendar();
        }

        // --- GERÇEK TAKVİME EKLEME ---
        function addToRealCalendar(title, startISO) {
            const s = new Date(startISO);
            const e = new Date(s.getTime() + (60*60*1000));
            const formatDate = (date) => date.toISOString().replace(/-|:|\.\d\d\d/g,"");
            const icsContent = 
`BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
SUMMARY:${title} ❤️
DTSTART:${formatDate(s)}
DTEND:${formatDate(e)}
DESCRIPTION:Sumru'nun özel takvimi. İlgi gösterilmesi gereken günler!
END:VEVENT
END:VCALENDAR`;
            const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.setAttribute('download', 'regl_baslangic.ics');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function setCycleStart() {
            if(confirm("Regl başlangıcını BUGÜN olarak işaretleyelim mi?")) {
                const now = new Date();
                lunaData.startDate = now.toISOString();
                lunaData.periodLength = 5;
                localStorage.setItem('luna_data', JSON.stringify(lunaData));
                
                createHeartExplosion();
                initLuna();

                if(confirm("Bunu telefonundaki takvime de eklemek ister misin?")) {
                    addToRealCalendar("Sumru Regl Başlangıç", lunaData.startDate);
                }
            }
        }

        function setCycleEnd() {
            if(!lunaData.startDate) return alert("Önce döngü başlamalı.");
            const start = new Date(lunaData.startDate);
            const today = new Date();
            start.setHours(0,0,0,0); today.setHours(0,0,0,0);
            
            const diffDays = Math.floor((today - start) / (1000 * 60 * 60 * 24)) + 1;
            
            if(diffDays > 35 || diffDays < 1) {
                alert("Tarih hatası.");
            } else {
                lunaData.periodLength = diffDays; 
                localStorage.setItem('luna_data', JSON.stringify(lunaData));
                alert(`Regl ${diffDays} gün sürdü. Takvime işlendi! ✨`);
                initLuna();
            }
        }

        function resetLunaData() {
            if(confirm("Verileri SIFIRLAMAK istiyor musun?")) {
                localStorage.removeItem('luna_data');
                lunaData = { startDate: null, periodLength: 5 };
                initLuna();
            }
        }

        function updateLunaUI() {
            const dayDisplay = document.getElementById('cycle-day-num');
            const phaseTitle = document.getElementById('phase-name');
            const phaseDesc = document.getElementById('phase-desc');
            const statusText = document.getElementById('luna-status-text');
            const moonShadow = document.getElementById('moon-shadow-mask');
            
            if(!lunaData.startDate) {
                dayDisplay.innerText = "--"; statusText.innerText = "VERİ BEKLENİYOR";
                moonShadow.style.transform = "translateX(0)"; 
                phaseTitle.innerText = "Hoş Geldin"; phaseDesc.innerText = "Takip için 'Başladı'ya bas.";
                return;
            }

            const start = new Date(lunaData.startDate);
            const today = new Date();
            start.setHours(0,0,0,0); today.setHours(0,0,0,0);
            
            const diffDays = Math.floor((today - start) / (1000 * 60 * 60 * 24)) + 1;
            dayDisplay.innerText = diffDays;
            statusText.innerText = `DÖNGÜNÜN ${diffDays}. GÜNÜ`;

            let pk = 'luteal';
            if(diffDays <= lunaData.periodLength) pk = 'period';
            else if(diffDays <= 11) pk = 'follicular';
            else if(diffDays <= 16) pk = 'ovulation';
            
            const p = phases[pk];
            phaseTitle.innerText = p.t; phaseDesc.innerText = p.d; 
            phaseTitle.style.color = p.color; window.lunaMsg = p.msg;

            let cyclePos = diffDays % 30;
            let percent;
            if(cyclePos <= 15) {
                percent = (cyclePos / 15) * 200; 
                moonShadow.style.transform = `translateX(${percent}%)`;
                moonShadow.style.opacity = (cyclePos >= 13 && cyclePos <= 16) ? 0 : 0.85;
            } else {
                let waning = cyclePos - 15;
                percent = 200 - ((waning / 15) * 200);
                moonShadow.style.transform = `translateX(${percent}%)`;
                moonShadow.style.opacity = 0.85;
            }
        }

        function changeLunaMonth(d) { currentCalDate.setMonth(currentCalDate.getMonth() + d); renderCalendar(); }

        function renderCalendar() {
            const cal = document.getElementById('luna-calendar');
            const header = document.getElementById('cal-month-year');
            cal.innerHTML = '';
            
            const y = currentCalDate.getFullYear(); const m = currentCalDate.getMonth();
            header.innerText = `${monthNames[m]} ${y}`;
            let fDay = new Date(y, m, 1).getDay(); fDay = fDay===0?6:fDay-1;
            const dim = new Date(y, m + 1, 0).getDate();

            for(let i=0; i<fDay; i++) cal.appendChild(document.createElement('div'));
            
            for(let i=1; i<=dim; i++) {
                const el = document.createElement('div'); el.className = 'cal-day'; el.innerText = i;
                const t = new Date();
                if(i===t.getDate() && m===t.getMonth() && y===t.getFullYear()) el.classList.add('today');

                if(lunaData.startDate) {
                    const s = new Date(lunaData.startDate); const c = new Date(y, m, i);
                    s.setHours(0,0,0,0); c.setHours(0,0,0,0);
                    const diff = Math.floor((c - s) / (1000 * 60 * 60 * 24)) + 1;

                    if(diff === 1) el.classList.add('start-marker');
                    else if(diff > 1 && diff < lunaData.periodLength) el.classList.add('in-period');
                    else if(diff === lunaData.periodLength) el.classList.add('end-marker');
                    
                    if(diff >= 12 && diff <= 16) el.classList.add('in-ovulation');
                }
                cal.appendChild(el);
            }
        }

        function notifyHusbandStatus() { if(window.lunaMsg) location.href=`https://api.whatsapp.com/send?phone=905315581447&text=${encodeURIComponent(window.lunaMsg)}`; else alert("Veri yok."); }
        
        function createHeartExplosion() {
            const m = document.getElementById('app-luna');
            for(let i=0; i<60; i++) {
                const c = document.createElement('div'); c.className='confetti'; c.innerText=['❤️','🩸','✨'][Math.floor(Math.random()*3)];
                c.style.left='50%'; c.style.top='40%'; c.style.fontSize=(Math.random()*20+15)+'px';
                c.style.setProperty('--x',(Math.random()-0.5)*500+'px'); c.style.setProperty('--y',(Math.random()-0.5)*500+'px'); c.style.setProperty('--r',(Math.random()*360)+'deg');
                m.appendChild(c); setTimeout(()=>c.remove(),2000);
            }
        }

    /* =================================================================
       APP: LOVE LAB (AŞK LABORATUVARI) - 125 KOMBİNASYONLU DEV SCRIPT
       ================================================================= */
    
    // Değişkenler
    let cauldronIngredients = [];
    const maxIngredients = 3;
    let lastResultText = ""; 

    const ingredientData = {
        'love': { color: '#ff4b5c', icon: '❤️' }, 
        'passion': { color: '#ff9f43', icon: '🔥' },
        'attention': { color: '#feca57', icon: '✨' }, 
        'sweet': { color: '#d57eeb', icon: '🍫' }, 
        'trip': { color: '#54a0ff', icon: '💧' }
    };

    // --- 125 FARKLI SENARYO (SIRA ÖNEMLİ) ---
    const potionRecipes = {
        // --- ❤️ SEVGİ (LOVE) BAŞLANGIÇLARI ---
        'love-love-love': { t: "Aşk Sarhoşluğu", d: "Gözü senden başkasını görmüyor. Dünyası sensin!", i: "😍", fx: "heart" },
        'love-love-passion': { t: "Romantik Akşam", d: "Mum ışığı, güzel sözler ve ateşli bakışlar.", i: "🕯️", fx: "heart" },
        'love-love-attention': { t: "Kucak Kedisi", d: "Sürekli gelip sana sarılmak isteyecek. Temas bağımlısı!", i: "🐱", fx: "heart" },
        'love-love-sweet': { t: "Pamuk Şeker", d: "Dünyanın en tatlı kocası modu aktif.", i: "🍬", fx: "sparkle" },
        'love-love-trip': { t: "Şımarık Aşık", d: "Seni o kadar çok seviyor ki, nazın bile ona bal gibi geliyor.", i: "😽", fx: "heart" },
        
        'love-passion-love': { t: "Tutku Sandviçi", d: "Aşkla başlayıp aşkla biten, ortası alev alev bir gün.", i: "🥪", fx: "fire" },
        'love-passion-passion': { t: "Ateşli Aşk", d: "Seni her gördüğünde kalbi hızlanacak.", i: "💓", fx: "fire" },
        'love-passion-attention': { t: "Göz Hapsi", d: "Seni izlemekten kendini alamıyor. Kaçış yok!", i: "👀", fx: "fire" },
        'love-passion-sweet': { t: "İdeal Randevu", d: "Romantik başla, tutkulu devam et, tatlı bitir. Kusursuz.", i: "🍷", fx: "heart" },
        'love-passion-trip': { t: "Tehlikeli Cazibe", d: "Seni hem çok arzuluyor hem de biraz çekiniyor.", i: "🐆", fx: "fire" },

        'love-attention-love': { t: "Pervane", d: "Etrafında dönüp duruyor. 'Bir isteğin var mı aşkım?'", i: "🚁", fx: "sparkle" },
        'love-attention-passion': { t: "Hayranlık", d: "Sana bakıp 'Ben bu kadını nasıl tavladım?' diyor.", i: "🤩", fx: "heart" },
        'love-attention-sweet': { t: "Hediye Canavarı", d: "Eve gelirken elinde sevdiğin bir şeyle gelme ihtimali %100.", i: "🎁", fx: "sparkle" },
        'love-attention-trip': { t: "Panik Atak", d: "İlgilendi ama yetmedi mi? Şimdi telafi çabasında.", i: "🏃‍♂️", fx: "rain" },

        'love-sweet-love': { t: "Anaç Şefkat", d: "Başını dizine koyup uyumak istiyor. Çok huzurlu.", i: "🐣", fx: "heart" },
        'love-sweet-passion': { t: "Masum Tehlike", d: "Aşkla kandırıp tatlılıkla yaklaştın, sonra yaktın!", i: "🧨", fx: "fire" },
        'love-sweet-attention': { t: "Prenses Modu", d: "Seni el üstünde tutacak. Ayaklarına masaj yapabilir.", i: "👸", fx: "sparkle" },
        'love-sweet-trip': { t: "Duygusal Dalgalanma", d: "Önce sevdi, sonra güldürdü, en son ağlattı mı? Koca kafası karışık.", i: "🌊", fx: "rain" },

        'love-trip-love': { t: "Barışma Garantisi", d: "Kavga etseniz bile sonu yatakta biter.", i: "🏳️", fx: "heart" },
        'love-trip-passion': { t: "Hırçın Sevgi", d: "Kızgınlığın bile ona çekici geliyor.", i: "😼", fx: "fire" },
        'love-trip-attention': { t: "Suçluluk", d: "Seni üzdüğünü sandı, şimdi affettirmek için kul köle.", i: "🥺", fx: "rain" },
        'love-trip-sweet': { t: "Gönül Alma", d: "Trip attın ama o kadar tatlısın ki dayanamadı.", i: "💐", fx: "sparkle" },
        'love-trip-trip': { t: "Duygusal Hız Treni", d: "Önce sevdin, sonra iki kere üzdün. Kocan pert!", i: "🎢", fx: "rain" },

        // --- 🔥 TUTKU (PASSION) BAŞLANGIÇLARI ---
        'passion-passion-passion': { t: "Volkanik Patlama", d: "Ortalık yanıyor! İtfaiyeyi aramaya gerek yok, sadece tadını çıkar.", i: "🚒", fx: "fire" },
        'passion-passion-love': { t: "Derin Bağ", d: "Sadece tensel değil, ruhsal bir çekim de var.", i: "🔗", fx: "heart" },
        'passion-passion-attention': { t: "Sahne Işığı", d: "Gözlerini senden alamıyor. Bugün ekstra seksisin.", i: "😎", fx: "fire" },
        'passion-passion-sweet': { t: "Çikolatalı Çilek", d: "Hem ateşli hem tatlı. Dayanılmaz kombinasyon.", i: "🍓", fx: "fire" },
        'passion-passion-trip': { t: "Kaos Teorisi", d: "Gerginlik cinsel çekimi artırıyor. Barışma seksine hazır ol.", i: "💥", fx: "fire" },

        'passion-love-passion': { t: "Bitmeyen Gece", d: "Bu gece uyku yok. Enerjini topla!", i: "🌙", fx: "fire" },
        'passion-love-attention': { t: "Romantik Jön", d: "Sana film yıldızıymışsın gibi davranacak.", i: "🎬", fx: "sparkle" },
        'passion-love-sweet': { t: "Balayı Modu", d: "Yeni evliler gibi. Sürekli el ele, göz göze.", i: "🏝️", fx: "heart" },
        'passion-love-trip': { t: "Zor Aşk", d: "Ulaşılmazı oynuyorsun, bu onu çıldırtıyor.", i: "👠", fx: "fire" },

        'passion-attention-passion': { t: "Star Sensin", d: "Seni hayranlıkla izliyor. Bugün ne dersen o.", i: "🌟", fx: "fire" },
        'passion-attention-love': { t: "İdeal Koca", d: "Hem arzuluyor, hem ilgileniyor, hem seviyor.", i: "✅", fx: "heart" },
        'passion-attention-sweet': { t: "Flörtöz", d: "Sanki seni ilk kez tavlamaya çalışıyor gibi.", i: "😉", fx: "sparkle" },
        'passion-attention-trip': { t: "Kıskançlık Krizi", d: "İlgiyi başkasına verirsen olay çıkar. Sadece ona bak!", i: "😠", fx: "fire" },

        'passion-sweet-passion': { t: "Şekerli Ateş", d: "Tatlı dille yılanı deliğinden, kocayı evden çıkarır.", i: "🐍", fx: "fire" },
        'passion-sweet-love': { t: "Yumuşak Güç", d: "Onu parmağında oynatıyorsun ve bu hoşuna gidiyor.", i: "☝️", fx: "sparkle" },
        'passion-sweet-attention': { t: "Centilmen", d: "Kapını açacak, sandalyeni çekecek. Şık hareketler.", i: "🎩", fx: "sparkle" },
        'passion-sweet-trip': { t: "Tuzlu Karamel", d: "Önce tatlı, sonra hafif bir atarlanma. Kafası karıştı.", i: "🥨", fx: "rain" },

        'passion-trip-passion': { t: "Fırtına Öncesi", d: "Sessizlik var ama büyük bir patlama geliyor.", i: "🌪️", fx: "fire" },
        'passion-trip-love': { t: "Tutkulu Barışma", d: "Tartışma bitti, şimdi sevme zamanı.", i: "🫂", fx: "heart" },
        'passion-trip-attention': { t: "Sorgu Odası", d: "'Neden yüzüme bakmıyorsun?' diye darlayabilir.", i: "🤔", fx: "rain" },
        'passion-trip-sweet': { t: "Bipolar Ayıcık", d: "Bir kükrüyor bir sarılıyor. İdare et artık.", i: "🐻", fx: "rain" },
        'passion-trip-trip': { t: "Soğuk Savaş", d: "Evde buz gibi rüzgarlar esiyor ama gözü hala sende.", i: "❄️", fx: "rain" },

        // --- ✨ İLGİ (ATTENTION) BAŞLANGIÇLARI ---
        'attention-attention-attention': { t: "Evrenin Kraliçesi", d: "Bütün dünya senin etrafında dönüyor. Keyfini sür!", i: "👑", fx: "sparkle" },
        'attention-attention-love': { t: "Sevgi Pıtırcığı", d: "Sürekli 'Seni Seviyorum' mesajları atacak.", i: "💬", fx: "heart" },
        'attention-attention-passion': { t: "Göz Hapsi", d: "Tuvalete gitse bile seni düşünüyor.", i: "💭", fx: "fire" },
        'attention-attention-sweet': { t: "Hizmetkar", d: "Çayını, kahveni getirecek. Bugün senin günün.", i: "☕", fx: "sparkle" },
        'attention-attention-trip': { t: "Aşırı Doz", d: "Çok ilgi gösterdi şımardın mı? Biraz nazlanıyorsun.", i: "💅", fx: "rain" },

        'attention-love-attention': { t: "İlgi Manyağı", d: "Sürekli ilgi bekliyorsun ve o da veriyor. Mutlu son.", i: "🥰", fx: "heart" },
        'attention-love-passion': { t: "Romantik Sürpriz", d: "Beklemediğin bir anda seni şaşırtacak.", i: "🎉", fx: "heart" },
        'attention-love-sweet': { t: "Huzurlu Yuva", d: "Evde battaniye, film ve kucaklaşma.", i: "🏠", fx: "heart" },
        'attention-love-trip': { t: "Sebepsiz Trip", d: "Her şey mükemmelken arıza çıkardın. Bravo.", i: "🤷‍♂️", fx: "rain" },

        'attention-passion-attention': { t: "Spot Işıkları", d: "Bugün çok güzelsin ve o bunun farkında.", i: "💃", fx: "fire" },
        'attention-passion-love': { t: "Hayatının Aşkı", d: "Sana bakıp şükrediyor. Değerini bil.", i: "🙏", fx: "heart" },
        'attention-passion-sweet': { t: "Çapkın Bakışlar", d: "Kalabalıkta sana göz kırpacak.", i: "😉", fx: "fire" },
        'attention-passion-trip': { t: "Kıskançlık", d: "İlgiyi başkasına verirsen olay çıkar.", i: "😒", fx: "fire" },

        'attention-sweet-attention': { t: "Prenses", d: "Elini sıcak sudan soğuk suya sokmayacak.", i: "✨", fx: "sparkle" },
        'attention-sweet-love': { t: "Şefkat", d: "Saçlarını tarayabilir veya oje sürebilir.", i: "💅", fx: "heart" },
        'attention-sweet-passion': { t: "Tatlı Kaçamak", d: "Senin için işten erken gelebilir.", i: "🏃", fx: "fire" },
        'attention-sweet-trip': { t: "Nazlı Bebek", d: "İlgi istiyorsun ama belli etmiyorsun.", i: "👶", fx: "rain" },

        'attention-trip-attention': { t: "Kısır Döngü", d: "İlgi gösteriyor, trip atıyorsun, yine ilgi gösteriyor. Yorulmadı mı?", i: "🔄", fx: "rain" },
        'attention-trip-love': { t: "Affediş", d: "Hatasını anladı, gönlünü almaya çalışıyor.", i: "🎁", fx: "heart" },
        'attention-trip-passion': { t: "Gergin Bekleyiş", d: "Sessizce sakinleşmeni bekliyor.", i: "⏳", fx: "fire" },
        'attention-trip-sweet': { t: "Yavru Köpek", d: "Sana masum masum bakarak kızgınlığını geçirmeye çalışıyor.", i: "🐶", fx: "sparkle" },
        'attention-trip-trip': { t: "Sessiz Gemi", d: "Kocan şu an neyi yanlış yaptığını düşünüyor. Derin sessizlik.", i: "😶", fx: "rain" },

        // --- 🍫 TATLI (SWEET) BAŞLANGIÇLARI ---
        'sweet-sweet-sweet': { t: "Diyabet Uyarısı", d: "Aşırı dozda tatlılık! Miden bulanabilir.", i: "🍩", fx: "sparkle" },
        'sweet-sweet-love': { t: "Pamuk Şeker", d: "Çok yumuşak, çok tatlı ve huzurlu bir mod.", i: "☁️", fx: "heart" },
        'sweet-sweet-passion': { t: "Afrodizyak", d: "Tatlı yiyelim tatlı... devamını sen anladın.", i: "💋", fx: "fire" },
        'sweet-sweet-attention': { t: "Bonkör", d: "Sana en sevdiğin tatlıyı alacak.", i: "🍰", fx: "sparkle" },
        'sweet-sweet-trip': { t: "Gizli Şeker", d: "Yüzüne gülüyor ama içten içe bir şeye bozulmuş.", i: "🍋", fx: "rain" },

        'sweet-love-sweet': { t: "Mutluluk", d: "Sadece gülümseme ve neşe dolu bir an.", i: "😊", fx: "heart" },
        'sweet-love-passion': { t: "Sıcak Çikolata", d: "İçini ısıtan bir sevgi ve tutku.", i: "☕", fx: "heart" },
        'sweet-love-attention': { t: "İyi Hissettiren", d: "Sana kendini çok özel hissettirecek.", i: "🌈", fx: "sparkle" },
        'sweet-love-trip': { t: "Alınganlık", d: "Şaka yaptı ama sen ciddiye aldın. Ortam gerildi.", i: "😐", fx: "rain" },

        'sweet-passion-sweet': { t: "Öpücük", d: "Dudağından öpücük eksik olmayacak.", i: "😘", fx: "fire" },
        'sweet-passion-love': { t: "Genç Aşıklar", d: "Parkta el ele yürüyen liseliler gibisiniz.", i: "👫", fx: "heart" },
        'sweet-passion-attention': { t: "Göz Bebeği", d: "Sana bakarken gözleri parlıyor.", i: "✨", fx: "fire" },
        'sweet-passion-trip': { t: "Kıskanç Tatlılık", d: "Seni kıskanıyor ama bunu şakaya vuruyor.", i: "😏", fx: "fire" },

        'sweet-attention-sweet': { t: "Şımarık", d: "Ne istesen 'Tamam hayatım' diyor.", i: "🆗", fx: "sparkle" },
        'sweet-attention-love': { t: "Huzur", d: "Kavgasız, gürültüsüz, mis gibi bir gün.", i: "🍃", fx: "heart" },
        'sweet-attention-passion': { t: "Sürpriz", d: "Seni yemeğe çıkarabilir.", i: "🍽️", fx: "fire" },
        'sweet-attention-trip': { t: "Yanlış Anlama", d: "İyi niyetle bir şey yaptı ama sen ters anladın.", i: "🤦‍♂️", fx: "rain" },

        'sweet-trip-sweet': { t: "Barış Çubuğu", d: "Küs kalamıyorsunuz. Hemen barışıldı.", i: "🤝", fx: "sparkle" },
        'sweet-trip-love': { t: "Duygusal", d: "Gözlerin doldu, o da dayanamadı sarıldı.", i: "😢", fx: "heart" },
        'sweet-trip-passion': { t: "İnatçı", d: "Hem inatlaşıyorsunuz hem de birbirinizi istiyorsunuz.", i: "🐂", fx: "fire" },
        'sweet-trip-attention': { t: "Çaba", d: "Gönlünü almak için şebeklik yapıyor.", i: "🤪", fx: "sparkle" },
        'sweet-trip-trip': { t: "Pasif Agresif", d: "Gülerek laf sokuyorsunuz birbirinize.", i: "😬", fx: "rain" },

        // --- 💧 TRİP (TRIP) BAŞLANGIÇLARI ---
        'trip-trip-trip': { t: "Kıyamet", d: "Evde sirenler çalıyor! Sığınaklara kaçın!", i: "🚨", fx: "rain" },
        'trip-trip-love': { t: "Zorla Güzellik", d: "Zorla kendini sevdirmeye çalışıyor ama sen yüz vermiyorsun.", i: "😒", fx: "rain" },
        'trip-trip-passion': { t: "Patlamaya Hazır", d: "Sinirden titriyorsun ama bu onu tahrik ediyor olabilir.", i: "💣", fx: "fire" },
        'trip-trip-attention': { t: "Beni Gör!", d: "İlgi çekmek için ortalığı yıktın. Başardın.", i: "📢", fx: "rain" },
        'trip-trip-sweet': { t: "Timsah Gözyaşları", d: "Ağlayarak istediğini yaptırdın. Tehlikeli oyunlar.", i: "🐊", fx: "rain" },

        'trip-love-trip': { t: "Kararsız", d: "Sevsem mi dövsem mi? Bilemiyorsun.", i: "⚖️", fx: "rain" },
        'trip-love-passion': { t: "Barışma Seksi", d: "En ateşlisi budur. Kavga bitti, şov başladı.", i: "🛌", fx: "fire" },
        'trip-love-attention': { t: "Telafi", d: "Hatasını anladı, pervane oldu.", i: "🚁", fx: "heart" },
        'trip-love-sweet': { t: "Yumuşama", d: "Yelkenleri suya indirdin. Affedildi.", i: "🏳️", fx: "heart" },

        'trip-passion-trip': { t: "Elektrik", d: "Aranızdaki gerilim hat safhada. Dokunsan çarpılırsın.", i: "⚡", fx: "fire" },
        'trip-passion-love': { t: "Tutkulu Kavga", d: "Bağırış çağırış ama aslında birbirinize aşıksınız.", i: "🗣️", fx: "fire" },
        'trip-passion-attention': { t: "Kıskandırma", d: "Başkasına güldün, o delirdi. Şimdi hesap ver.", i: "🕵️", fx: "fire" },
        'trip-passion-sweet': { t: "Buz ve Ateş", d: "Bir soğuk yapıyorsun bir sıcak. Adam hasta oldu.", i: "🤒", fx: "rain" },

        'trip-attention-trip': { t: "Doyumsuz", d: "Ne yapsa yaranamıyor. Bugün zor gün.", i: "😤", fx: "rain" },
        'trip-attention-love': { t: "Duygu Sömürüsü", d: "'Beni sevmiyor musun?' diyerek köşeye sıkıştırdın.", i: "😿", fx: "rain" },
        'trip-attention-passion': { t: "İntikam", d: "Seni üzdüğü için süründürüyorsun.", i: "😈", fx: "fire" },
        'trip-attention-sweet': { t: "Kandırıkçı", d: "Trip atar gibi yapıp güldün.", i: "😝", fx: "sparkle" },

        'trip-sweet-trip': { t: "Dengesiz", d: "Şeker gibisin ama zehirli. Yaklaşmak riskli.", i: "🍄", fx: "rain" },
        'trip-sweet-love': { t: "Kırık Kalp", d: "Onu üzdün, şimdi gönlünü alman lazım.", i: "💔", fx: "rain" },
        'trip-sweet-passion': { t: "Tuzak", d: "Tatlı dille kandırıp tuzağına düşürdün.", i: "🕸️", fx: "fire" },
        'trip-sweet-attention': { t: "Naz", d: "Aslında kızgın değilsin, sadece naz yapıyorsun.", i: "😽", fx: "sparkle" }
    };

    function addToCauldron(ingId) {
        if (cauldronIngredients.length >= maxIngredients) {
            const c = document.getElementById('main-cauldron');
            if(c) { c.classList.add('shaking'); setTimeout(()=>c.classList.remove('shaking'), 500); }
            return;
        }
        cauldronIngredients.push(ingId);
        updateCauldronVisuals();
    }

    function updateCauldronVisuals() {
        const liquid = document.querySelector('.liquid-surface');
        const previewArea = document.getElementById('cauldron-preview');
        const mixBtn = document.getElementById('mix-btn');

        if (cauldronIngredients.length > 0) {
            mixBtn.classList.remove('disabled');
            let lastIng = cauldronIngredients[cauldronIngredients.length-1];
            liquid.style.background = ingredientData[lastIng].color;
            liquid.style.height = `${40 + (cauldronIngredients.length * 15)}%`;
            liquid.style.boxShadow = `0 -5px 20px ${ingredientData[lastIng].color}`;
        } else {
            mixBtn.classList.add('disabled');
            liquid.style.background = "#333";
            liquid.style.height = "20%";
            liquid.style.boxShadow = "none";
        }

        previewArea.innerHTML = '';
        cauldronIngredients.forEach(id => {
            const miniItem = document.createElement('div');
            miniItem.className = 'mini-item';
            miniItem.innerText = ingredientData[id].icon;
            previewArea.appendChild(miniItem);
        });
    }

    function brewPotion() {
        if (cauldronIngredients.length === 0) return;
        const cauldron = document.getElementById('main-cauldron');
        const mixBtn = document.getElementById('mix-btn');
        mixBtn.classList.add('disabled'); 
        cauldron.classList.add('shaking');

        setTimeout(() => {
            cauldron.classList.remove('shaking');
            showPotionResult();
        }, 1500);
    }

    function showPotionResult() {
        const recipeKey = cauldronIngredients.join('-');
        let result = potionRecipes[recipeKey];

        // EĞER KOMBİNASYON LİSTEDE YOKSA (HATA ÖNLEYİCİ)
        if (!result) {
            const first = ingredientData[cauldronIngredients[0]].icon;
            const last = ingredientData[cauldronIngredients[cauldronIngredients.length-1]].icon;
            
            result = { 
                t: "Gizemli Karışım", 
                d: `Bu karışım laboratuvarı şaşırttı! ${first} ile başladın, ${last} ile bitirdin. Kocan şokta.`, 
                i: "🔮", 
                fx: "sparkle" 
            };
        }

        document.getElementById('result-icon').innerText = result.i;
        document.getElementById('result-title').innerText = result.t;
        document.getElementById('result-desc').innerText = result.d;

        lastResultText = `Aşk Laboratuvarı Raporu: 🧪\n\n*${result.t}* ${result.i}\n"${result.d}"\n\n-Sumru'nun Deneyi`;

        playResultEffect(result.fx);
        document.getElementById('potion-result-overlay').classList.add('active');
        
        cauldronIngredients = [];
        updateCauldronVisuals();
    }

    function playResultEffect(type) {
        const container = document.getElementById('result-effect-container');
        if(!container) return;
        container.innerHTML = ''; 

        if (type === 'heart') {
            for(let i=0; i<30; i++) {
                let el = document.createElement('div'); el.className = 'effect-heart'; el.innerText = '❤️';
                el.style.left = Math.random()*100 + '%'; el.style.animationDuration = (Math.random()*2+2)+'s';
                container.appendChild(el);
            }
        } else if (type === 'fire') {
            let el = document.createElement('div'); el.className = 'effect-fire';
            container.appendChild(el);
        } else if (type === 'rain') {
            for(let i=0; i<50; i++) {
                let el = document.createElement('div'); el.className = 'effect-rain';
                el.style.left = Math.random()*100 + '%'; el.style.animationDuration = (Math.random()*0.5+0.5)+'s';
                container.appendChild(el);
            }
        } else if (type === 'sparkle') {
             for(let i=0; i<40; i++) {
                let el = document.createElement('div'); el.className = 'confetti'; el.innerText = '✨';
                el.style.left = '50%'; el.style.top = '50%';
                el.style.setProperty('--x', (Math.random()-0.5)*800+'px');
                el.style.setProperty('--y', (Math.random()-0.5)*800+'px');
                container.appendChild(el);
            }
        }
        setTimeout(() => { container.innerHTML = ''; }, 4000);
    }

    function shareResultOnWP() {
        if(!lastResultText) return;
        window.location.href = `https://api.whatsapp.com/send?phone=905315581447&text=${encodeURIComponent(lastResultText)}`;
    }

    function closeResultOverlay() {
        document.getElementById('potion-result-overlay').classList.remove('active');
        const c = document.getElementById('result-effect-container');
        if(c) c.innerHTML = '';
    }

        /* =================================================================
       APP: NEON GARDEN (PREMIUM HYBRID: COSMIC & VINE) 🌌🌿
       ================================================================= */
    let gardenCanvas, gCtx;
    let particlesArray = [];
    let hue = 0;
    let gardenAnimationId;
    let isVineMode = false; // Mod kontrolü (False: Cosmic, True: Sarmaşık)
    
    // Mouse hızı hesaplama için
    let mouse = { x: undefined, y: undefined, prevX: undefined, prevY: undefined };

    function initGarden() {
        gardenCanvas = document.getElementById('garden-canvas');
        if(!gardenCanvas) return;

        gCtx = gardenCanvas.getContext('2d');
        gardenCanvas.width = window.innerWidth;
        gardenCanvas.height = window.innerHeight;
        
        // Premium Parlama Efekti
        gCtx.globalCompositeOperation = 'lighter';

        window.addEventListener('resize', function(){
            gardenCanvas.width = window.innerWidth;
            gardenCanvas.height = window.innerHeight;
            gCtx.globalCompositeOperation = 'lighter';
        });

        // --- ÇİFT TIKLAMA İLE MOD DEĞİŞTİRME ---
        gardenCanvas.addEventListener('dblclick', function(e){
            isVineMode = !isVineMode; // Modu tersine çevir
            
            // Kullanıcıya bilgi ver
            const modeName = isVineMode ? "🌿 Sarmaşık Modu" : "🌌 Kozmik Akış";
            showModeToast(modeName);
            
            // Mod değişince renk tonunu ayarla
            hue = isVineMode ? 100 : 200; 
        });

        // Dokunmatik ve Mouse Hareketleri
        const events = ['mousemove', 'touchmove'];
        events.forEach(evt => {
            gardenCanvas.addEventListener(evt, function(e){
                const hint = document.getElementById('garden-hint');
                if(hint) hint.style.opacity = '0';
                
                // Hız hesaplaması
                mouse.prevX = mouse.x || e.x;
                mouse.prevY = mouse.y || e.y;

                if(e.type === 'touchmove') {
                    mouse.x = e.touches[0].clientX;
                    mouse.y = e.touches[0].clientY;
                } else {
                    mouse.x = e.x;
                    mouse.y = e.y;
                }

                const vx = mouse.x - mouse.prevX;
                const vy = mouse.y - mouse.prevY;

                // MODA GÖRE PARÇACIK ÜRET
                if (isVineMode) {
                    // Sarmaşık Modu: Daha az ama kalıcı parçacıklar
                    particlesArray.push(new VineParticle(mouse.x, mouse.y));
                } else {
                    // Kozmik Mod: Hıza duyarlı akışkan parçacıklar
                    for(let i=0; i<3; i++) {
                        particlesArray.push(new CosmicParticle(mouse.x, mouse.y, vx, vy));
                    }
                }
            });
        });

        // Mouse bırakılınca konumu sıfırla
        const endEvents = ['mouseup', 'touchend'];
        endEvents.forEach(evt => {
            gardenCanvas.addEventListener(evt, () => {
                mouse.x = undefined; mouse.y = undefined;
            });
        });

        if(gardenAnimationId) cancelAnimationFrame(gardenAnimationId);
        animateGarden();
    }

    // --- SINIF 1: COSMIC PARTICLE (Akışkan Uzay) ---
    class CosmicParticle {
        constructor(x, y, vx, vy){
            this.x = x;
            this.y = y;
            this.size = Math.random() * 4 + 1;
            // Hız faktörü (Sürükleme hızına göre fırlat)
            this.speedX = (vx * 0.4) + (Math.random() * 2 - 1);
            this.speedY = (vy * 0.4) + (Math.random() * 2 - 1);
            // Kozmik Renkler (Mavi, Mor, Pembe)
            this.color = 'hsl(' + (hue + Math.random() * 50) + ', 100%, 60%)';
            this.life = 1.0;
            this.decay = Math.random() * 0.015 + 0.005; // Hızlı sönme
        }
        update(){
            this.x += this.speedX;
            this.y += this.speedY;
            // Sürtünme (Yavaşlama)
            this.speedX *= 0.95;
            this.speedY *= 0.95;
            if (this.size > 0.1) this.size -= 0.05;
            this.life -= this.decay;
        }
        draw(){
            gCtx.fillStyle = this.color;
            gCtx.beginPath();
            gCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            gCtx.shadowBlur = 10;
            gCtx.shadowColor = this.color;
            gCtx.fill();
        }
    }

    // --- SINIF 2: VINE PARTICLE (Sarmaşık) ---
    class VineParticle {
        constructor(x, y){
            this.x = x;
            this.y = y;
            this.size = Math.random() * 8 + 3;
            // Yavaş ve kıvrılan hareket
            this.speedX = Math.random() * 2 - 1;
            this.speedY = Math.random() * 2 - 1;
            // Doğa Renkleri (Yeşil, Sarı, Turuncu)
            this.color = 'hsl(' + (hue + Math.random() * 20) + ', 100%, 50%)';
            this.angle = Math.random() * 6.2;
            this.angleSpeed = Math.random() * 0.1 - 0.05;
            this.life = 1.0;
            this.decay = Math.random() * 0.002 + 0.001; // ÇOK yavaş sönme (Kalıcı iz)
        }
        update(){
            this.angle += this.angleSpeed;
            this.x += Math.sin(this.angle) * 1.5; // Kıvrılma
            this.y += Math.cos(this.angle) * 1.5;
            if (this.size > 0.1) this.size -= 0.02;
            this.life -= this.decay;
        }
        draw(){
            gCtx.fillStyle = this.color;
            gCtx.beginPath();
            gCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            gCtx.shadowBlur = 20; // Yoğun parlama
            gCtx.shadowColor = this.color;
            gCtx.fill();
        }
    }

    function animateGarden(){
        // ARKAPLAN VE İZ BIRAKMA AYARI
        gCtx.globalCompositeOperation = 'source-over';
        
        // Sarmaşık modunda izler daha uzun kalır (Daha az sileriz)
        // Kozmik modda daha hızlı silinir (Akışkanlık için)
        const fadeAlpha = isVineMode ? 0.03 : 0.1;
        
        // LOŞ ARKAPLAN (Göz yormayan derin mavi-siyah)
        const gradient = gCtx.createRadialGradient(
            gardenCanvas.width/2, gardenCanvas.height/2, 0,
            gardenCanvas.width/2, gardenCanvas.height/2, gardenCanvas.width
        );
        gradient.addColorStop(0, `rgba(10, 20, 40, ${fadeAlpha})`); // Merkez (Hafif Mavi)
        gradient.addColorStop(1, `rgba(0, 0, 0, ${fadeAlpha})`);     // Kenarlar (Siyah)
        
        gCtx.fillStyle = gradient;
        gCtx.fillRect(0, 0, gardenCanvas.width, gardenCanvas.height);
        
        // Çizim Modu
        gCtx.globalCompositeOperation = 'lighter';

        for (let i = 0; i < particlesArray.length; i++){
            particlesArray[i].update();
            particlesArray[i].draw();
            
            if (particlesArray[i].life <= 0 || particlesArray[i].size <= 0.1){
                particlesArray.splice(i, 1);
                i--;
            }
        }
        
        // Renk döngüsü
        hue += 0.5;
        
        gardenAnimationId = requestAnimationFrame(animateGarden);
    }

    // MOD DEĞİŞİM BİLDİRİMİ (TOAST)
    function showModeToast(text) {
        let toast = document.getElementById('garden-toast');
        if(!toast) {
            toast = document.createElement('div');
            toast.id = 'garden-toast';
            toast.style.position = 'absolute';
            toast.style.top = '10%';
            toast.style.left = '50%';
            toast.style.transform = 'translateX(-50%)';
            toast.style.color = 'white';
            toast.style.background = 'rgba(255,255,255,0.1)';
            toast.style.padding = '10px 20px';
            toast.style.borderRadius = '20px';
            toast.style.backdropFilter = 'blur(10px)';
            toast.style.fontSize = '14px';
            toast.style.pointerEvents = 'none';
            toast.style.transition = 'opacity 0.5s';
            toast.style.zIndex = '100';
            document.querySelector('#app-garden .modal-content').appendChild(toast);
        }
        toast.innerText = text;
        toast.style.opacity = '1';
        setTimeout(() => { toast.style.opacity = '0'; }, 2000);
    }

    function clearGarden() {
        if(gCtx) {
             gCtx.globalCompositeOperation = 'source-over';
             gCtx.fillStyle = '#050a14';
             gCtx.fillRect(0, 0, gardenCanvas.width, gardenCanvas.height);
             gCtx.globalCompositeOperation = 'lighter';
        }
        particlesArray = [];
        const hint = document.getElementById('garden-hint');
        if(hint) hint.style.opacity = '1';
    }
    
    function saveGarden() {
        if(!gardenCanvas) return;
        gCtx.globalCompositeOperation = 'destination-over';
        gCtx.fillStyle = '#050a14';
        gCtx.fillRect(0, 0, gardenCanvas.width, gardenCanvas.height);
        const link = document.createElement('a');
        link.download = 'neon-sanat.png';
        link.href = gardenCanvas.toDataURL();
        link.click();
        gCtx.globalCompositeOperation = 'lighter';
        alert("Eserin kaydedildi! 📸");
    }

    /* --- ANA YÖNETİCİ (GÜNCEL) --- */
    window.openApp = function(id) {
        document.querySelectorAll('.app-modal').forEach(modal => modal.classList.remove('active'));
        const target = document.getElementById('app-' + id);
        if(target) target.classList.add('active');
        
        if(id === 'garden') initGarden();
        if(id === 'stock') initStockApp();
        if(id === 'luna') initLuna();
        if(id === 'quiz') restartQuiz();
        if(id === 'scratch') initScratchCard();
        if(id === 'panic') resetPanicMode();
        if(id === 'zen') switchZenTab('breath');
        if(id === 'lovelab') { }
        if(id === 'messages') loadMessages();
        if(id === 'mail') loadEmails();
        if(id === 'phone') loadCalls();
        if(id === 'heart') resetHeartApp();
    };


        /* --- FİNAL UYGULAMA YÖNETİCİSİ (TÜM UYGULAMALAR BURADA) --- */
    window.openApp = function(id) {
        // 1. Önce açıklan tüm pencereleri kapat (Çakışmayı önle)
        document.querySelectorAll('.app-modal').forEach(modal => modal.classList.remove('active'));
        
        // 2. Tıklanan uygulamanın penceresini bul ve aç
        const target = document.getElementById('app-' + id);
        if(target) {
            target.classList.add('active');
        } else {
            console.error("Uygulama bulunamadı: app-" + id);
            return;
        }
        
        // 3. UYGULAMA BAŞLATICILARI (Hepsi burada olmalı)
        
        // Dock Uygulamaları (Telefon, Mesaj, Mail, Kalp)
        if(id === 'messages') loadMessages();
        if(id === 'mail') loadEmails();
        if(id === 'phone') loadCalls();
        if(id === 'heart') resetHeartApp();

        // Ana Ekran Uygulamaları
        if(id === 'garden') initGarden(); // Neon Garden
        if(id === 'stock') initStockApp(); // Borsa
        if(id === 'luna') initLuna(); // Luna
        if(id === 'quiz') restartQuiz(); // Quiz
        if(id === 'lovelab') { /* Love Lab Hazır */ } 
        if(id === 'scratch') initScratchCard(); // Kazı Kazan
        if(id === 'panic') resetPanicMode(); // Panik Butonu
        if(id === 'zen') switchZenTab('breath'); // Zen Modu
        
        // Diğerleri (Varsa)
        if(id === 'photos') { /* Albüm */ }
        if(id === 'notes') { /* Notlar */ }
    };




    </script>
</body>
</html>
